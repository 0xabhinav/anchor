import{PublicKey as e,SYSVAR_RENT_PUBKEY as t,SystemProgram as n,SYSVAR_CLOCK_PUBKEY as r,SendTransactionError as i,TransactionInstruction as o,Transaction as s}from"@solana/web3.js";import a,{Buffer as c}from"buffer";import u from"bn.js";import l from"bs58";import d from"camelcase";import*as h from"@coral-xyz/borsh";import{sha256 as f}from"@noble/hashes/sha256";import{inflate as p}from"pako";import m from"eventemitter3";const g=e=>"version"in e;function y(e){return l.encode(e)}function w(e){return e.toString("base64")}function v(e){return c.from(e,"base64")}function b(e,...t){if(e.args.length!=t.length)throw new Error("Invalid argument length");const n={};let r=0;return e.args.forEach((e=>{n[e.name]=t[r],r+=1})),n}function E(e,t={}){e.forEach((e=>{if("accounts"in e)E(e.accounts,t[e.name]);else if(void 0===t[e.name])throw new Error(`Invalid arguments: ${e.name} not provided.`)}))}function S(t){return t instanceof e?t:new e(t)}class A extends TypeError{constructor(e,t){let n;const{message:r,...i}=e,{path:o}=e;super(0===o.length?r:"At path: "+o.join(".")+" -- "+r),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var r;return null!=(r=n)?r:n=[e,...t()]}}}function _(e){return"object"==typeof e&&null!=e}function I(e){return"string"==typeof e?JSON.stringify(e):""+e}function k(e,t,n,r){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:i,branch:o}=t,{type:s}=n,{refinement:a,message:c="Expected a value of type `"+s+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+I(r)+"`"}=e;return{value:r,type:s,refinement:a,key:i[i.length-1],path:i,branch:o,...e,message:c}}function*x(e,t,n,r){(function(e){return _(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const i of e){const e=k(i,t,n,r);e&&(yield e)}}function*L(e,t,n){void 0===n&&(n={});const{path:r=[],branch:i=[e],coerce:o=!1,mask:s=!1}=n,a={path:r,branch:i};if(o&&(e=t.coercer(e,a),s&&"type"!==t.type&&_(t.schema)&&_(e)&&!Array.isArray(e)))for(const n in e)void 0===t.schema[n]&&delete e[n];let c=!0;for(const n of t.validator(e,a))c=!1,yield[n,void 0];for(let[n,u,l]of t.entries(e,a)){const t=L(u,l,{path:void 0===n?r:[...r,n],branch:void 0===n?i:[...i,u],coerce:o,mask:s});for(const r of t)r[0]?(c=!1,yield[r[0],void 0]):o&&(u=r[1],void 0===n?e=u:e instanceof Map?e.set(n,u):e instanceof Set?e.add(u):_(e)&&(e[n]=u))}if(c)for(const n of t.refiner(e,a))c=!1,yield[n,void 0];c&&(yield[void 0,e])}class O{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:n,validator:r,refiner:i,coercer:o=(e=>e),entries:s=function*(){}}=e;this.type=t,this.schema=n,this.entries=s,this.coercer=o,this.validator=r?(e,t)=>x(r(e,t),t,this,e):()=>[],this.refiner=i?(e,t)=>x(i(e,t),t,this,e):()=>[]}assert(e){return function(e,t){const n=B(e,t);if(n[0])throw n[0]}(e,this)}create(e){return M(e,this)}is(e){return T(e,this)}mask(e){return function(e,t){const n=B(e,t,{coerce:!0,mask:!0});if(n[0])throw n[0];return n[1]}(e,this)}validate(e,t){return void 0===t&&(t={}),B(e,this,t)}}function M(e,t){const n=B(e,t,{coerce:!0});if(n[0])throw n[0];return n[1]}function T(e,t){return!B(e,t)[0]}function B(e,t,n){void 0===n&&(n={});const r=L(e,t,n),i=function(e){const{done:t,value:n}=e.next();return t?void 0:n}(r);if(i[0]){const e=new A(i[0],(function*(){for(const e of r)e[0]&&(yield e[0])}));return[e,void 0]}return[void 0,i[1]]}function P(e,t){return new O({type:e,schema:null,validator:t})}function R(e){return new O({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[n,r]of t.entries())yield[n,r,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||"Expected an array value, but received: "+I(e)})}function C(e){const t=I(e),n=typeof e;return new O({type:"literal",schema:"string"===n||"number"===n||"boolean"===n?e:null,validator:n=>n===e||"Expected the literal `"+t+"`, but received: "+I(n)})}function U(e){return new O({...e,validator:(t,n)=>null===t||e.validator(t,n),refiner:(t,n)=>null===t||e.refiner(t,n)})}function D(){return P("number",(e=>"number"==typeof e&&!isNaN(e)||"Expected a number, but received: "+I(e)))}function q(e){return new O({...e,validator:(t,n)=>void 0===t||e.validator(t,n),refiner:(t,n)=>void 0===t||e.refiner(t,n)})}function N(){return P("string",(e=>"string"==typeof e||"Expected a string, but received: "+I(e)))}function V(e){const t=Object.keys(e);return new O({type:"type",schema:e,*entries(n){if(_(n))for(const r of t)yield[r,n[r],e[r]]},validator:e=>_(e)||"Expected an object, but received: "+I(e)})}function j(e){const t=e.map((e=>e.type)).join(" | ");return new O({type:"union",schema:null,coercer(t,n){const r=e.find((e=>{const[n]=e.validate(t,{coerce:!0});return!n}))||F();return r.coercer(t,n)},validator(n,r){const i=[];for(const t of e){const[...e]=L(n,t,r),[o]=e;if(!o[0])return[];for(const[t]of e)t&&i.push(t)}return["Expected the value to satisfy a union of `"+t+"`, but received: "+I(n),...i]}})}function F(){return P("unknown",(()=>!0))}async function $(e,t,n){if(t.length<=99)return await z(e,t,n);{const r=function(e,t){return Array.apply(0,new Array(Math.ceil(e.length/t))).map(((n,r)=>e.slice(r*t,(r+1)*t)))}(t,99);return(await Promise.all(r.map((t=>z(e,t,n))))).flat()}}async function z(e,t,n){const r=null!=n?n:e.commitment,{value:i,context:o}=await e.getMultipleAccountsInfoAndContext(t,r);return i.map(((e,n)=>null===e?null:{publicKey:t[n],account:e,context:o}))}function K(e){return function(e,t,n){return new O({...e,coercer:(r,i)=>T(r,t)?e.coercer(n(r,i),i):e.coercer(r,i)})}(G(e),W,(t=>"error"in t?t:{...t,result:M(t.result,e)}))}const W=G(F());function G(e){return j([V({jsonrpc:C("2.0"),id:N(),result:e}),V({jsonrpc:C("2.0"),id:N(),error:V({code:F(),message:N(),data:q(P("any",(()=>!0)))})})])}const H=(J=V({err:U(j([V({}),N()])),logs:U(R(N())),accounts:q(U(R(U(V({executable:P("boolean",(e=>"boolean"==typeof e)),owner:N(),lamports:D(),data:R(N()),rentEpoch:q(D())}))))),unitsConsumed:q(D())}),K(V({context:V({slot:D()}),value:J})));var J;class X{constructor(e,t,n){this.connection=e,this.wallet=t,this.opts=n,this.publicKey=null==t?void 0:t.publicKey}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,n){var r,o,s,a;if(void 0===n&&(n=this.opts),g(e))t&&e.sign(t);else if(e.feePayer=null!==(r=e.feePayer)&&void 0!==r?r:this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(n.preflightCommitment)).blockhash,t)for(const n of t)e.partialSign(n);const c=(e=await this.wallet.signTransaction(e)).serialize();try{return await Y(this.connection,c,n)}catch(t){if(t instanceof Q){const n=y(g(e)?(null===(o=e.signatures)||void 0===o?void 0:o[0])||new Uint8Array:null!==(s=e.signature)&&void 0!==s?s:new Uint8Array),r=await this.connection.getTransaction(n,{commitment:"confirmed"});if(r){const e=null===(a=r.meta)||void 0===a?void 0:a.logMessages;throw e?new i(t.message,e):t}throw t}throw t}}async sendAll(e,t){var n,r,o;void 0===t&&(t=this.opts);const s=(await this.connection.getLatestBlockhash(t.preflightCommitment)).blockhash;let a=e.map((e=>{var t,n;if(g(e.tx)){let t=e.tx;return e.signers&&t.sign(e.signers),t}{let r=e.tx,i=null!==(t=e.signers)&&void 0!==t?t:[];return r.feePayer=null!==(n=r.feePayer)&&void 0!==n?n:this.wallet.publicKey,r.recentBlockhash=s,i.forEach((e=>{r.partialSign(e)})),r}}));const c=await this.wallet.signAllTransactions(a),u=[];for(let e=0;e<a.length;e+=1){const s=c[e],a=s.serialize();try{u.push(await Y(this.connection,a,t))}catch(e){if(e instanceof Q){const t=y(g(s)?(null===(n=s.signatures)||void 0===n?void 0:n[0])||new Uint8Array:null!==(r=s.signature)&&void 0!==r?r:new Uint8Array),a=await this.connection.getTransaction(t,{commitment:"confirmed"});if(a){const t=null===(o=a.meta)||void 0===o?void 0:o.logMessages;throw t?new i(e.message,t):e}throw e}throw e}}return u}async simulate(e,t,n,r){let o,s=(await this.connection.getLatestBlockhash(null!=n?n:this.connection.commitment)).blockhash;if(g(e)?(t&&t.length>0&&(e.sign(t),e=await this.wallet.signTransaction(e)),o=await this.connection.simulateTransaction(e,{commitment:n})):(e.feePayer=e.feePayer||this.wallet.publicKey,e.recentBlockhash=s,t&&t.length>0&&(e=await this.wallet.signTransaction(e)),o=await async function(e,t,n,r,o){var s;n&&n.length>0&&t.sign(...n);const a=t._compile(),c=a.serialize(),u=t._serialize(c).toString("base64"),l={encoding:"base64",commitment:null!=r?r:e.commitment};if(o){const e=(Array.isArray(o)?o:a.nonProgramIds()).map((e=>e.toBase58()));l.accounts={encoding:"base64",addresses:e}}n&&n.length>0&&(l.sigVerify=!0);const d=[u,l],h=M(await e._rpcRequest("simulateTransaction",d),H);if("error"in h){let e;if("data"in h.error&&(e=null===(s=h.error.data)||void 0===s?void 0:s.logs,e&&Array.isArray(e))){const t="\n    ",n=t+e.join(t);console.error(h.error.message,n)}throw new i("failed to simulate transaction: "+h.error.message,e)}return h.result}(this.connection,e,t,n,r)),o.value.err)throw new Z(o.value);return o.value}}class Z extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function Y(e,t,n){const r=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment},i=await e.sendRawTransaction(t,r),o=(await e.confirmTransaction(i,n&&n.commitment)).value;if(o.err)throw new Q(`Raw transaction ${i} failed (${JSON.stringify(o)})`);return i}class Q extends Error{constructor(e){super(e)}}function ee(){return X.local()}const te=new Map;function ne(e){return void 0!==te.get(e)}class re extends Error{constructor(e){super(e),this.name="IdlError"}}class ie{constructor(e){this.stack=e}static parse(t){var n;const r=/^Program (\w*) invoke/,i=/^Program \w* success/,o=[];for(let s=0;s<t.length;s++){if(i.exec(t[s])){o.pop();continue}const a=null===(n=r.exec(t[s]))||void 0===n?void 0:n[1];a&&o.push(new e(a))}return new ie(o)}}class oe extends Error{constructor(e,t,n,r,i,o){super(n.join("\n").replace("Program log: ","")),this.errorLogs=n,this.logs=r,this.error={errorCode:e,errorMessage:t,comparedValues:o,origin:i},this._programErrorStack=ie.parse(r)}static parse(t){if(!t)return null;const n=t.findIndex((e=>e.startsWith("Program log: AnchorError")));if(-1===n)return null;const r=t[n],i=[r];let o;if(n+1<t.length)if("Program log: Left:"===t[n+1]){const r=/^Program log: (.*)$/,s=r.exec(t[n+2])[1],a=r.exec(t[n+4])[1];o=[new e(s),new e(a)],i.push(...t.slice(n+1,n+5))}else if(t[n+1].startsWith("Program log: Left:")){const e=/^Program log: (Left|Right): (.*)$/,r=e.exec(t[n+1])[2],s=e.exec(t[n+2])[2];i.push(...t.slice(n+1,n+3)),o=[r,s]}const s=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r);if(s){const[e,n,r]=s.slice(1,4),a={code:e,number:parseInt(n)};return new oe(a,r,i,t,void 0,o)}if(a){const[e,n,r,s,c]=a.slice(1,6),u={code:r,number:parseInt(s)},l={file:e,line:parseInt(n)};return new oe(u,c,i,t,l,o)}if(c){const[e,n,r,s]=c.slice(1,5),a=e,u={code:n,number:parseInt(r)};return new oe(u,s,i,t,a,o)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class se extends Error{constructor(e,t,n){super(),this.code=e,this.msg=t,this.logs=n,n&&(this._programErrorStack=ie.parse(n))}static parse(e,t){const n=e.toString();let r,i;if(n.includes("custom program error:")){let e=n.split("custom program error: ");if(2!==e.length)return null;r=e[1]}else{const e=n.match(/"Custom":([0-9]+)}/g);if(!e||e.length>1)return null;r=e[0].match(/([0-9]+)/g)[0]}try{i=parseInt(r)}catch(e){return null}let o=t.get(i);return void 0!==o?new se(i,o,e.logs):(o=ce.get(i),void 0!==o?new se(i,o,e.logs):null)}get program(){var e;return null===(e=this._programErrorStack)||void 0===e?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return null===(e=this._programErrorStack)||void 0===e?void 0:e.stack}toString(){return this.msg}}function ae(e,t){ne("debug-logs")&&console.log("Translating error:",e);const n=oe.parse(e.logs);if(n)return n;const r=se.parse(e,t);if(r)return r;if(e.logs){const t={get:function(t,n){return"programErrorStack"===n?t.programErrorStack.stack:"program"===n?t.programErrorStack.stack[e.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return e.programErrorStack=ie.parse(e.logs),new Proxy(e,t)}return e}const ce=new Map([[100,"8 byte instruction identifier not provided"],[101,"Fallback functions are not supported"],[102,"The program could not deserialize the given instruction"],[103,"The program could not serialize the given instruction"],[1e3,"The program was compiled without idl instructions"],[1001,"The transaction was given an invalid program for the IDL instruction"],[2e3,"A mut constraint was violated"],[2001,"A has one constraint was violated"],[2002,"A signer constraint was violated"],[2003,"A raw constraint was violated"],[2004,"An owner constraint was violated"],[2005,"A rent exemption constraint was violated"],[2006,"A seeds constraint was violated"],[2007,"An executable constraint was violated"],[2008,"Deprecated Error, feel free to replace with something else"],[2009,"An associated constraint was violated"],[2010,"An associated init constraint was violated"],[2011,"A close constraint was violated"],[2012,"An address constraint was violated"],[2013,"Expected zero account discriminant"],[2014,"A token mint constraint was violated"],[2015,"A token owner constraint was violated"],[2016,"A mint mint authority constraint was violated"],[2017,"A mint freeze authority constraint was violated"],[2018,"A mint decimals constraint was violated"],[2019,"A space constraint was violated"],[2020,"A required account for the constraint is None"],[2500,"A require expression was violated"],[2501,"A require_eq expression was violated"],[2502,"A require_keys_eq expression was violated"],[2503,"A require_neq expression was violated"],[2504,"A require_keys_neq expression was violated"],[2505,"A require_gt expression was violated"],[2506,"A require_gte expression was violated"],[3e3,"The account discriminator was already set on this account"],[3001,"No 8 byte discriminator was found on the account"],[3002,"8 byte discriminator did not match what was expected"],[3003,"Failed to deserialize the account"],[3004,"Failed to serialize the account"],[3005,"Not enough account keys given to the instruction"],[3006,"The given account is not mutable"],[3007,"The given account is owned by a different program than expected"],[3008,"Program ID was not as expected"],[3009,"Program account is not executable"],[3010,"The given account did not sign"],[3011,"The given account is not owned by the system program"],[3012,"The program expected this account to be already initialized"],[3013,"The given account is not a program data account"],[3014,"The given account is not the associated token account"],[3015,"The given public key does not match the required sysvar"],[3016,"The account reallocation exceeds the MAX_PERMITTED_DATA_INCREASE limit"],[3017,"The account was duplicated for more than one reallocation"],[4100,"The declared program id does not match the actual program id"],[5e3,"The API being used is deprecated and should no longer be used"]]);var ue=function(){return ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ue.apply(this,arguments)},le=function(){return le=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},le.apply(this,arguments)};function de(e){return e.toLowerCase()}var he=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],fe=/[^A-Z0-9]+/gi;function pe(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce((function(e,t){return e.replace(t,n)}),e)}function me(e,t){return void 0===t&&(t={}),function(e,t){void 0===t&&(t={});for(var n=t.splitRegexp,r=void 0===n?he:n,i=t.stripRegexp,o=void 0===i?fe:i,s=t.transform,a=void 0===s?de:s,c=t.delimiter,u=void 0===c?" ":c,l=pe(pe(e,r,"$1\0$2"),o,"\0"),d=0,h=l.length;"\0"===l.charAt(d);)d++;for(;"\0"===l.charAt(h-1);)h--;return l.slice(d,h).split("\0").map(a).join(u)}(e,le({delimiter:"."},t))}class ge{static fieldLayout(e,t){const n=void 0!==e.name?d(e.name):void 0;switch(e.type){case"bool":return h.bool(n);case"u8":return h.u8(n);case"i8":return h.i8(n);case"u16":return h.u16(n);case"i16":return h.i16(n);case"u32":return h.u32(n);case"i32":return h.i32(n);case"f32":return h.f32(n);case"u64":return h.u64(n);case"i64":return h.i64(n);case"f64":return h.f64(n);case"u128":return h.u128(n);case"i128":return h.i128(n);case"u256":return h.u256(n);case"i256":return h.i256(n);case"bytes":return h.vecU8(n);case"string":return h.str(n);case"publicKey":return h.publicKey(n);default:if("vec"in e.type)return h.vec(ge.fieldLayout({name:void 0,type:e.type.vec},t),n);if("option"in e.type)return h.option(ge.fieldLayout({name:void 0,type:e.type.option},t),n);if("defined"in e.type){if(!t)throw new re("User defined types not provided");const r=e.type.defined,i=t.filter((e=>e.name===r));if(1!==i.length)throw new re(`Type not found: ${JSON.stringify(e)}`);return ge.typeDefLayout(i[0],t,n)}if("array"in e.type){let r=e.type.array[0],i=e.type.array[1],o=ge.fieldLayout({name:void 0,type:r},t);return h.array(o,i,n)}throw new Error(`Not yet implemented: ${e}`)}}static typeDefLayout(e,t=[],n){switch(e.type.kind){case"struct":{const r=e.type.fields.map((e=>ge.fieldLayout(e,t)));return h.struct(r,n)}case"enum":{let r=e.type.variants.map((e=>{const n=d(e.name);if(!e.fields)return h.struct([],n);const r=e.fields.map(((e,n)=>(null==e?void 0:e.name)?ge.fieldLayout(e,t):ge.fieldLayout({type:e,name:n.toString()},t)));return h.struct(r,n)}));return void 0!==n?h.rustEnum(r).replicate(n):h.rustEnum(r,n)}case"alias":return ge.fieldLayout({type:e.type.value,name:e.name},t)}}}const ye="global";class we{constructor(e){this.idl=e,this.ixLayout=we.parseIxLayout(e);const t=new Map;e.instructions.forEach((e=>{const n=be(ye,e.name);t.set(l.encode(n),{layout:this.ixLayout.get(e.name),name:e.name})})),this.sighashLayouts=t}encode(e,t,n){return this._encode(e,t,null!=n?n:be(ye,e))}_encode(e,t,n){const r=c.alloc(1e3),i=d(e),o=this.ixLayout.get(i);if(!o)throw new Error(`Unknown method: ${i}`);const s=o.encode(t,r),a=r.slice(0,s);return c.concat([n,a])}static parseIxLayout(e){const t=e.instructions.map((t=>{let n=t.args.map((t=>{var n,r;return ge.fieldLayout(t,Array.from([...null!==(n=e.accounts)&&void 0!==n?n:[],...null!==(r=e.types)&&void 0!==r?r:[]]))}));const r=d(t.name);return[r,h.struct(n,r)]}));return new Map(t)}decode(e,t="hex",n){"string"==typeof e&&(e="hex"===t?c.from(e,"hex"):l.decode(e));let r=l.encode(n?be(ye,n):e.slice(0,8)),i=e.slice(8);const o=this.sighashLayouts.get(r);return o?{data:o.layout.decode(i),name:o.name}:null}format(e,t){return ve.format(e,t,this.idl)}}class ve{static format(e,t,n){const r=n.instructions.filter((t=>e.name===t.name))[0];if(void 0===r)return console.error("Invalid instruction given"),null;const i=r.args.map((t=>({name:t.name,type:ve.formatIdlType(t.type),data:ve.formatIdlData(t,e.data[t.name],n.types)}))),o=ve.flattenIdlAccounts(r.accounts);return{args:i,accounts:t.map(((e,t)=>t<o.length?{name:o[t].name,...e}:{name:void 0,...e}))}}static formatIdlType(e){if("string"==typeof e)return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,n){if("string"==typeof e.type)return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map((t=>this.formatIdlData({name:"",type:e.type.vec},t,n))).join(", ")+"]";if(e.type.hasOwnProperty("option"))return null===t?"null":this.formatIdlData({name:"",type:e.type.option},t,n);if(e.type.hasOwnProperty("defined")){if(void 0===n)throw new Error("User defined types not provided");const r=n.filter((t=>t.name===e.type.defined));if(1!==r.length)throw new Error(`Type not found: ${e.type.defined}`);return ve.formatIdlDataDefined(r[0],t,n)}return"unknown"}static formatIdlDataDefined(e,t,n){switch(e.type.kind){case"struct":{const r=e.type,i=Object.keys(t).map((e=>{const i=r.fields.find((t=>t.name===e));if(!i)throw new Error("Unable to find type");return e+": "+ve.formatIdlData(i,t[e],n)})).join(", ");return"{ "+i+" }"}case"enum":if(0===e.type.variants.length)return"{}";if(e.type.variants[0].name){const r=e.type.variants,i=Object.keys(t)[0],o=t[i],s=r.find((e=>d(e.name)===i));if(!s)throw new Error(`Unable to find variant \`${i}\``);const a=s.fields,c=Object.keys(o).map((e=>{const t=o[e],r=a.find((t=>t.name===e));if(!r)throw new Error(`Unable to find field \`${e}\``);return e+": "+ve.formatIdlData(r,t,n)})).join(", "),u=d(i,{pascalCase:!0});return 0===c.length?u:`${u} { ${c} }`}return"Tuple formatting not yet implemented";case"alias":return ve.formatIdlType(e.type.value)}}static flattenIdlAccounts(e,t){return e.map((e=>{const n=function(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}(e.name);if(e.hasOwnProperty("accounts")){const r=t?`${t} > ${n}`:n;return ve.flattenIdlAccounts(e.accounts,r)}return{...e,name:t?`${t} > ${n}`:n}})).flat()}}function be(e,t){var n;let r=`${e}:${void 0===n&&(n={}),me(t,ue({delimiter:"_"},n))}`;return c.from(f(r).slice(0,8))}function Ee(e,t){switch(t.type.kind){case"struct":return t.type.fields.map((t=>Se(e,t.type))).reduce(((e,t)=>e+t),0);case"enum":{const n=t.type.variants.map((t=>t.fields?t.fields.map((t=>Se(e,"object"==typeof t&&"name"in t?t.type:t))).reduce(((e,t)=>e+t),0):0));return Math.max(...n)+1}case"alias":return Se(e,t.type.value)}}function Se(e,t){var n,r;switch(t){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"u256":case"i256":case"publicKey":return 32;default:if("vec"in t)return 1;if("option"in t)return 1+Se(e,t.option);if("coption"in t)return 4+Se(e,t.coption);if("defined"in t){const i=null!==(r=null===(n=e.types)||void 0===n?void 0:n.filter((e=>e.name===t.defined)))&&void 0!==r?r:[];if(1!==i.length)throw new re(`Type not found: ${JSON.stringify(t)}`);return Ee(e,i[0])}if("array"in t){let n=t.array[0],r=t.array[1];return Se(e,n)*r}throw new Error(`Invalid type ${JSON.stringify(t)}`)}}function Ae(e){return Buffer.from(f(e).slice(0,8))}class _e{constructor(e){if(void 0===e.accounts)return void(this.accountLayouts=new Map);const t=e.accounts.map((t=>[t.name,ge.typeDefLayout(t,e.types)]));this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const n=c.alloc(1e3),r=this.accountLayouts.get(e);if(!r)throw new Error(`Unknown account: ${e}`);const i=r.encode(t,n);let o=n.slice(0,i),s=_e.accountDiscriminator(e);return c.concat([s,o])}decode(e,t){if(_e.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeAny(e){const t=e.slice(0,8),n=Array.from(this.accountLayouts.keys()).find((e=>_e.accountDiscriminator(e).equals(t)));if(!n)throw new Error("Account descriminator not found");return this.decodeUnchecked(n,e)}decodeUnchecked(e,t){const n=t.subarray(8),r=this.accountLayouts.get(e);if(!r)throw new Error(`Unknown account: ${e}`);return r.decode(n)}memcmp(e,t){const n=_e.accountDiscriminator(e);return{offset:0,bytes:l.encode(t?c.concat([n,t]):n)}}size(e){var t;return 8+(null!==(t=Ee(this.idl,e))&&void 0!==t?t:0)}static accountDiscriminator(e){return Ae(`account:${d(e,{pascalCase:!0,preserveConsecutiveUppercase:!0})}`)}}class Ie{constructor(e){if(void 0===e.events)return void(this.layouts=new Map);const t=e.events.map((t=>{let n={name:t.name,type:{kind:"struct",fields:t.fields.map((e=>({name:e.name,type:e.type})))}};return[t.name,ge.typeDefLayout(n,e.types)]}));this.layouts=new Map(t),this.discriminators=new Map(void 0===e.events?[]:e.events.map((e=>{return[w((t=e.name,Ae(`event:${t}`))),e.name];var t})))}decode(e){let t;try{t=v(e)}catch(e){return null}const n=w(t.slice(0,8)),r=this.discriminators.get(n);if(void 0===r)return null;const i=this.layouts.get(r);if(!i)throw new Error(`Unknown event: ${r}`);return{data:i.decode(t.slice(8)),name:r}}}class ke{constructor(e){if(void 0===e.types)return void(this.typeLayouts=new Map);const t=e.types.map((t=>[t.name,ge.typeDefLayout(t,e.types)]));this.typeLayouts=new Map(t),this.idl=e}encode(e,t){const n=c.alloc(1e3),r=this.typeLayouts.get(e);if(!r)throw new Error(`Unknown type: ${e}`);const i=r.encode(t,n);return n.slice(0,i)}decode(e,t){const n=this.typeLayouts.get(e);if(!n)throw new Error(`Unknown type: ${e}`);return n.decode(t)}}class xe{constructor(e){this.instruction=new we(e),this.accounts=new _e(e),this.events=new Ie(e),this.types=new ke(e)}}var Le="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};class Oe{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Me=Oe;class Te extends Oe{isCount(){throw new Error("ExternalLayout is abstract")}}class Be extends Te{constructor(e,t,n){if(!(e instanceof Oe))throw new TypeError("layout must be a Layout");if(void 0===t)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Pe||this.layout instanceof Re}decode(e,t){return void 0===t&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,n){return void 0===n&&(n=0),this.layout.encode(e,t,n+this.offset)}}class Pe extends Oe{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return void 0===t&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return void 0===n&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class Re extends Oe{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return void 0===t&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,n){return void 0===n&&(n=0),t.writeUIntBE(e,n,this.span),this.span}}const Ce=Math.pow(2,32);function Ue(e){const t=Math.floor(e/Ce);return{hi32:t,lo32:e-t*Ce}}function De(e,t){return e*Ce+t}class qe extends Oe{constructor(e){super(8,e)}decode(e,t){void 0===t&&(t=0);const n=e.readUInt32LE(t);return De(e.readUInt32LE(t+4),n)}encode(e,t,n){void 0===n&&(n=0);const r=Ue(e);return t.writeUInt32LE(r.lo32,n),t.writeUInt32LE(r.hi32,n+4),8}}class Ne extends Oe{constructor(e){super(8,e)}decode(e,t){void 0===t&&(t=0);const n=e.readUInt32LE(t);return De(e.readInt32LE(t+4),n)}encode(e,t,n){void 0===n&&(n=0);const r=Ue(e);return t.writeUInt32LE(r.lo32,n),t.writeInt32LE(r.hi32,n+4),8}}class Ve extends Oe{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof Oe),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===n&&(n=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=e.reduce(((e,t)=>e+t.getSpan()),0)}catch(e){}super(r,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);let n=0;try{n=this.fields.reduce(((n,r)=>{const i=r.getSpan(e,t);return t+=i,n+i}),0)}catch(e){throw new RangeError("indeterminate span")}return n}decode(e,t){void 0===t&&(t=0);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(e,t)),t+=r.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){void 0===n&&(n=0);const r=n;let i=0,o=0;for(const r of this.fields){let s=r.span;if(o=0<s?s:0,void 0!==r.property){const i=e[r.property];void 0!==i&&(o=r.encode(i,t,n),0>s&&(s=r.getSpan(t,n)))}i=n,n+=s}return i+o-r}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class je{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class Fe extends je{constructor(e,t){if(!(e instanceof Te&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,n){return this.layout.encode(e,t,n)}}class $e extends Oe{constructor(e,t,n){const r=e instanceof Pe||e instanceof Re;if(r)e=new Fe(new Be(e));else if(e instanceof Te&&e.isCount())e=new Fe(e);else if(!(e instanceof je))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(void 0===t&&(t=null),!(null===t||t instanceof Oe))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&r&&(i+=e.layout.span)),super(i,n),this.discriminator=e,this.usesPrefixDiscriminator=r,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return o(e)},this.configGetSourceVariant=function(e){o=e.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);const n=this.getVariant(e,t);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(e.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(e,t){let n;void 0===t&&(t=0);const r=this.discriminator,i=r.decode(e,t);let o=this.registry[i];if(void 0===o){let s=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=i,n[o.property]=this.defaultLayout.decode(e,t+s)}else n=o.decode(e,t);return n}encode(e,t,n){void 0===n&&(n=0);const r=this.getSourceVariant(e);if(void 0===r){const r=this.discriminator,i=this.defaultLayout;let o=0;return this.usesPrefixDiscriminator&&(o=r.layout.span),r.encode(e[r.property],t,n),o+i.encode(e[i.property],t,n+o)}return r.encode(e,t,n)}addVariant(e,t,n){const r=new ze(this,e,t,n);return this.registry[e]=r,r}getVariant(e,t){let n=e;return Buffer.isBuffer(e)&&(void 0===t&&(t=0),n=this.discriminator.decode(e,t)),this.registry[n]}}class ze extends Oe{constructor(e,t,n,r){if(!(e instanceof $e))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof Oe))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=n?n.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,r),this.union=e,this.variant=t,this.layout=n||null}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(e,t+n)}decode(e,t){const n=this.makeDestinationObject();if(void 0===t&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(e,t+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(e,t,n){void 0===n&&(n=0);let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,n);let i=r;if(this.layout&&(this.layout.encode(e[this.property],t,n+r),i+=this.layout.getSpan(t,n+r),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class Ke extends Oe{constructor(e,t){if(!(e instanceof Te&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof Te||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){void 0===t&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let r=this.length;if(this.length instanceof Te&&(r=e.length),!Buffer.isBuffer(e)||r!==e.length)throw new TypeError((i="Blob.encode",((o=this).property?i+"["+o.property+"]":i)+" requires (length "+r+") Buffer as src"));var i,o;if(n+r>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,r,"hex"),this.length instanceof Te&&this.length.encode(r,t,n),r}}var We=(e,t,n)=>new Be(e,t,n),Ge=e=>new Pe(4,e),He=e=>new Ne(e),Je=(e,t,n)=>new Ve(e,t,n),Xe=(e,t,n)=>new $e(e,t,n),Ze=(e,t)=>new Ke(e,t);class Ye extends Me{constructor(e){super(-1,e),this.property=e,this.layout=Je([Ge("length"),Ge("lengthPadding"),Ze(We(Ge(),-8),"chars")],this.property)}encode(e,t,n=0){if(null==e)return this.layout.span;const r={chars:Buffer.from(e,"utf8")};return this.layout.encode(r,t,n)}decode(e,t=0){return this.layout.decode(e,t).chars.toString()}getSpan(e,t=0){return Ge().span+Ge().span+new u(new Uint8Array(e).slice(t,t+4),10,"le").toNumber()}}function Qe(e){return new Ye(e)}function et(e){return Ze(32,e)}const tt=Xe(Ge("instruction"));tt.addVariant(0,Je([He("lamports"),He("space"),et("owner")]),"createAccount"),tt.addVariant(1,Je([et("owner")]),"assign"),tt.addVariant(2,Je([He("lamports")]),"transfer"),tt.addVariant(3,Je([et("base"),Qe("seed"),He("lamports"),He("space"),et("owner")]),"createAccountWithSeed"),tt.addVariant(4,Je([et("authorized")]),"advanceNonceAccount"),tt.addVariant(5,Je([He("lamports")]),"withdrawNonceAccount"),tt.addVariant(6,Je([et("authorized")]),"initializeNonceAccount"),tt.addVariant(7,Je([et("authorized")]),"authorizeNonceAccount"),tt.addVariant(8,Je([He("space")]),"allocate"),tt.addVariant(9,Je([et("base"),Qe("seed"),He("space"),et("owner")]),"allocateWithSeed"),tt.addVariant(10,Je([et("base"),Qe("seed"),et("owner")]),"assignWithSeed"),tt.addVariant(11,Je([He("lamports"),Qe("seed"),et("owner")]),"transferWithSeed"),Math.max(...Object.values(tt.registry).map((e=>e.span)));class nt extends Me{constructor(e,t,n,r){super(e.span,r),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}}function rt(t){return new nt(Ze(32),(t=>new e(t)),(e=>e.toBuffer()),t)}var it;Je([Ge("version"),Ge("state"),rt("authorizedPubkey"),rt("nonce"),Je([(it="lamportsPerSignature",new qe(it))],"feeCalculator")]);const ot=new e("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),st=new e("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var at={exports:{}};function ct(e){return"accounts"in e}!function(e,t){var n="undefined"!=typeof self?self:Le,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=p(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=u(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},h.prototype.delete=function(e){delete this.map[u(e)]},h.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},h.prototype.set=function(e,t){this.map[u(e)]=l(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(h.prototype[Symbol.iterator]=h.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var n,r,i=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),w.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function E(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];E.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function A(e,n){return new Promise((function(r,o){var s=new v(e,n);if(s.signal&&s.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new E(i,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}A.polyfill=!0,e.fetch||(e.fetch=A,e.Headers=h,e.Request=v,e.Response=E),t.Headers=h,t.Request=v,t.Response=E,t.fetch=A,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t}(at,at.exports),h.rustEnum([h.struct([],"uninitialized"),h.struct([h.option(h.publicKey(),"authorityAddress")],"buffer"),h.struct([h.publicKey("programdataAddress")],"program"),h.struct([h.u64("slot"),h.option(h.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,h.u32());const ut=h.struct([h.publicKey("authority"),h.vecU8("data")]);function lt(e,t){var n,r;let i={};const o=e.args?e.args.length:0;if(t.length>o){if(t.length!==o+1)throw new Error(`provided too many arguments ${t} to instruction ${null==e?void 0:e.name} expecting: ${null!==(r=null===(n=e.args)||void 0===n?void 0:n.map((e=>e.name)))&&void 0!==r?r:[]}`);i=t.pop()}return[t,i]}class dt{static build(e,t,n){if("_inner"===e.name)throw new re("the _inner name is reserved");const r=(...i)=>{const[s,a]=lt(e,[...i]),{discriminator:c}=a;E(e.accounts,a.accounts);const u=r.accounts(a.accounts);return void 0!==a.remainingAccounts&&u.push(...a.remainingAccounts),ne("debug-logs")&&console.log("Outgoing account metas:",u),new o({keys:u,programId:n,data:t(e.name,b(e,...s),c)})};return r.accounts=t=>dt.accountsArray(t,e.accounts,n,e.name),r}static accountsArray(e,t,n,r){return e?t.map((t=>{if(void 0!==("accounts"in t?t.accounts:void 0)){const i=e[t.name];return dt.accountsArray(i,t.accounts,n,r).flat()}{const i=t;let o;try{o=S(e[t.name])}catch(e){throw new Error(`Wrong input type for account "${t.name}" in the instruction accounts object${void 0!==r?' for instruction "'+r+'"':""}. Expected PublicKey or string.`)}const s=i.isOptional&&o.equals(n);return{pubkey:o,isWritable:i.isMut&&!s,isSigner:i.isSigner&&!s}}})).flat():[]}}class ht{static build(e,t){return(...n)=>{var r,i,o;const[,a]=lt(e,[...n]),c=new s;if(a.preInstructions&&a.instructions)throw new Error("instructions is deprecated, use preInstructions");return null===(r=a.preInstructions)||void 0===r||r.forEach((e=>c.add(e))),null===(i=a.instructions)||void 0===i||i.forEach((e=>c.add(e))),c.add(t(...n)),null===(o=a.postInstructions)||void 0===o||o.forEach((e=>c.add(e))),c}}}class ft{static build(e,t,n,r){return async(...i)=>{var o;const s=t(...i),[,a]=lt(e,[...i]);if(void 0===r.sendAndConfirm)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await r.sendAndConfirm(s,null!==(o=a.signers)&&void 0!==o?o:[],a.options)}catch(e){throw ae(e,n)}}}}class pt{static build(e,t,n,r){var i;const o={};return null===(i=e.accounts)||void 0===i||i.forEach((i=>{const s=d(i.name);o[s]=new mt(e,i,n,r,t)})),o}}class mt{get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}get idlAccount(){return this._idlAccount}constructor(e,t,n,r,i){this._idlAccount=t,this._programId=n,this._provider=null!=r?r:ee(),this._coder=null!=i?i:new xe(e),this._size=this._coder.accounts.size(t)}async fetchNullable(e,t){const{data:n}=await this.fetchNullableAndContext(e,t);return n}async fetchNullableAndContext(e,t){const n=await this.getAccountInfoAndContext(e,t),{value:r,context:i}=n;return{data:r&&0!==r.data.length?this._coder.accounts.decode(this._idlAccount.name,r.data):null,context:i}}async fetch(e,t){const{data:n}=await this.fetchNullableAndContext(e,t);if(null===n)throw new Error(`Account does not exist or has no data ${e.toString()}`);return n}async fetchAndContext(e,t){const{data:n,context:r}=await this.fetchNullableAndContext(e,t);if(null===n)throw new Error(`Account does not exist ${e.toString()}`);return{data:n,context:r}}async fetchMultiple(e,t){return(await this.fetchMultipleAndContext(e,t)).map((e=>e?e.data:null))}async fetchMultipleAndContext(e,t){return(await $(this._provider.connection,e.map((e=>S(e))),t)).map((e=>{if(null==e)return null;const{account:t,context:n}=e;return{data:this._coder.accounts.decode(this._idlAccount.name,t.data),context:n}}))}async all(e){const t=this.coder.accounts.memcmp(this._idlAccount.name,e instanceof Buffer?e:void 0),n=[];return null!=(null==t?void 0:t.offset)&&null!=(null==t?void 0:t.bytes)&&n.push({memcmp:{offset:t.offset,bytes:t.bytes}}),null!=(null==t?void 0:t.dataSize)&&n.push({dataSize:t.dataSize}),(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[...n,...Array.isArray(e)?e:[]]})).map((({pubkey:e,account:t})=>({publicKey:e,account:this._coder.accounts.decode(this._idlAccount.name,t.data)})))}subscribe(e,t){const n=gt.get(e.toString());if(n)return n.ee;const r=new m;e=S(e);const i=this._provider.connection.onAccountChange(e,(e=>{const t=this._coder.accounts.decode(this._idlAccount.name,e.data);r.emit("change",t)}),t);return gt.set(e.toString(),{ee:r,listener:i}),r}async unsubscribe(e){let t=gt.get(e.toString());t?gt&&await this._provider.connection.removeAccountChangeListener(t.listener).then((()=>{gt.delete(e.toString())})).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(e,t){const r=this.size;if(void 0===this._provider.publicKey)throw new Error("This function requires the Provider interface implementor to have a 'publicKey' field.");return n.createAccount({fromPubkey:this._provider.publicKey,newAccountPubkey:e.publicKey,space:null!=t?t:r,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(null!=t?t:r),programId:this._programId})}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(S(e),t)}async getAccountInfoAndContext(e,t){return await this._provider.connection.getAccountInfoAndContext(S(e),t)}}const gt=new Map,yt="Program log: ",wt="Program data: ",vt=yt.length,bt=wt.length;class Et{constructor(e,t,n){this._programId=e,this._provider=t,this._eventParser=new St(e,n),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var n;let r=this._listenerIdCount;return this._listenerIdCount+=1,this._eventListeners.has(e)||this._eventListeners.set(e,[]),this._eventListeners.set(e,(null!==(n=this._eventListeners.get(e))&&void 0!==n?n:[]).concat(r)),this._eventCallbacks.set(r,[e,t]),void 0!==this._onLogsSubscriptionId||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,((e,t)=>{if(!e.err)for(const n of this._eventParser.parseLogs(e.logs)){const r=this._eventListeners.get(n.name);r&&r.forEach((r=>{const i=this._eventCallbacks.get(r);if(i){const[,r]=i;r(n.data,t.slot,e.signature)}}))}}))),r}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[n]=t;let r=this._eventListeners.get(n);if(!r)throw new Error(`Event listeners don't exist for ${n}!`);if(this._eventCallbacks.delete(e),r=r.filter((t=>t!==e)),this._eventListeners.set(n,r),0===r.length&&this._eventListeners.delete(n),0===this._eventCallbacks.size){if(0!==this._eventListeners.size)throw new Error(`Expected event listeners size to be 0 but got ${this._eventListeners.size}`);void 0!==this._onLogsSubscriptionId&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0)}}}class St{constructor(e,t){this.coder=t,this.programId=e}*parseLogs(e,t=!1){const n=new _t(e),r=new At;let i=n.next();for(;null!==i;){let[e,o,s]=this.handleLog(r,i,t);e&&(yield e),o&&r.push(o),s&&r.pop(),i=n.next()}}handleLog(e,t,n){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t,n):[null,...this.handleSystemLog(t)]}handleProgramLog(e,t){if(e.startsWith(yt)||e.startsWith(wt)){const n=e.startsWith(yt)?e.slice(vt):e.slice(bt),r=this.coder.events.decode(n);if(t&&null===r)throw new Error(`Unable to decode event ${n}`);return[r,null,!1]}return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return null!==t.match(/^Program (.*) success/g)?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class At{constructor(){this.stack=[]}program(){if(!this.stack.length)throw new Error("Expected the stack to have elements");return this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){if(!this.stack.length)throw new Error("Expected the stack to have elements");this.stack.pop()}}class _t{constructor(e){this.logs=e}next(){if(0===this.logs.length)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}class It{static build(e,t,n,r,i,o,s){return async(...a)=>{var c;const u=t(...a),[,l]=lt(e,[...a]);let d;if(void 0===r.simulate)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{d=await r.simulate(u,l.signers,null===(c=l.options)||void 0===c?void 0:c.commitment)}catch(e){throw ae(e,n)}if(void 0===d)throw new Error("Unable to simulate transaction");const h=d.logs;if(!h)throw new Error("Simulated logs not found");const f=[];if(s.events){let e=new St(o,i);for(const t of e.parseLogs(h))f.push(t)}return{events:f,raw:h}}}}function kt(e){return new Ot(Ze(8),(e=>Tt.fromBuffer(e)),(e=>e.toBuffer()),e)}function xt(t){return new Ot(Ze(32),(t=>new e(t)),(e=>e.toBuffer()),t)}function Lt(e,t){return new Mt(e,t)}class Ot extends Me{constructor(e,t,n,r){super(e.span,r),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}}class Mt extends Me{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=Ge()}encode(e,t,n=0){return null==e?this.layout.span+this.discriminator.encode(0,t,n):(this.discriminator.encode(1,t,n),this.layout.encode(e,t,n+4)+4)}decode(e,t=0){const n=this.discriminator.decode(e,t);if(0===n)return null;if(1===n)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}class Tt extends u{toBuffer(){const e=super.toArray().reverse(),t=Buffer.from(e);if(8===t.length)return t;if(t.length>=8)throw new Error("u64 too large");const n=Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){if(8!==e.length)throw new Error(`Invalid buffer length: ${e.length}`);return new Tt([...e].reverse().map((e=>`00${e.toString(16)}`.slice(-2))).join(""),16)}}const Bt=Je([xt("mint"),xt("owner"),kt("amount"),Lt(xt(),"delegate"),(e=>{const t=Xe((e=>new Pe(1,e))("discriminator"),null,"state");return t.addVariant(0,Je([]),"uninitialized"),t.addVariant(1,Je([]),"initialized"),t.addVariant(2,Je([]),"frozen"),t})(),Lt(kt(),"isNative"),kt("delegatedAmount"),Lt(xt(),"closeAuthority")]);class Pt{constructor(e,t,n,r,i,o,s,a){this._accounts=t,this._provider=n,this._programId=r,this._idlIx=i,this._idlTypes=s,this._customResolver=a,this._args=e,this._accountStore=new Rt(n,o,this._programId)}args(e){this._args=e}async resolve(){for(await this.resolveConst(this._idlIx.accounts),this._resolveEventCpi(this._idlIx.accounts);await this.resolvePdas(this._idlIx.accounts)+await this.resolveRelations(this._idlIx.accounts)+await this.resolveCustom()>0;);}async resolveCustom(){if(this._customResolver){const{accounts:e,resolved:t}=await this._customResolver({args:this._args,accounts:this._accounts,provider:this._provider,programId:this._programId,idlIx:this._idlIx});return this._accounts=e,t}return 0}resolveOptionalsHelper(e,t){const n={};for(const r of t){const t=r.name,i=e[t];void 0!==i&&(Ut(i)?ct(r)?n[t]=this.resolveOptionalsHelper(i,r.accounts):n[t]=Dt(i,!0):null!==i?n[t]=S(i):r.isOptional&&(n[t]=this._programId))}return n}resolveOptionals(e){Object.assign(this._accounts,this.resolveOptionalsHelper(e,this._idlIx.accounts))}get(e){const t=e.reduce(((e,t)=>e&&e[t]),this._accounts);if(t&&t.toBase58)return t}set(e,t){let n=this._accounts;e.forEach(((r,i)=>{i==e.length-1&&(n[r]=t),n[r]=n[r]||{},n=n[r]}))}async resolveConst(e,t=[]){for(let n=0;n<e.length;n+=1){const r=e[n],i=r.accounts;i&&await this.resolveConst(i,[...t,d(r.name)]);const o=r,s=d(r.name);if(o.isSigner&&!this.get([...t,s])){if(void 0===this._provider.wallet)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this.set([...t,s],this._provider.wallet.publicKey)}Reflect.has(Pt.CONST_ACCOUNTS,s)&&!this.get([...t,s])&&this.set([...t,s],Pt.CONST_ACCOUNTS[s])}}_resolveEventCpi(t,n=[]){for(const r in t){const i=t[r],o=i.accounts;o&&this._resolveEventCpi(o,[...n,d(i.name)]);const s=+r+1;if(s===t.length)return;const a=d(t[r].name),c=d(t[s].name);if("eventAuthority"===a&&"program"===c){const t=[...n,a],r=[...n,c];return this.get(t)||this.set(t,e.findProgramAddressSync([Buffer.from("__event_authority")],this._programId)[0]),void(this.get(r)||this.set(r,this._programId))}}}async resolvePdas(e,t=[]){let n=0;for(let r=0;r<e.length;r+=1){const i=e[r],o=i.accounts;o&&(n+=await this.resolvePdas(o,[...t,d(i.name)]));const s=i,a=d(i.name);s.pda&&s.pda.seeds.length>0&&!this.get([...t,a])&&Boolean(await this.autoPopulatePda(s,t))&&(n+=1)}return n}async resolveRelations(e,t=[]){let n=0;for(let r=0;r<e.length;r+=1){const i=e[r],o=i.accounts;o&&(n+=await this.resolveRelations(o,[...t,d(i.name)]));const s=i.relations||[],a=d(i.name),c=[...t,a],u=this.get(c);if(u){const e=s.filter((e=>!this.get([...t,d(e)])));if(n+=e.length,e.length>0){const n=await this._accountStore.fetchAccount({publicKey:u});await Promise.all(e.map((async e=>{const r=d(e);return this.set([...t,r],n[r]),n[r]})))}}}return n}async autoPopulatePda(t,n=[]){if(!t.pda||!t.pda.seeds)throw new Error("Must have seeds");const r=await Promise.all(t.pda.seeds.map((e=>this.toBuffer(e,n))));if(r.some((e=>void 0===e)))return;const i=await this.parseProgramId(t,n);if(!i)return;const[o]=await e.findProgramAddress(r,i);this.set([...n,d(t.name)],o)}async parseProgramId(t,n=[]){var r;if(!(null===(r=t.pda)||void 0===r?void 0:r.programId))return this._programId;switch(t.pda.programId.kind){case"const":return new e(this.toBufferConst(t.pda.programId.value));case"arg":return this.argValue(t.pda.programId);case"account":return await this.accountValue(t.pda.programId,n);default:throw new Error(`Unexpected program seed: ${t.pda.programId}`)}}async toBuffer(e,t=[]){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e,t);default:throw new Error(`Unexpected seed: ${e}`)}}getType(e,t=[]){if(t.length>0&&e.defined){const n=this._idlTypes.find((t=>t.name===e.defined));if(!n)throw new Error(`Cannot find type ${e.defined}`);const r=n.type.fields.find((e=>e.name===t[0]));return this.getType(r.type,t.slice(1))}return e}toBufferConst(e){return this.toBufferValue(this.getType(e.type),e.value)}async toBufferArg(e){const t=this.argValue(e);if(void 0!==t)return this.toBufferValue(this.getType(e.type,(e.path||"").split(".").slice(1)),t)}argValue(e){const t=e.path.split("."),n=d(t[0]),r=this._idlIx.args.findIndex((e=>e.name===n));if(-1===r)throw new Error(`Unable to find argument for seed: ${n}`);return t.slice(1).reduce(((e,t)=>(e||{})[t]),this._args[r])}async toBufferAccount(e,t=[]){const n=await this.accountValue(e,t);if(n)return this.toBufferValue(e.type,n)}async accountValue(e,t=[]){const n=e.path.split("."),r=n[0],i=this.get([...t,d(r)]);if(null===i)throw new Error("fieldPubkey is null");if(1===n.length)return i;const o=await this._accountStore.fetchAccount({publicKey:i,name:e.account});return this.parseAccountValue(o,n.slice(1))}parseAccountValue(e,t){let n;for(;t.length>0;)n=e[d(t[0])],t=t.slice(1);return n}toBufferValue(e,t){switch(e){case"u8":return Buffer.from([t]);case"u16":let r=Buffer.alloc(2);return r.writeUInt16LE(t),r;case"u32":let i=Buffer.alloc(4);return i.writeUInt32LE(t),i;case"u64":let o=Buffer.alloc(8);return o.writeBigUInt64LE(BigInt(t)),o;case"string":return Buffer.from((n=t,(new TextEncoder).encode(n)));case"publicKey":return t.toBuffer();default:if(e.array)return Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}var n}}Pt.CONST_ACCOUNTS={associatedTokenProgram:st,rent:t,systemProgram:n.programId,tokenProgram:ot,clock:r};class Rt{constructor(e,t,n){this._provider=e,this._programId=n,this._cache=new Map,this._idls={},this._idls[n.toBase58()]=t}async ensureIdl(e){if(!this._idls[e.toBase58()]){const t=await jt.fetchIdl(e,this._provider);if(t){const n=new jt(t,e,this._provider);this._idls[e.toBase58()]=n.account}}return this._idls[e.toBase58()]}async fetchAccount({publicKey:e,name:t,programId:n=this._programId}){const r=e.toString();if(!this._cache.has(r))if("TokenAccount"===t){const t=await this._provider.connection.getAccountInfo(e);if(null===t)throw new Error(`invalid account info for ${r}`);const n=function(e){return Bt.decode(e)}(t.data);this._cache.set(r,n)}else if(t){const i=await this.ensureIdl(n);if(i){const n=i[d(t)];if(n){const t=await n.fetch(e);this._cache.set(r,t)}}}else{const t=await this._provider.connection.getAccountInfo(e);if(null===t)throw new Error(`invalid account info for ${r}`);const n=t.data,i=await this.ensureIdl(t.owner);if(i){const e=Object.values(i)[0];if(!e)throw new Error("No accounts for this program");const t=e.coder.accounts.decodeAny(n);this._cache.set(r,t)}}return this._cache.get(r)}}class Ct{static build(e,t,n,r,i,o,s,a,c,u,l){return(...d)=>new qt(d,r,i,o,s,a,e,t,n,c,u,l)}}function Ut(e){return"object"==typeof e&&null!==e&&!("_bn"in e)}function Dt(e,t){const n={};for(const r in e){const i=e[r];if(null!==i)n[r]=Ut(i)?Dt(i,!0):S(i);else if(t)throw new Error("Failed to resolve optionals due to IDL type mismatch with input accounts!")}return n}class qt{constructor(e,t,n,r,i,o,s,a,c,u,l,d){this._ixFn=t,this._txFn=n,this._rpcFn=r,this._simulateFn=i,this._viewFn=o,this._programId=a,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._autoResolveAccounts=!0,this._args=e,this._accountsResolver=new Pt(e,this._accounts,s,a,c,u,l,d)}args(e){this._args=e,this._accountsResolver.args(e)}async pubkeys(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._accounts}interface(e){if("spl_transfer_hook_interface::initialize_extra_account_metas"===e)this._discriminator=Buffer.from([43,34,13,49,167,88,235,235]);else{if("spl_transfer_hook_interface::execute"!==e)throw new Error(`Unsupported interface: ${e}`);this._discriminator=Buffer.from([105,37,101,197,75,251,102,26])}return this}accounts(e){return this._autoResolveAccounts=!0,this._accountsResolver.resolveOptionals(e),this}accountsStrict(e){return this._autoResolveAccounts=!1,this._accountsResolver.resolveOptionals(e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e,discriminator:this._discriminator})}async rpcAndKeys(e){return{pubkeys:await this.pubkeys(),signature:await this.rpc(e)}}async view(e){if(this._autoResolveAccounts&&await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,discriminator:this._discriminator})}async prepare(){return{instruction:await this.instruction(),pubkeys:await this.pubkeys(),signers:await this._signers}}async transaction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,discriminator:this._discriminator})}}class Nt{static build(e,t,n,r){const i=t.accounts.find((e=>e.isMut)),o=!!t.returns;if(i||!o)return;return async(...i)=>{var o,s;let a=await n(...i);const c=`Program return: ${e} `;let u=a.raw.find((e=>e.startsWith(c)));if(!u)throw new Error("View expected return log");let l=v(u.slice(c.length)),d=t.returns;if(!d)throw new Error("View expected return type");return ge.fieldLayout({type:d},Array.from([...null!==(o=r.accounts)&&void 0!==o?o:[],...null!==(s=r.types)&&void 0!==s?s:[]])).decode(l)}}}class Vt{static build(e,t,n,r,i){const o={},s={},a={},c={},u={},l={},h=function(e){const t=new Map;return e.errors&&e.errors.forEach((e=>{var n;let r=null!==(n=e.msg)&&void 0!==n?n:e.name;t.set(e.code,r)})),t}(e),f=e.accounts?pt.build(e,t,n,r):{};return e.instructions.forEach((p=>{const m=dt.build(p,((e,n,r)=>t.instruction.encode(e,n,r)),n),g=ht.build(p,m),y=ft.build(p,g,h,r),w=It.build(p,g,h,r,t,n,e),v=Nt.build(n,p,w,e),b=Ct.build(r,n,p,m,g,y,w,v,f,e.types||[],i&&i(p)),E=d(p.name);s[E]=m,a[E]=g,o[E]=y,c[E]=w,u[E]=b,v&&(l[E]=v)})),[o,s,a,f,c,u,l]}}class jt{get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}constructor(e,t,n,r,i){t=S(t),n||(n=ee()),this._idl=e,this._provider=n,this._programId=t,this._coder=null!=r?r:new xe(e),this._events=new Et(this._programId,n,this._coder);const[o,s,a,c,u,l,d]=Vt.build(e,this._coder,t,n,null!=i?i:()=>{});this.rpc=o,this.instruction=s,this.transaction=a,this.account=c,this.simulate=u,this.methods=l,this.views=d}static async at(e,t){const n=S(e),r=await jt.fetchIdl(n,t);if(!r)throw new Error(`IDL not found for program: ${e.toString()}`);return new jt(r,n,t)}static async fetchIdl(t,n){n=null!=n?n:ee();const r=S(t),i=await async function(t){const n=(await e.findProgramAddress([],t))[0];return await e.createWithSeed(n,"anchor:idl",t)}(r),o=await n.connection.getAccountInfo(i);if(!o)return null;let s=(a=o.data.slice(8),ut.decode(a));var a;const c=p(s.data);return JSON.parse(function(e){return new TextDecoder("utf-8").decode(e)}(c))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}new e("11111111111111111111111111111111");var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.s16=Ft.s8=Ft.nu64be=Ft.u48be=Ft.u40be=Ft.u32be=Ft.u24be=Ft.u16be=Ft.nu64=Ft.u48=Ft.u40=Mn=Ft.u32=Ft.u24=Ft.u16=On=Ft.u8=Ln=Ft.offset=Ft.greedy=Ft.Constant=Ft.UTF8=Ft.CString=Ft.Blob=Ft.Boolean=Ft.BitField=Ft.BitStructure=Ft.VariantLayout=Ft.Union=Ft.UnionLayoutDiscriminator=Ft.UnionDiscriminator=Ft.Structure=Ft.Sequence=Ft.DoubleBE=Ft.Double=Ft.FloatBE=Ft.Float=Ft.NearInt64BE=Ft.NearInt64=Ft.NearUInt64BE=Ft.NearUInt64=Ft.IntBE=Ft.Int=Ft.UIntBE=Ft.UInt=Ft.OffsetLayout=Ft.GreedyCount=Ft.ExternalLayout=Ft.bindConstructorLayout=Ft.nameWithProperty=Ft.Layout=Ft.uint8ArrayToBuffer=Ft.checkUint8Array=void 0,Ft.constant=Ft.utf8=Ft.cstr=Rn=Ft.blob=Ft.unionLayoutDiscriminator=Ft.union=Bn=Ft.seq=Ft.bits=Tn=Ft.struct=Ft.f64be=Ft.f64=Ft.f32be=Ft.f32=Ft.ns64be=Ft.s48be=Ft.s40be=Ft.s32be=Ft.s24be=Ft.s16be=Ft.ns64=Ft.s48=Ft.s40=Ft.s32=Ft.s24=void 0;const $t=a;function zt(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function Kt(e){return zt(e),$t.Buffer.from(e.buffer,e.byteOffset,e.length)}Ft.checkUint8Array=zt,Ft.uint8ArrayToBuffer=Kt;class Wt{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Gt=Ft.Layout=Wt;function Ht(e,t){return t.property?e+"["+t.property+"]":e}Ft.nameWithProperty=Ht,Ft.bindConstructorLayout=function(e,t){if("function"!=typeof e)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(e,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof Wt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=()=>new e,Object.defineProperty(e.prototype,"encode",{value(e,n){return t.encode(this,e,n)},writable:!0}),Object.defineProperty(e,"decode",{value:(e,n)=>t.decode(e,n),writable:!0})};class Jt extends Wt{isCount(){throw new Error("ExternalLayout is abstract")}}Ft.ExternalLayout=Jt;class Xt extends Jt{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){zt(e);const n=e.length-t;return Math.floor(n/this.elementSpan)}encode(e,t,n){return 0}}Ft.GreedyCount=Xt;class Zt extends Jt{constructor(e,t=0,n){if(!(e instanceof Wt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Yt||this.layout instanceof Qt}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,n=0){return this.layout.encode(e,t,n+this.offset)}}Ft.OffsetLayout=Zt;class Yt extends Wt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return Kt(e).readUIntLE(t,this.span)}encode(e,t,n=0){return Kt(t).writeUIntLE(e,n,this.span),this.span}}Ft.UInt=Yt;class Qt extends Wt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return Kt(e).readUIntBE(t,this.span)}encode(e,t,n=0){return Kt(t).writeUIntBE(e,n,this.span),this.span}}Ft.UIntBE=Qt;class en extends Wt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return Kt(e).readIntLE(t,this.span)}encode(e,t,n=0){return Kt(t).writeIntLE(e,n,this.span),this.span}}Ft.Int=en;class tn extends Wt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return Kt(e).readIntBE(t,this.span)}encode(e,t,n=0){return Kt(t).writeIntBE(e,n,this.span),this.span}}Ft.IntBE=tn;const nn=Math.pow(2,32);function rn(e){const t=Math.floor(e/nn);return{hi32:t,lo32:e-t*nn}}function on(e,t){return e*nn+t}class sn extends Wt{constructor(e){super(8,e)}decode(e,t=0){const n=Kt(e),r=n.readUInt32LE(t);return on(n.readUInt32LE(t+4),r)}encode(e,t,n=0){const r=rn(e),i=Kt(t);return i.writeUInt32LE(r.lo32,n),i.writeUInt32LE(r.hi32,n+4),8}}Ft.NearUInt64=sn;class an extends Wt{constructor(e){super(8,e)}decode(e,t=0){const n=Kt(e);return on(n.readUInt32BE(t),n.readUInt32BE(t+4))}encode(e,t,n=0){const r=rn(e),i=Kt(t);return i.writeUInt32BE(r.hi32,n),i.writeUInt32BE(r.lo32,n+4),8}}Ft.NearUInt64BE=an;class cn extends Wt{constructor(e){super(8,e)}decode(e,t=0){const n=Kt(e),r=n.readUInt32LE(t);return on(n.readInt32LE(t+4),r)}encode(e,t,n=0){const r=rn(e),i=Kt(t);return i.writeUInt32LE(r.lo32,n),i.writeInt32LE(r.hi32,n+4),8}}Ft.NearInt64=cn;class un extends Wt{constructor(e){super(8,e)}decode(e,t=0){const n=Kt(e);return on(n.readInt32BE(t),n.readUInt32BE(t+4))}encode(e,t,n=0){const r=rn(e),i=Kt(t);return i.writeInt32BE(r.hi32,n),i.writeUInt32BE(r.lo32,n+4),8}}Ft.NearInt64BE=un;class ln extends Wt{constructor(e){super(4,e)}decode(e,t=0){return Kt(e).readFloatLE(t)}encode(e,t,n=0){return Kt(t).writeFloatLE(e,n),4}}Ft.Float=ln;class dn extends Wt{constructor(e){super(4,e)}decode(e,t=0){return Kt(e).readFloatBE(t)}encode(e,t,n=0){return Kt(t).writeFloatBE(e,n),4}}Ft.FloatBE=dn;class hn extends Wt{constructor(e){super(8,e)}decode(e,t=0){return Kt(e).readDoubleLE(t)}encode(e,t,n=0){return Kt(t).writeDoubleLE(e,n),8}}Ft.Double=hn;class fn extends Wt{constructor(e){super(8,e)}decode(e,t=0){return Kt(e).readDoubleBE(t)}encode(e,t,n=0){return Kt(t).writeDoubleBE(e,n),8}}Ft.DoubleBE=fn;class pn extends Wt{constructor(e,t,n){if(!(e instanceof Wt))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof Jt&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let r=-1;!(t instanceof Jt)&&0<e.span&&(r=t*e.span),super(r,n),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let n=0,r=this.count;if(r instanceof Jt&&(r=r.decode(e,t)),0<this.elementLayout.span)n=r*this.elementLayout.span;else{let i=0;for(;i<r;)n+=this.elementLayout.getSpan(e,t+n),++i}return n}decode(e,t=0){const n=[];let r=0,i=this.count;for(i instanceof Jt&&(i=i.decode(e,t));r<i;)n.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),r+=1;return n}encode(e,t,n=0){const r=this.elementLayout,i=e.reduce(((e,i)=>e+r.encode(i,t,n+e)),0);return this.count instanceof Jt&&this.count.encode(e.length,t,n),i}}Ft.Sequence=pn;class mn extends Wt{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof Wt),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===n&&(n=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=e.reduce(((e,t)=>e+t.getSpan()),0)}catch(e){}super(r,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce(((n,r)=>{const i=r.getSpan(e,t);return t+=i,n+i}),0)}catch(e){throw new RangeError("indeterminate span")}return n}decode(e,t=0){zt(e);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(e,t)),t+=r.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n=0){const r=n;let i=0,o=0;for(const r of this.fields){let s=r.span;if(o=0<s?s:0,void 0!==r.property){const i=e[r.property];void 0!==i&&(o=r.encode(i,t,n),0>s&&(s=r.getSpan(t,n)))}i=n,n+=s}return i+o-r}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}Ft.Structure=mn;class gn{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,n){throw new Error("UnionDiscriminator is abstract")}}Ft.UnionDiscriminator=gn;class yn extends gn{constructor(e,t){if(!(e instanceof Jt&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,n){return this.layout.encode(e,t,n)}}Ft.UnionLayoutDiscriminator=yn;class wn extends Wt{constructor(e,t,n){let r;if(e instanceof Yt||e instanceof Qt)r=new yn(new Zt(e));else if(e instanceof Jt&&e.isCount())r=new yn(e);else{if(!(e instanceof gn))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=e}if(void 0===t&&(t=null),!(null===t||t instanceof Wt))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&(e instanceof Yt||e instanceof Qt)&&(i+=r.layout.span)),super(i,n),this.discriminator=r,this.usesPrefixDiscriminator=e instanceof Yt||e instanceof Qt,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return o(e)},this.configGetSourceVariant=function(e){o=e.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const n=this.getVariant(e,t);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(n.property&&Object.prototype.hasOwnProperty.call(e,n.property))return n}throw new Error("unable to infer src variant")}decode(e,t=0){let n;const r=this.discriminator,i=r.decode(e,t),o=this.registry[i];if(void 0===o){const o=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=i,n[o.property]=o.decode(e,t+s)}else n=o.decode(e,t);return n}encode(e,t,n=0){const r=this.getSourceVariant(e);if(void 0===r){const r=this.discriminator,i=this.defaultLayout;let o=0;return this.usesPrefixDiscriminator&&(o=r.layout.span),r.encode(e[r.property],t,n),o+i.encode(e[i.property],t,n+o)}return r.encode(e,t,n)}addVariant(e,t,n){const r=new vn(this,e,t,n);return this.registry[e]=r,r}getVariant(e,t=0){let n;return n=e instanceof Uint8Array?this.discriminator.decode(e,t):e,this.registry[n]}}Ft.Union=wn;class vn extends Wt{constructor(e,t,n,r){if(!(e instanceof wn))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof Wt))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=n?n.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,r),this.union=e,this.variant=t,this.layout=n||null}getSpan(e,t=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let r=0;return this.layout&&(r=this.layout.getSpan(e,t+n)),n+r}decode(e,t=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(e,t+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(e,t,n=0){let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,n);let i=r;if(this.layout&&(this.layout.encode(e[this.property],t,n+r),i+=this.layout.getSpan(t,n+r),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}function bn(e){return 0>e&&(e+=4294967296),e}Ft.VariantLayout=vn;class En extends Wt{constructor(e,t,n){if(!(e instanceof Yt||e instanceof Qt))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof t&&void 0===n&&(n=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,n),this.word=e,this.msb=!!t,this.fields=[];let r=0;this._packedSetValue=function(e){return r=bn(e),this},this._packedGetValue=function(){return r}}decode(e,t=0){const n=this.makeDestinationObject(),r=this.word.decode(e,t);this._packedSetValue(r);for(const t of this.fields)void 0!==t.property&&(n[t.property]=t.decode(e));return n}encode(e,t,n=0){const r=this.word.decode(t,n);this._packedSetValue(r);for(const t of this.fields)if(void 0!==t.property){const n=e[t.property];void 0!==n&&t.encode(n)}return this.word.encode(this._packedGetValue(),t,n)}addField(e,t){const n=new Sn(this,e,t);return this.fields.push(n),n}addBoolean(e){const t=new An(this,e);return this.fields.push(t),t}fieldFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}Ft.BitStructure=En;class Sn{constructor(e,t,n){if(!(e instanceof En))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const r=8*e.span,i=e.fields.reduce(((e,t)=>e+t.bits),0);if(t+i>r)throw new Error("bits too long for span remainder ("+(r-i)+" of "+r+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,32===t&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=r-i-t),this.wordMask=bn(this.valueMask<<this.start),this.property=n}decode(e,t){return bn(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(e){if("number"!=typeof e||!Number.isInteger(e)||e!==bn(e&this.valueMask))throw new TypeError(Ht("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),n=bn(e<<this.start);this.container._packedSetValue(bn(t&~this.wordMask)|n)}}Ft.BitField=Sn;class An extends Sn{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){"boolean"==typeof e&&(e=+e),super.encode(e)}}Ft.Boolean=An;class _n extends Wt{constructor(e,t){if(!(e instanceof Jt&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof Jt||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t=0){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),Kt(e).slice(t,t+n)}encode(e,t,n){let r=this.length;if(this.length instanceof Jt&&(r=e.length),!(e instanceof Uint8Array&&r===e.length))throw new TypeError(Ht("Blob.encode",this)+" requires (length "+r+") Uint8Array as src");if(n+r>t.length)throw new RangeError("encoding overruns Uint8Array");const i=Kt(e);return Kt(t).write(i.toString("hex"),n,r,"hex"),this.length instanceof Jt&&this.length.encode(r,t,n),r}}Ft.Blob=_n;class In extends Wt{constructor(e){super(-1,e)}getSpan(e,t=0){zt(e);let n=t;for(;n<e.length&&0!==e[n];)n+=1;return 1+n-t}decode(e,t=0){const n=this.getSpan(e,t);return Kt(e).slice(t,t+n-1).toString("utf-8")}encode(e,t,n=0){"string"!=typeof e&&(e=String(e));const r=$t.Buffer.from(e,"utf8"),i=r.length;if(n+i>t.length)throw new RangeError("encoding overruns Buffer");const o=Kt(t);return r.copy(o,n),o[n+i]=0,i+1}}Ft.CString=In;class kn extends Wt{constructor(e,t){if("string"==typeof e&&void 0===t&&(t=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return zt(e),e.length-t}decode(e,t=0){const n=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return Kt(e).slice(t,t+n).toString("utf-8")}encode(e,t,n=0){"string"!=typeof e&&(e=String(e));const r=$t.Buffer.from(e,"utf8"),i=r.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return r.copy(Kt(t),n),i}}Ft.UTF8=kn;class xn extends Wt{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,n){return 0}}Ft.Constant=xn,Ft.greedy=(e,t)=>new Xt(e,t);var Ln=Ft.offset=(e,t,n)=>new Zt(e,t,n),On=Ft.u8=e=>new Yt(1,e);Ft.u16=e=>new Yt(2,e),Ft.u24=e=>new Yt(3,e);var Mn=Ft.u32=e=>new Yt(4,e);Ft.u40=e=>new Yt(5,e),Ft.u48=e=>new Yt(6,e),Ft.nu64=e=>new sn(e),Ft.u16be=e=>new Qt(2,e),Ft.u24be=e=>new Qt(3,e),Ft.u32be=e=>new Qt(4,e),Ft.u40be=e=>new Qt(5,e),Ft.u48be=e=>new Qt(6,e),Ft.nu64be=e=>new an(e),Ft.s8=e=>new en(1,e),Ft.s16=e=>new en(2,e),Ft.s24=e=>new en(3,e),Ft.s32=e=>new en(4,e),Ft.s40=e=>new en(5,e),Ft.s48=e=>new en(6,e),Ft.ns64=e=>new cn(e),Ft.s16be=e=>new tn(2,e),Ft.s24be=e=>new tn(3,e),Ft.s32be=e=>new tn(4,e),Ft.s40be=e=>new tn(5,e),Ft.s48be=e=>new tn(6,e),Ft.ns64be=e=>new un(e),Ft.f32=e=>new ln(e),Ft.f32be=e=>new dn(e),Ft.f64=e=>new hn(e),Ft.f64be=e=>new fn(e);var Tn=Ft.struct=(e,t,n)=>new mn(e,t,n);Ft.bits=(e,t,n)=>new En(e,t,n);var Bn=Ft.seq=(e,t,n)=>new pn(e,t,n),Pn=Ft.union=(e,t,n)=>new wn(e,t,n);Ft.unionLayoutDiscriminator=(e,t)=>new yn(e,t);var Rn=Ft.blob=(e,t)=>new _n(e,t);Ft.cstr=e=>new In(e),Ft.utf8=(e,t)=>new kn(e,t),Ft.constant=(e,t)=>new xn(e,t);const Cn=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)});var Un={};Object.defineProperty(Un,"__esModule",{value:!0});var Dn=Un.toBigIntLE=function(e){{const t=Buffer.from(e);t.reverse();const n=t.toString("hex");return 0===n.length?BigInt(0):BigInt(`0x${n}`)}};Un.toBigIntBE=function(e){{const t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)}};var qn=Un.toBufferLE=function(e,t){{const n=e.toString(16),r=Buffer.from(n.padStart(2*t,"0").slice(0,2*t),"hex");return r.reverse(),r}};Un.toBufferBE=function(e,t){{const n=e.toString(16);return Buffer.from(n.padStart(2*t,"0").slice(0,2*t),"hex")}};const Nn=(16,e=>{const t=Rn(16,e),{encode:n,decode:r}=Cn(t),i=t;return i.decode=(e,t)=>{const n=r(e,t);return Dn(Buffer.from(n))},i.encode=(e,t,r)=>{const i=qn(e,16);return n(i,t,r)},i});var Vn=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,jn=Math.ceil,Fn=Math.floor,$n="[BigNumber Error] ",zn=$n+"Number primitive has more than 15 significant digits: ",Kn=1e14,Wn=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Gn=1e9;function Hn(e){var t=0|e;return e>0||e===t?t:t-1}function Jn(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(n=14-(t=e[r++]+"").length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function Xn(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,c=e.e,u=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=c==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(a=(c=i.length)<(u=o.length)?c:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return c==u?0:c>u^n?1:-1}function Zn(e,t,n,r){if(e<t||e>n||e!==Fn(e))throw Error($n+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Yn(e){var t=e.c.length-1;return Hn(e.e/14)==t&&e.c[t]%2!=0}function Qn(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function er(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}var tr=function e(t){var n,r,i,o,s,a,c,u,l,d,h=k.prototype={constructor:k,toString:null,valueOf:null},f=new k(1),p=20,m=4,g=-7,y=21,w=-1e7,v=1e7,b=!1,E=1,S=0,A={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},_="0123456789abcdefghijklmnopqrstuvwxyz",I=!0;function k(e,t){var n,o,s,a,c,u,l,d,h=this;if(!(h instanceof k))return new k(e,t);if(null==t){if(e&&!0===e._isBigNumber)return h.s=e.s,void(!e.c||e.e>v?h.c=h.e=null:e.e<w?h.c=[h.e=0]:(h.e=e.e,h.c=e.c.slice()));if((u="number"==typeof e)&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,c=e;c>=10;c/=10,a++);return void(a>v?h.c=h.e=null:(h.e=a,h.c=[e]))}d=String(e)}else{if(!Vn.test(d=String(e)))return i(h,d,u);h.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(a=d.indexOf("."))>-1&&(d=d.replace(".","")),(c=d.search(/e/i))>0?(a<0&&(a=c),a+=+d.slice(c+1),d=d.substring(0,c)):a<0&&(a=d.length)}else{if(Zn(t,2,_.length,"Base"),10==t&&I)return M(h=new k(e),p+h.e+1,m);if(d=String(e),u="number"==typeof e){if(0*e!=0)return i(h,d,u,t);if(h.s=1/e<0?(d=d.slice(1),-1):1,k.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(zn+e)}else h.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(n=_.slice(0,t),a=c=0,l=d.length;c<l;c++)if(n.indexOf(o=d.charAt(c))<0){if("."==o){if(c>a){a=l;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,c=-1,a=0;continue}return i(h,String(e),u,t)}u=!1,(a=(d=r(d,t,10,h.s)).indexOf("."))>-1?d=d.replace(".",""):a=d.length}for(c=0;48===d.charCodeAt(c);c++);for(l=d.length;48===d.charCodeAt(--l););if(d=d.slice(c,++l)){if(l-=c,u&&k.DEBUG&&l>15&&(e>9007199254740991||e!==Fn(e)))throw Error(zn+h.s*e);if((a=a-c-1)>v)h.c=h.e=null;else if(a<w)h.c=[h.e=0];else{if(h.e=a,h.c=[],c=(a+1)%14,a<0&&(c+=14),c<l){for(c&&h.c.push(+d.slice(0,c)),l-=14;c<l;)h.c.push(+d.slice(c,c+=14));c=14-(d=d.slice(c)).length}else c-=l;for(;c--;d+="0");h.c.push(+d)}}else h.c=[h.e=0]}function x(e,t,n,r){var i,o,s,a,c;if(null==n?n=m:Zn(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)c=Jn(e.c),c=1==r||2==r&&(s<=g||s>=y)?Qn(c,s):er(c,s,"0");else if(o=(e=M(new k(e),t,n)).e,a=(c=Jn(e.c)).length,1==r||2==r&&(t<=o||o<=g)){for(;a<t;c+="0",a++);c=Qn(c,o)}else if(t-=s,c=er(c,o,"0"),o+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=o-a)>0)for(o+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function L(e,t){for(var n,r=1,i=new k(e[0]);r<e.length;r++){if(!(n=new k(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function O(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+14*n-1)>v?e.c=e.e=null:n<w?e.c=[e.e=0]:(e.e=n,e.c=t),e}function M(e,t,n,r){var i,o,s,a,c,u,l,d=e.c,h=Wn;if(d){e:{for(i=1,a=d[0];a>=10;a/=10,i++);if((o=t-i)<0)o+=14,s=t,l=(c=d[u=0])/h[i-s-1]%10|0;else if((u=jn((o+1)/14))>=d.length){if(!r)break e;for(;d.length<=u;d.push(0));c=l=0,i=1,s=(o%=14)-14+1}else{for(c=a=d[u],i=1;a>=10;a/=10,i++);l=(s=(o%=14)-14+i)<0?0:c/h[i-s-1]%10|0}if(r=r||t<0||null!=d[u+1]||(s<0?c:c%h[i-s-1]),r=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(o>0?s>0?c/h[i-s]:0:d[u-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,r?(t-=e.e+1,d[0]=h[(14-t%14)%14],e.e=-t||0):d[0]=e.e=0,e;if(0==o?(d.length=u,a=1,u--):(d.length=u+1,a=h[14-o],d[u]=s>0?Fn(c/h[i-s]%h[s])*a:0),r)for(;;){if(0==u){for(o=1,s=d[0];s>=10;s/=10,o++);for(s=d[0]+=a,a=1;s>=10;s/=10,a++);o!=a&&(e.e++,d[0]==Kn&&(d[0]=1));break}if(d[u]+=a,d[u]!=Kn)break;d[u--]=0,a=1}for(o=d.length;0===d[--o];d.pop());}e.e>v?e.c=e.e=null:e.e<w&&(e.c=[e.e=0])}return e}function T(e){var t,n=e.e;return null===n?e.toString():(t=Jn(e.c),t=n<=g||n>=y?Qn(t,n):er(t,n,"0"),e.s<0?"-"+t:t)}return k.clone=e,k.ROUND_UP=0,k.ROUND_DOWN=1,k.ROUND_CEIL=2,k.ROUND_FLOOR=3,k.ROUND_HALF_UP=4,k.ROUND_HALF_DOWN=5,k.ROUND_HALF_EVEN=6,k.ROUND_HALF_CEIL=7,k.ROUND_HALF_FLOOR=8,k.EUCLID=9,k.config=k.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error($n+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(Zn(n=e[t],0,Gn,t),p=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(Zn(n=e[t],0,8,t),m=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(Zn(n[0],-Gn,0,t),Zn(n[1],0,Gn,t),g=n[0],y=n[1]):(Zn(n,-Gn,Gn,t),g=-(y=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)Zn(n[0],-Gn,-1,t),Zn(n[1],1,Gn,t),w=n[0],v=n[1];else{if(Zn(n,-Gn,Gn,t),!n)throw Error($n+t+" cannot be zero: "+n);w=-(v=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error($n+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw b=!n,Error($n+"crypto unavailable");b=n}else b=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(Zn(n=e[t],0,9,t),E=n),e.hasOwnProperty(t="POW_PRECISION")&&(Zn(n=e[t],0,Gn,t),S=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error($n+t+" not an object: "+n);A=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error($n+t+" invalid: "+n);I="0123456789"==n.slice(0,10),_=n}}return{DECIMAL_PLACES:p,ROUNDING_MODE:m,EXPONENTIAL_AT:[g,y],RANGE:[w,v],CRYPTO:b,MODULO_MODE:E,POW_PRECISION:S,FORMAT:A,ALPHABET:_}},k.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!k.DEBUG)return!0;var t,n,r=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&i>=-Gn&&i<=Gn&&i===Fn(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=Kn||n!==Fn(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===o||1===o||-1===o))return!0;throw Error($n+"Invalid BigNumber: "+e)},k.maximum=k.max=function(){return L(arguments,h.lt)},k.minimum=k.min=function(){return L(arguments,h.gt)},k.random=(o=9007199254740992,s=Math.random()*o&2097151?function(){return Fn(Math.random()*o)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,o,a=0,c=[],u=new k(f);if(null==e?e=p:Zn(e,0,Gn),i=jn(e/14),b)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));a<i;)(o=131072*t[a]+(t[a+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[a]=n[0],t[a+1]=n[1]):(c.push(o%1e14),a+=2);a=i/2}else{if(!crypto.randomBytes)throw b=!1,Error($n+"crypto unavailable");for(t=crypto.randomBytes(i*=7);a<i;)(o=281474976710656*(31&t[a])+1099511627776*t[a+1]+4294967296*t[a+2]+16777216*t[a+3]+(t[a+4]<<16)+(t[a+5]<<8)+t[a+6])>=9e15?crypto.randomBytes(7).copy(t,a):(c.push(o%1e14),a+=7);a=i/7}if(!b)for(;a<i;)(o=s())<9e15&&(c[a++]=o%1e14);for(e%=14,(i=c[--a])&&e&&(o=Wn[14-e],c[a]=Fn(i/o)*o);0===c[a];c.pop(),a--);if(a<0)c=[r=0];else{for(r=-1;0===c[0];c.splice(0,1),r-=14);for(a=1,o=c[0];o>=10;o/=10,a++);a<14&&(r-=14-a)}return u.e=r,u.c=c,u}),k.sum=function(){for(var e=1,t=arguments,n=new k(t[0]);e<t.length;)n=n.plus(t[e++]);return n},r=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,c=e.length;a<c;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(r,i,o,s,a){var c,u,l,d,h,f,g,y,w=r.indexOf("."),v=p,b=m;for(w>=0&&(d=S,S=0,r=r.replace(".",""),f=(y=new k(i)).pow(r.length-w),S=d,y.c=t(er(Jn(f.c),f.e,"0"),10,o,e),y.e=y.c.length),l=d=(g=t(r,i,o,a?(c=_,e):(c=e,_))).length;0==g[--d];g.pop());if(!g[0])return c.charAt(0);if(w<0?--l:(f.c=g,f.e=l,f.s=s,g=(f=n(f,y,v,b,o)).c,h=f.r,l=f.e),w=g[u=l+v+1],d=o/2,h=h||u<0||null!=g[u+1],h=b<4?(null!=w||h)&&(0==b||b==(f.s<0?3:2)):w>d||w==d&&(4==b||h||6==b&&1&g[u-1]||b==(f.s<0?8:7)),u<1||!g[0])r=h?er(c.charAt(1),-v,c.charAt(0)):c.charAt(0);else{if(g.length=u,h)for(--o;++g[--u]>o;)g[u]=0,u||(++l,g=[1].concat(g));for(d=g.length;!g[--d];);for(w=0,r="";w<=d;r+=c.charAt(g[w++]));r=er(r,l,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,o,s,a=0,c=e.length,u=t%1e7,l=t/1e7|0;for(e=e.slice();c--;)a=((i=u*(o=e[c]%1e7)+(r=l*o+(s=e[c]/1e7|0)*u)%1e7*1e7+a)/n|0)+(r/1e7|0)+l*s,e[c]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,o,s,a){var c,u,l,d,h,f,p,m,g,y,w,v,b,E,S,A,_,I=r.s==i.s?1:-1,x=r.c,L=i.c;if(!(x&&x[0]&&L&&L[0]))return new k(r.s&&i.s&&(x?!L||x[0]!=L[0]:L)?x&&0==x[0]||!L?0*I:I/0:NaN);for(g=(m=new k(I)).c=[],I=o+(u=r.e-i.e)+1,a||(a=Kn,u=Hn(r.e/14)-Hn(i.e/14),I=I/14|0),l=0;L[l]==(x[l]||0);l++);if(L[l]>(x[l]||0)&&u--,I<0)g.push(1),d=!0;else{for(E=x.length,A=L.length,l=0,I+=2,(h=Fn(a/(L[0]+1)))>1&&(L=e(L,h,a),x=e(x,h,a),A=L.length,E=x.length),b=A,w=(y=x.slice(0,A)).length;w<A;y[w++]=0);_=L.slice(),_=[0].concat(_),S=L[0],L[1]>=a/2&&S++;do{if(h=0,(c=t(L,y,A,w))<0){if(v=y[0],A!=w&&(v=v*a+(y[1]||0)),(h=Fn(v/S))>1)for(h>=a&&(h=a-1),p=(f=e(L,h,a)).length,w=y.length;1==t(f,y,p,w);)h--,n(f,A<p?_:L,p,a),p=f.length,c=1;else 0==h&&(c=h=1),p=(f=L.slice()).length;if(p<w&&(f=[0].concat(f)),n(y,f,w,a),w=y.length,-1==c)for(;t(L,y,A,w)<1;)h++,n(y,A<w?_:L,w,a),w=y.length}else 0===c&&(h++,y=[0]);g[l++]=h,y[0]?y[w++]=x[b]||0:(y=[x[b]],w=1)}while((b++<E||null!=y[0])&&I--);d=null!=y[0],g[0]||g.splice(0,1)}if(a==Kn){for(l=1,I=g[0];I>=10;I/=10,l++);M(m,o+(m.e=l+14*u-1)+1,s,d)}else m.e=u,m.r=+d;return m}}(),a=/^(-?)0([xbo])(?=\w[\w.]*$)/i,c=/^([^.]+)\.$/,u=/^\.([^.]+)$/,l=/^-?(Infinity|NaN)$/,d=/^\s*\+(?=[\w.])|^\s+|\s+$/g,i=function(e,t,n,r){var i,o=n?t:t.replace(d,"");if(l.test(o))e.s=isNaN(o)?null:o<0?-1:1;else{if(!n&&(o=o.replace(a,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,o=o.replace(c,"$1").replace(u,"0.$1")),t!=o))return new k(o,i);if(k.DEBUG)throw Error($n+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},h.absoluteValue=h.abs=function(){var e=new k(this);return e.s<0&&(e.s=1),e},h.comparedTo=function(e,t){return Xn(this,new k(e,t))},h.decimalPlaces=h.dp=function(e,t){var n,r,i,o=this;if(null!=e)return Zn(e,0,Gn),null==t?t=m:Zn(t,0,8),M(new k(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=14*((i=n.length-1)-Hn(this.e/14)),i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},h.dividedBy=h.div=function(e,t){return n(this,new k(e,t),p,m)},h.dividedToIntegerBy=h.idiv=function(e,t){return n(this,new k(e,t),0,1)},h.exponentiatedBy=h.pow=function(e,t){var n,r,i,o,s,a,c,u,l=this;if((e=new k(e)).c&&!e.isInteger())throw Error($n+"Exponent not an integer: "+T(e));if(null!=t&&(t=new k(t)),s=e.e>14,!l.c||!l.c[0]||1==l.c[0]&&!l.e&&1==l.c.length||!e.c||!e.c[0])return u=new k(Math.pow(+T(l),s?2-Yn(e):+T(e))),t?u.mod(t):u;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new k(NaN);(r=!a&&l.isInteger()&&t.isInteger())&&(l=l.mod(t))}else{if(e.e>9&&(l.e>0||l.e<-1||(0==l.e?l.c[0]>1||s&&l.c[1]>=24e7:l.c[0]<8e13||s&&l.c[0]<=9999975e7)))return o=l.s<0&&Yn(e)?-0:0,l.e>-1&&(o=1/o),new k(a?1/o:o);S&&(o=jn(S/14+2))}for(s?(n=new k(.5),a&&(e.s=1),c=Yn(e)):c=(i=Math.abs(+T(e)))%2,u=new k(f);;){if(c){if(!(u=u.times(l)).c)break;o?u.c.length>o&&(u.c.length=o):r&&(u=u.mod(t))}if(i){if(0===(i=Fn(i/2)))break;c=i%2}else if(M(e=e.times(n),e.e+1,1),e.e>14)c=Yn(e);else{if(0==(i=+T(e)))break;c=i%2}l=l.times(l),o?l.c&&l.c.length>o&&(l.c.length=o):r&&(l=l.mod(t))}return r?u:(a&&(u=f.div(u)),t?u.mod(t):o?M(u,S,m,void 0):u)},h.integerValue=function(e){var t=new k(this);return null==e?e=m:Zn(e,0,8),M(t,t.e+1,e)},h.isEqualTo=h.eq=function(e,t){return 0===Xn(this,new k(e,t))},h.isFinite=function(){return!!this.c},h.isGreaterThan=h.gt=function(e,t){return Xn(this,new k(e,t))>0},h.isGreaterThanOrEqualTo=h.gte=function(e,t){return 1===(t=Xn(this,new k(e,t)))||0===t},h.isInteger=function(){return!!this.c&&Hn(this.e/14)>this.c.length-2},h.isLessThan=h.lt=function(e,t){return Xn(this,new k(e,t))<0},h.isLessThanOrEqualTo=h.lte=function(e,t){return-1===(t=Xn(this,new k(e,t)))||0===t},h.isNaN=function(){return!this.s},h.isNegative=function(){return this.s<0},h.isPositive=function(){return this.s>0},h.isZero=function(){return!!this.c&&0==this.c[0]},h.minus=function(e,t){var n,r,i,o,s=this,a=s.s;if(t=(e=new k(e,t)).s,!a||!t)return new k(NaN);if(a!=t)return e.s=-t,s.plus(e);var c=s.e/14,u=e.e/14,l=s.c,d=e.c;if(!c||!u){if(!l||!d)return l?(e.s=-t,e):new k(d?s:NaN);if(!l[0]||!d[0])return d[0]?(e.s=-t,e):new k(l[0]?s:3==m?-0:0)}if(c=Hn(c),u=Hn(u),l=l.slice(),a=c-u){for((o=a<0)?(a=-a,i=l):(u=c,i=d),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(r=(o=(a=l.length)<(t=d.length))?a:t,a=t=0;t<r;t++)if(l[t]!=d[t]){o=l[t]<d[t];break}if(o&&(i=l,l=d,d=i,e.s=-e.s),(t=(r=d.length)-(n=l.length))>0)for(;t--;l[n++]=0);for(t=Kn-1;r>a;){if(l[--r]<d[r]){for(n=r;n&&!l[--n];l[n]=t);--l[n],l[r]+=Kn}l[r]-=d[r]}for(;0==l[0];l.splice(0,1),--u);return l[0]?O(e,l,u):(e.s=3==m?-1:1,e.c=[e.e=0],e)},h.modulo=h.mod=function(e,t){var r,i,o=this;return e=new k(e,t),!o.c||!e.s||e.c&&!e.c[0]?new k(NaN):!e.c||o.c&&!o.c[0]?new k(o):(9==E?(i=e.s,e.s=1,r=n(o,e,0,3),e.s=i,r.s*=i):r=n(o,e,0,E),(e=o.minus(r.times(e))).c[0]||1!=E||(e.s=o.s),e)},h.multipliedBy=h.times=function(e,t){var n,r,i,o,s,a,c,u,l,d,h,f,p,m,g,y=this,w=y.c,v=(e=new k(e,t)).c;if(!(w&&v&&w[0]&&v[0]))return!y.s||!e.s||w&&!w[0]&&!v||v&&!v[0]&&!w?e.c=e.e=e.s=null:(e.s*=y.s,w&&v?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=Hn(y.e/14)+Hn(e.e/14),e.s*=y.s,(c=w.length)<(d=v.length)&&(p=w,w=v,v=p,i=c,c=d,d=i),i=c+d,p=[];i--;p.push(0));for(m=Kn,g=1e7,i=d;--i>=0;){for(n=0,h=v[i]%g,f=v[i]/g|0,o=i+(s=c);o>i;)n=((u=h*(u=w[--s]%g)+(a=f*u+(l=w[s]/g|0)*h)%g*g+p[o]+n)/m|0)+(a/g|0)+f*l,p[o--]=u%m;p[o]=n}return n?++r:p.splice(0,1),O(e,p,r)},h.negated=function(){var e=new k(this);return e.s=-e.s||null,e},h.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new k(e,t)).s,!i||!t)return new k(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/14,s=e.e/14,a=r.c,c=e.c;if(!o||!s){if(!a||!c)return new k(i/0);if(!a[0]||!c[0])return c[0]?e:new k(a[0]?r:0*i)}if(o=Hn(o),s=Hn(s),a=a.slice(),i=o-s){for(i>0?(s=o,n=c):(i=-i,n=a),n.reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(t=c.length)<0&&(n=c,c=a,a=n,t=i),i=0;t;)i=(a[--t]=a[t]+c[t]+i)/Kn|0,a[t]=Kn===a[t]?0:a[t]%Kn;return i&&(a=[i].concat(a),++s),O(e,a,s)},h.precision=h.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return Zn(e,1,Gn),null==t?t=m:Zn(t,0,8),M(new k(o),e,t);if(!(n=o.c))return null;if(r=14*(i=n.length-1)+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},h.shiftedBy=function(e){return Zn(e,-9007199254740991,9007199254740991),this.times("1e"+e)},h.squareRoot=h.sqrt=function(){var e,t,r,i,o,s=this,a=s.c,c=s.s,u=s.e,l=p+4,d=new k("0.5");if(1!==c||!a||!a[0])return new k(!c||c<0&&(!a||a[0])?NaN:a?s:1/0);if(0==(c=Math.sqrt(+T(s)))||c==1/0?(((t=Jn(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=Hn((u+1)/2)-(u<0||u%2),r=new k(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new k(c+""),r.c[0])for((c=(u=r.e)+l)<3&&(c=0);;)if(o=r,r=d.times(o.plus(n(s,o,l,1))),Jn(o.c).slice(0,c)===(t=Jn(r.c)).slice(0,c)){if(r.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(M(r,r.e+p+2,1),e=!r.times(r).eq(s));break}if(!i&&(M(o,o.e+p+2,0),o.times(o).eq(s))){r=o;break}l+=4,c+=4,i=1}return M(r,r.e+p+1,m,e)},h.toExponential=function(e,t){return null!=e&&(Zn(e,0,Gn),e++),x(this,e,t,1)},h.toFixed=function(e,t){return null!=e&&(Zn(e,0,Gn),e=e+this.e+1),x(this,e,t)},h.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=A;else if("object"!=typeof n)throw Error($n+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var o,s=r.split("."),a=+n.groupSize,c=+n.secondaryGroupSize,u=n.groupSeparator||"",l=s[0],d=s[1],h=i.s<0,f=h?l.slice(1):l,p=f.length;if(c&&(o=a,a=c,c=o,p-=o),a>0&&p>0){for(o=p%a||a,l=f.substr(0,o);o<p;o+=a)l+=u+f.substr(o,a);c>0&&(l+=u+f.slice(o)),h&&(l="-"+l)}r=d?l+(n.decimalSeparator||"")+((c=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):l}return(n.prefix||"")+r+(n.suffix||"")},h.toFraction=function(e){var t,r,i,o,s,a,c,u,l,d,h,p,g=this,y=g.c;if(null!=e&&(!(c=new k(e)).isInteger()&&(c.c||1!==c.s)||c.lt(f)))throw Error($n+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+T(c));if(!y)return new k(g);for(t=new k(f),l=r=new k(f),i=u=new k(f),p=Jn(y),s=t.e=p.length-g.e-1,t.c[0]=Wn[(a=s%14)<0?14+a:a],e=!e||c.comparedTo(t)>0?s>0?t:l:c,a=v,v=1/0,c=new k(p),u.c[0]=0;d=n(c,t,0,1),1!=(o=r.plus(d.times(i))).comparedTo(e);)r=i,i=o,l=u.plus(d.times(o=l)),u=o,t=c.minus(d.times(o=t)),c=o;return o=n(e.minus(r),i,0,1),u=u.plus(o.times(l)),r=r.plus(o.times(i)),u.s=l.s=g.s,h=n(l,i,s*=2,m).minus(g).abs().comparedTo(n(u,r,s,m).minus(g).abs())<1?[l,i]:[u,r],v=a,h},h.toNumber=function(){return+T(this)},h.toPrecision=function(e,t){return null!=e&&Zn(e,1,Gn),x(this,e,t,2)},h.toString=function(e){var t,n=this,i=n.s,o=n.e;return null===o?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=o<=g||o>=y?Qn(Jn(n.c),o):er(Jn(n.c),o,"0"):10===e&&I?t=er(Jn((n=M(new k(n),p+o+1,m)).c),n.e,"0"):(Zn(e,2,_.length,"Base"),t=r(er(Jn(n.c),o,"0"),10,e,i,!0)),i<0&&n.c[0]&&(t="-"+t)),t},h.valueOf=h.toJSON=function(){return T(this)},h._isBigNumber=!0,h[Symbol.toStringTag]="BigNumber",h[Symbol.for("nodejs.util.inspect.custom")]=h.valueOf,null!=t&&k.set(t),k}();const nr=new tr("1e+18"),rr=e=>{const t=Nn(e),{encode:n,decode:r}=Cn(t),i=t;return i.decode=(e,t)=>{const n=r(e,t).toString();return new tr(n).div(nr)},i.encode=(e,t,r)=>{const i=BigInt(e.times(nr).integerValue().toString());return n(i,t,r)},i},ir=e=>{const t=On(e),{encode:n,decode:r}=Cn(t),i=t;return i.decode=(e,t)=>!!r(e,t),i.encode=(e,t,r)=>{const i=Number(e);return n(i,t,r)},i},or=t=>{const n=Rn(32,t),{encode:r,decode:i}=Cn(n),o=n;return o.decode=(t,n)=>{const r=i(t,n);return new e(r)},o.encode=(e,t,n)=>{const i=e.toBuffer();return r(i,t,n)},o};function sr(e){return new ar(8,!1,e)}class ar extends Gt{constructor(e,t,n){super(e,n),this.blob=Rn(e),this.signed=t}encode(e,t,n=0){return this.signed&&(e=e.toTwos(8*this.span)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),t,n)}decode(e,t=0){const n=new u(this.blob.decode(e,t),10,"le");return this.signed?n.fromTwos(8*this.span).clone():n}}function cr(e,t){return new ur(e,t)}class ur extends Gt{constructor(e,t){super(-1,t),this.layout=Tn([Mn("length"),Bn(e,Ln(Mn(),-4),"src")],t)}encode(e,t,n=0){const r={src:e};return this.layout.encode(r,t,n)}decode(e,t=0){return this.layout.decode(e,t).src}getSpan(e,t=0){return this.layout.getSpan(e,t)}}class lr{constructor(e){}async encode(e,t){switch(e){case"obligation":{const e=Buffer.alloc(916),n=dr.encode(t,e);return e.slice(0,n)}case"lendingMarket":{const e=Buffer.alloc(258),n=hr.encode(t,e);return e.slice(0,n)}case"reserve":{const e=Buffer.alloc(571),n=fr.encode(t,e);return e.slice(0,n)}default:throw new Error(`Invalid account name: ${e}`)}}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){switch(e){case"obligation":return function(e){return dr.decode(e)}(t);case"lendingMarket":return function(e){return hr.decode(e)}(t);case"reserve":return function(e){return fr.decode(e)}(t);default:throw new Error(`Invalid account name: ${e}`)}}memcmp(e,t){switch(e){case"obligation":return{dataSize:916};case"lendingMarket":return{dataSize:258};case"reserve":return{dataSize:571};default:throw new Error(`Invalid account name: ${e}`)}}size(e){switch(e.name){case"obligation":return 916;case"lendingMarket":return 258;case"reserve":return 571;default:throw new Error(`Invalid account name: ${e.name}`)}}}const dr=Tn([On("version"),Tn([sr("slot"),ir("stale")],"lastUpdate"),or("lendingMarket"),or("owner"),cr(Tn([or("depositReserve"),sr("depositedAmount"),rr("marketValue")]),"deposits"),cr(Tn([or("borrowReserve"),rr("cumulativeBorrowRateWads"),rr("borrowedAmountWads"),rr("marketValue")]),"borrows"),rr("depositedValue"),rr("borrowedValue"),rr("allowedBorrowValue"),rr("unhealthyBorrowValue")]),hr=Tn([On("version"),On("bumpSeed"),or("owner"),Bn(On(),32,"quoteCurrency"),or("tokenProgramId"),or("oracleProgramId"),Rn(128,"padding")]),fr=Tn([On("version"),Tn([sr("slot"),ir("stale")],"lastUpdate"),or("lendingMarket"),Tn([or("mintPubkey"),On("mintDecimals"),or("supplyPubkey"),or("feeReceiver"),or("oraclePubkey"),sr("availableAmount"),rr("borrowedAmountWads"),rr("cumulativeBorrowRateWads"),rr("marketPrice")],"liquidity"),Tn([or("mintPubkey"),sr("mintTotalSupply"),or("supplyPubkey")],"collateral"),Tn([On("optimalUtilizationRate"),On("loanToValueRatio"),On("liquidationBonus"),On("liquidationThreshold"),On("minBorrowRate"),On("optimalBorrowRate"),On("maxBorrowRate"),Tn([sr("borrowFeeWad"),sr("flashLoanFeeWad"),On("hostFeePercentage")],"fees")],"config"),Rn(248,"padding")]);class pr{constructor(e){}decode(e){throw new Error("SplTokenLending program does not have events")}}class mr{constructor(e){}encode(e,t){switch(e){case"initLendingMarket":return function({owner:e,quoteCurrency:t}){return yr({initLendingMarket:{owner:e,quoteCurrency:t}},65)}(t);case"setLendingMarketOwner":return function({newOwner:e}){return yr({setLendingMarketOwner:{newOwner:e}},33)}(t);case"initReserve":return function({liquidityAmount:e,config:t}){return yr({initReserve:{liquidityAmount:e,config:t}},33)}(t);case"refreshReserve":return function({}){return yr({refreshReserve:{}},1)}(t);case"depositReserveLiquidity":return function({liquidityAmount:e}){return yr({depositReserveLiquidity:{liquidityAmount:e}},9)}(t);case"redeemReserveCollateral":return function({collateralAmount:e}){return yr({redeemReserveCollateral:{collateralAmount:e}},9)}(t);case"initObligation":return function({}){return yr({initObligation:{}},1)}(t);case"refreshObligation":return function({}){return yr({refreshObligation:{}},1)}(t);case"depositObligationCollateral":return function({collateralAmount:e}){return yr({depositObligationCollateral:{collateralAmount:e}},9)}(t);case"withdrawObligationCollateral":return function({collateralAmount:e}){return yr({withdrawObligationCollateral:{collateralAmount:e}},9)}(t);case"borrowObligationLiquidity":return function({liquidityAmount:e}){return yr({borrowObligationLiquidity:{liquidityAmount:e}},9)}(t);case"repayObligationLiquidity":return function({liquidityAmount:e}){return yr({repayObligationLiquidity:{liquidityAmount:e}},9)}(t);case"liquidateObligation":return function({liquidityAmount:e}){return yr({liquidateObligation:{liquidityAmount:e}},9)}(t);case"flashLoan":return function({amount:e}){return yr({flashLoan:{amount:e}},9)}(t);default:throw new Error(`Invalid instruction: ${e}`)}}encodeState(e,t){throw new Error("SplTokenLending does not have state")}}const gr=Pn(On("instruction"));function yr(e,t){const n=Buffer.alloc(t);return gr.encode(e,n),n}gr.addVariant(0,Tn([or("owner"),Bn(On(),32,"quoteCurrency")]),"initLendingMarket"),gr.addVariant(1,Tn([or("newOwner")]),"setLendingMarketOwner"),gr.addVariant(2,Tn([sr("liquidityAmount"),Tn([On("optimalUtilizationRate"),On("loanToValueRatio"),On("liquidationBonus"),On("liquidationThreshold"),On("minBorrowRate"),On("optimalBorrowRate"),On("maxBorrowRate"),Tn([sr("borrowFeeWad"),sr("flashLoanFeeWad"),On("hostFeePercentage")],"fees")],"config")]),"initReserve"),gr.addVariant(3,Tn([]),"refreshReserve"),gr.addVariant(4,Tn([sr("liquidityAmount")]),"depositReserveLiquidity"),gr.addVariant(5,Tn([sr("collateralAmount")]),"redeemReserveCollateral"),gr.addVariant(6,Tn([]),"initObligation"),gr.addVariant(7,Tn([]),"refreshObligation"),gr.addVariant(8,Tn([sr("collateralAmount")]),"depositObligationCollateral"),gr.addVariant(9,Tn([sr("collateralAmount")]),"withdrawObligationCollateral"),gr.addVariant(10,Tn([sr("liquidityAmount")]),"borrowObligationLiquidity"),gr.addVariant(11,Tn([sr("liquidityAmount")]),"repayObligationLiquidity"),gr.addVariant(12,Tn([sr("liquidityAmount")]),"liquidateObligation"),gr.addVariant(13,Tn([sr("amount")]),"flashLoan");class wr{constructor(e){}encode(e,t){throw new Error("SplTokenLending does not have state")}decode(e){throw new Error("SplTokenLending does not have state")}}class vr{constructor(e){}encode(e,t){throw new Error("SplTokenLending does not have user-defined types")}decode(e,t){throw new Error("SplTokenLending does not have user-defined types")}}class br{constructor(e){this.accounts=new lr(e),this.events=new pr(e),this.instruction=new mr(e),this.state=new wr(e),this.types=new vr(e)}}const Er=new e("FJAwitEMXUEUibVHXXwpikL7Ct1xTujaY2XMtccUBSoK");function Sr(e){var t;return new jt(Ar,null!==(t=null==e?void 0:e.programId)&&void 0!==t?t:Er,null==e?void 0:e.provider,new br(Ar))}const Ar={version:"0.2.0",name:"spl_token_lending",instructions:[{name:"initLendingMarket",accounts:[{name:"lendingMarket",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"oracleProgram",isMut:!1,isSigner:!1}],args:[{name:"owner",type:"publicKey"},{name:"quoteCurrency",type:{array:["u8",32]}}]},{name:"setLendingMarketOwner",accounts:[{name:"lendingMarket",isMut:!0,isSigner:!1},{name:"lendingMarketOwner",isMut:!1,isSigner:!0}],args:[{name:"newOwner",type:"publicKey"}]},{name:"initReserve",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationCollateral",isMut:!0,isSigner:!1},{name:"reserve",isMut:!0,isSigner:!1},{name:"reserveLiquidityMint",isMut:!1,isSigner:!1},{name:"reserveLiquiditySupply",isMut:!0,isSigner:!1},{name:"reserveLiquidityFeeReceiver",isMut:!0,isSigner:!1},{name:"reserveCollateralMint",isMut:!0,isSigner:!1},{name:"reserveCollateralSupply",isMut:!0,isSigner:!1},{name:"pythProduct",isMut:!1,isSigner:!1},{name:"pythPrice",isMut:!1,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"lendingMarketOwner",isMut:!1,isSigner:!0},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidityAmount",type:"u64"},{name:"config",type:{defined:"ReserveConfig"}}]},{name:"refreshReserve",accounts:[{name:"reserve",isMut:!0,isSigner:!1},{name:"reserveLiquidityOracle",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[]},{name:"depositReserveLiquidity",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationCollateral",isMut:!0,isSigner:!1},{name:"reserve",isMut:!0,isSigner:!1},{name:"reserveLiquiditySupply",isMut:!0,isSigner:!1},{name:"reserveCollateralMint",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidityAmount",type:"u64"}]},{name:"redeemReserveCollateral",accounts:[{name:"sourceCollateral",isMut:!0,isSigner:!1},{name:"destinationLiquidity",isMut:!0,isSigner:!1},{name:"reserve",isMut:!0,isSigner:!1},{name:"reserveCollateralMint",isMut:!0,isSigner:!1},{name:"reserveLiquiditySupply",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"collateralAmount",type:"u64"}]},{name:"initObligation",accounts:[{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"obligationOwner",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"refreshObligation",accounts:[{name:"obligation",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[]},{name:"depositObligationCollateral",accounts:[{name:"sourceCollateral",isMut:!0,isSigner:!1},{name:"destinationCollateral",isMut:!0,isSigner:!1},{name:"depositReserve",isMut:!1,isSigner:!1},{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"obligationOwner",isMut:!1,isSigner:!0},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"collateralAmount",type:"u64"}]},{name:"withdrawObligationCollateral",accounts:[{name:"sourceCollateral",isMut:!0,isSigner:!1},{name:"destinationCollateral",isMut:!0,isSigner:!1},{name:"withdrawReserve",isMut:!1,isSigner:!1},{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"obligationOwner",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"collateralAmount",type:"u64"}]},{name:"borrowObligationLiquidity",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationLiquidity",isMut:!0,isSigner:!1},{name:"borrowReserve",isMut:!0,isSigner:!1},{name:"borrowReserveLiquidityFeeReceiver",isMut:!0,isSigner:!1},{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"obligationOwner",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidityAmount",type:"u64"}]},{name:"repayObligationLiquidity",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationLiquidity",isMut:!0,isSigner:!1},{name:"repayReserve",isMut:!0,isSigner:!1},{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidityAmount",type:"u64"}]},{name:"liquidateObligation",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationCollateral",isMut:!0,isSigner:!1},{name:"repayReserve",isMut:!0,isSigner:!1},{name:"repayReserveLiquiditySupply",isMut:!0,isSigner:!1},{name:"withdrawReserve",isMut:!1,isSigner:!1},{name:"withdrawReserveCollateralSupply",isMut:!0,isSigner:!1},{name:"obligation",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"liquidityAmount",type:"u64"}]},{name:"flashLoan",accounts:[{name:"sourceLiquidity",isMut:!0,isSigner:!1},{name:"destinationLiquidity",isMut:!0,isSigner:!1},{name:"reserve",isMut:!0,isSigner:!1},{name:"reserveLiquidityFeeReceiver",isMut:!0,isSigner:!1},{name:"hostFeeReceiver",isMut:!0,isSigner:!1},{name:"lendingMarket",isMut:!1,isSigner:!1},{name:"lendingMarketAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"flashLoanReceiverProgram",isMut:!1,isSigner:!1}],args:[{name:"amount",type:"u64"}]}],accounts:[{name:"obligation",type:{kind:"struct",fields:[{name:"version",type:"u8"},{name:"lastUpdate",type:{defined:"LastUpdate"}},{name:"lendingMarket",type:"publicKey"},{name:"owner",type:"publicKey"},{name:"deposits",type:{vec:{defined:"ObligationCollateral"}}},{name:"borrows",type:{vec:{defined:"ObligationLiquidity"}}},{name:"depositedValue",type:{defined:"Decimal"}},{name:"borrowedValue",type:{defined:"Decimal"}},{name:"allowedBorrowValue",type:{defined:"Decimal"}},{name:"unhealthyBorrowValue",type:{defined:"Decimal"}}]}},{name:"lendingMarket",type:{kind:"struct",fields:[{name:"version",type:"u8"},{name:"bumpSeed",type:"u8"},{name:"owner",type:"publicKey"},{name:"quoteCurrency",type:{array:["u8",32]}},{name:"tokenProgramId",type:"publicKey"},{name:"oracleProgramId",type:"publicKey"}]}},{name:"reserve",type:{kind:"struct",fields:[{name:"version",type:"u8"},{name:"lastUpdate",type:{defined:"LastUpdate"}},{name:"lendingMarket",type:"publicKey"},{name:"liquidity",type:{defined:"ReserveLiquidity"}},{name:"collateral",type:{defined:"ReserveCollateral"}},{name:"config",type:{defined:"ReserveConfig"}}]}}],types:[{name:"LastUpdate",type:{kind:"struct",fields:[{name:"slot",type:"u64"},{name:"stale",type:"bool"}]}},{name:"ObligationCollateral",type:{kind:"struct",fields:[{name:"depositReserve",type:"publicKey"},{name:"depositedAmount",type:"u64"},{name:"marketValue",type:{defined:"Decimal"}}]}},{name:"ObligationLiquidity",type:{kind:"struct",fields:[{name:"borrowReserve",type:"publicKey"},{name:"cumulativeBorrowRateWads",type:{defined:"Decimal"}},{name:"borrowedAmountWads",type:{defined:"Decimal"}},{name:"marketValue",type:{defined:"Decimal"}}]}},{name:"ReserveLiquidity",type:{kind:"struct",fields:[{name:"mintPubkey",type:"publicKey"},{name:"mintDecimals",type:"u8"},{name:"supplyPubkey",type:"publicKey"},{name:"feeReceiver",type:"publicKey"},{name:"oraclePubkey",type:"publicKey"},{name:"availableAmount",type:"u64"},{name:"borrowedAmountWads",type:{defined:"Decimal"}},{name:"cumulativeBorrowRateWads",type:{defined:"Decimal"}},{name:"marketPrice",type:{defined:"Decimal"}}]}},{name:"ReserveCollateral",type:{kind:"struct",fields:[{name:"mintPubkey",type:"publicKey"},{name:"mintTotalSupply",type:"u64"},{name:"supplyPubkey",type:"publicKey"}]}},{name:"ReserveFees",type:{kind:"struct",fields:[{name:"borrowFeeWad",type:"u64"},{name:"flashLoanFeeWad",type:"u64"},{name:"hostFeePercentage",type:"u8"}]}},{name:"ReserveConfig",type:{kind:"struct",fields:[{name:"optimalUtilizationRate",type:"u8"},{name:"loanToValueRatio",type:"u8"},{name:"liquidationBonus",type:"u8"},{name:"liquidationThreshold",type:"u8"},{name:"minBorrowRate",type:"u8"},{name:"optimalBorrowRate",type:"u8"},{name:"maxBorrowRate",type:"u8"},{name:"fees",type:{defined:"ReserveFees"}}]}}],errors:[{code:0,name:"InstructionUnpackError",msg:"Failed to unpack instruction data"},{code:1,name:"AlreadyInitialized",msg:"Account is already initialized"},{code:2,name:"NotRentExempt",msg:"Lamport balance below rent-exempt threshold"},{code:3,name:"InvalidMarketAuthority",msg:"Market authority is invalid"},{code:4,name:"InvalidMarketOwner",msg:"Market owner is invalid"},{code:5,name:"InvalidAccountOwner",msg:"Input account owner is not the program address"},{code:6,name:"InvalidTokenOwner",msg:"Input token account is not owned by the correct token program id"},{code:7,name:"InvalidTokenAccount",msg:"Input token account is not valid"},{code:8,name:"InvalidTokenMint",msg:"Input token mint account is not valid"},{code:9,name:"InvalidTokenProgram",msg:"Input token program account is not valid"},{code:10,name:"InvalidAmount",msg:"Input amount is invalid"},{code:11,name:"InvalidConfig",msg:"Input config value is invalid"},{code:12,name:"InvalidSigner",msg:"Input account must be a signer"},{code:13,name:"InvalidAccountInput",msg:"Invalid account input"},{code:14,name:"MathOverflow",msg:"Math operation overflow"},{code:15,name:"TokenInitializeMintFailed",msg:"Token initialize mint failed"},{code:16,name:"TokenInitializeAccountFailed",msg:"Token initialize account failed"},{code:17,name:"TokenTransferFailed",msg:"Token transfer failed"},{code:18,name:"TokenMintToFailed",msg:"Token mint to failed"},{code:19,name:"TokenBurnFailed",msg:"Token burn failed"},{code:20,name:"InsufficientLiquidity",msg:"Insufficient liquidity available"},{code:21,name:"ReserveCollateralDisabled",msg:"Input reserve has collateral disabled"},{code:22,name:"ReserveStale",msg:"Reserve state needs to be refreshed"},{code:23,name:"WithdrawTooSmall",msg:"Withdraw amount too small"},{code:24,name:"WithdrawTooLarge",msg:"Withdraw amount too large"},{code:25,name:"BorrowTooSmall",msg:"Borrow amount too small to receive liquidity after fees"},{code:26,name:"BorrowTooLarge",msg:"Borrow amount too large for deposited collateral"},{code:27,name:"RepayTooSmall",msg:"Repay amount too small to transfer liquidity"},{code:28,name:"LiquidationTooSmall",msg:"Liquidation amount too small to receive collateral"},{code:29,name:"ObligationHealthy",msg:"Cannot liquidate healthy obligations"},{code:30,name:"ObligationStale",msg:"Obligation state needs to be refreshed"},{code:31,name:"ObligationReserveLimit",msg:"Obligation reserve limit exceeded"},{code:32,name:"InvalidObligationOwner",msg:"Obligation owner is invalid"},{code:33,name:"ObligationDepositsEmpty",msg:"Obligation deposits are empty"},{code:34,name:"ObligationBorrowsEmpty",msg:"Obligation borrows are empty"},{code:35,name:"ObligationDepositsZero",msg:"Obligation deposits have zero value"},{code:36,name:"ObligationBorrowsZero",msg:"Obligation borrows have zero value"},{code:37,name:"InvalidObligationCollateral",msg:"Invalid obligation collateral"},{code:38,name:"InvalidObligationLiquidity",msg:"Invalid obligation liquidity"},{code:39,name:"ObligationCollateralEmpty",msg:"Obligation collateral is empty"},{code:40,name:"ObligationLiquidityEmpty",msg:"Obligation liquidity is empty"},{code:41,name:"NegativeInterestRate",msg:"Interest rate is negative"},{code:42,name:"InvalidOracleConfig",msg:"Input oracle config is invalid"},{code:43,name:"InvalidFlashLoanReceiverProgram",msg:"Input flash loan receiver program account is not valid"},{code:44,name:"NotEnoughLiquidityAfterFlashLoan",msg:"Not enough liquidity after flash loan"}]};export{Er as SPL_TOKEN_LENDING_PROGRAM_ID,Sr as splTokenLendingProgram};
//# sourceMappingURL=index.js.map
