import{PublicKey as e,SYSVAR_RENT_PUBKEY as t,SystemProgram as r,SYSVAR_CLOCK_PUBKEY as n,SendTransactionError as o,TransactionInstruction as i,Transaction as s}from"@solana/web3.js";import a,{Buffer as c}from"buffer";import u from"bn.js";import l from"bs58";import d from"camelcase";import*as h from"@coral-xyz/borsh";import{sha256 as p}from"@noble/hashes/sha256";import{inflate as f}from"pako";import m from"eventemitter3";const g=e=>"version"in e;function y(e){return l.encode(e)}function w(e){return e.toString("base64")}function v(e){return c.from(e,"base64")}function S(e,...t){if(e.args.length!=t.length)throw new Error("Invalid argument length");const r={};let n=0;return e.args.forEach((e=>{r[e.name]=t[n],n+=1})),r}function b(e,t={}){e.forEach((e=>{if("accounts"in e)b(e.accounts,t[e.name]);else if(void 0===t[e.name])throw new Error(`Invalid arguments: ${e.name} not provided.`)}))}function E(t){return t instanceof e?t:new e(t)}class k extends TypeError{constructor(e,t){let r;const{message:n,...o}=e,{path:i}=e;super(0===i.length?n:"At path: "+i.join(".")+" -- "+n),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>{var n;return null!=(n=r)?n:r=[e,...t()]}}}function A(e){return"object"==typeof e&&null!=e}function _(e){return"string"==typeof e?JSON.stringify(e):""+e}function I(e,t,r,n){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:o,branch:i}=t,{type:s}=r,{refinement:a,message:c="Expected a value of type `"+s+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+_(n)+"`"}=e;return{value:n,type:s,refinement:a,key:o[o.length-1],path:o,branch:i,...e,message:c}}function*x(e,t,r,n){(function(e){return A(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const o of e){const e=I(o,t,r,n);e&&(yield e)}}function*M(e,t,r){void 0===r&&(r={});const{path:n=[],branch:o=[e],coerce:i=!1,mask:s=!1}=r,a={path:n,branch:o};if(i&&(e=t.coercer(e,a),s&&"type"!==t.type&&A(t.schema)&&A(e)&&!Array.isArray(e)))for(const r in e)void 0===t.schema[r]&&delete e[r];let c=!0;for(const r of t.validator(e,a))c=!1,yield[r,void 0];for(let[r,u,l]of t.entries(e,a)){const t=M(u,l,{path:void 0===r?n:[...n,r],branch:void 0===r?o:[...o,u],coerce:i,mask:s});for(const n of t)n[0]?(c=!1,yield[n[0],void 0]):i&&(u=n[1],void 0===r?e=u:e instanceof Map?e.set(r,u):e instanceof Set?e.add(u):A(e)&&(e[r]=u))}if(c)for(const r of t.refiner(e,a))c=!1,yield[r,void 0];c&&(yield[void 0,e])}class P{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:r,validator:n,refiner:o,coercer:i=(e=>e),entries:s=function*(){}}=e;this.type=t,this.schema=r,this.entries=s,this.coercer=i,this.validator=n?(e,t)=>x(n(e,t),t,this,e):()=>[],this.refiner=o?(e,t)=>x(o(e,t),t,this,e):()=>[]}assert(e){return function(e,t){const r=B(e,t);if(r[0])throw r[0]}(e,this)}create(e){return L(e,this)}is(e){return T(e,this)}mask(e){return function(e,t){const r=B(e,t,{coerce:!0,mask:!0});if(r[0])throw r[0];return r[1]}(e,this)}validate(e,t){return void 0===t&&(t={}),B(e,this,t)}}function L(e,t){const r=B(e,t,{coerce:!0});if(r[0])throw r[0];return r[1]}function T(e,t){return!B(e,t)[0]}function B(e,t,r){void 0===r&&(r={});const n=M(e,t,r),o=function(e){const{done:t,value:r}=e.next();return t?void 0:r}(n);if(o[0]){const e=new k(o[0],(function*(){for(const e of n)e[0]&&(yield e[0])}));return[e,void 0]}return[void 0,o[1]]}function O(e,t){return new P({type:e,schema:null,validator:t})}function V(e){return new P({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[r,n]of t.entries())yield[r,n,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||"Expected an array value, but received: "+_(e)})}function D(e){const t=_(e),r=typeof e;return new P({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:r=>r===e||"Expected the literal `"+t+"`, but received: "+_(r)})}function U(e){return new P({...e,validator:(t,r)=>null===t||e.validator(t,r),refiner:(t,r)=>null===t||e.refiner(t,r)})}function F(){return O("number",(e=>"number"==typeof e&&!isNaN(e)||"Expected a number, but received: "+_(e)))}function N(e){return new P({...e,validator:(t,r)=>void 0===t||e.validator(t,r),refiner:(t,r)=>void 0===t||e.refiner(t,r)})}function R(){return O("string",(e=>"string"==typeof e||"Expected a string, but received: "+_(e)))}function C(e){const t=Object.keys(e);return new P({type:"type",schema:e,*entries(r){if(A(r))for(const n of t)yield[n,r[n],e[n]]},validator:e=>A(e)||"Expected an object, but received: "+_(e)})}function j(e){const t=e.map((e=>e.type)).join(" | ");return new P({type:"union",schema:null,coercer(t,r){const n=e.find((e=>{const[r]=e.validate(t,{coerce:!0});return!r}))||W();return n.coercer(t,r)},validator(r,n){const o=[];for(const t of e){const[...e]=M(r,t,n),[i]=e;if(!i[0])return[];for(const[t]of e)t&&o.push(t)}return["Expected the value to satisfy a union of `"+t+"`, but received: "+_(r),...o]}})}function W(){return O("unknown",(()=>!0))}async function $(e,t,r){if(t.length<=99)return await z(e,t,r);{const n=function(e,t){return Array.apply(0,new Array(Math.ceil(e.length/t))).map(((r,n)=>e.slice(n*t,(n+1)*t)))}(t,99);return(await Promise.all(n.map((t=>z(e,t,r))))).flat()}}async function z(e,t,r){const n=null!=r?r:e.commitment,{value:o,context:i}=await e.getMultipleAccountsInfoAndContext(t,n);return o.map(((e,r)=>null===e?null:{publicKey:t[r],account:e,context:i}))}function q(e){return function(e,t,r){return new P({...e,coercer:(n,o)=>T(n,t)?e.coercer(r(n,o),o):e.coercer(n,o)})}(G(e),K,(t=>"error"in t?t:{...t,result:L(t.result,e)}))}const K=G(W());function G(e){return j([C({jsonrpc:D("2.0"),id:R(),result:e}),C({jsonrpc:D("2.0"),id:R(),error:C({code:W(),message:R(),data:N(O("any",(()=>!0)))})})])}const H=(J=C({err:U(j([C({}),R()])),logs:U(V(R())),accounts:N(U(V(U(C({executable:O("boolean",(e=>"boolean"==typeof e)),owner:R(),lamports:F(),data:V(R()),rentEpoch:N(F())}))))),unitsConsumed:N(F())}),q(C({context:C({slot:F()}),value:J})));var J;class Z{constructor(e,t,r){this.connection=e,this.wallet=t,this.opts=r,this.publicKey=null==t?void 0:t.publicKey}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,r){var n,i,s,a;if(void 0===r&&(r=this.opts),g(e))t&&e.sign(t);else if(e.feePayer=null!==(n=e.feePayer)&&void 0!==n?n:this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(r.preflightCommitment)).blockhash,t)for(const r of t)e.partialSign(r);const c=(e=await this.wallet.signTransaction(e)).serialize();try{return await Y(this.connection,c,r)}catch(t){if(t instanceof Q){const r=y(g(e)?(null===(i=e.signatures)||void 0===i?void 0:i[0])||new Uint8Array:null!==(s=e.signature)&&void 0!==s?s:new Uint8Array),n=await this.connection.getTransaction(r,{commitment:"confirmed"});if(n){const e=null===(a=n.meta)||void 0===a?void 0:a.logMessages;throw e?new o(t.message,e):t}throw t}throw t}}async sendAll(e,t){var r,n,i;void 0===t&&(t=this.opts);const s=(await this.connection.getLatestBlockhash(t.preflightCommitment)).blockhash;let a=e.map((e=>{var t,r;if(g(e.tx)){let t=e.tx;return e.signers&&t.sign(e.signers),t}{let n=e.tx,o=null!==(t=e.signers)&&void 0!==t?t:[];return n.feePayer=null!==(r=n.feePayer)&&void 0!==r?r:this.wallet.publicKey,n.recentBlockhash=s,o.forEach((e=>{n.partialSign(e)})),n}}));const c=await this.wallet.signAllTransactions(a),u=[];for(let e=0;e<a.length;e+=1){const s=c[e],a=s.serialize();try{u.push(await Y(this.connection,a,t))}catch(e){if(e instanceof Q){const t=y(g(s)?(null===(r=s.signatures)||void 0===r?void 0:r[0])||new Uint8Array:null!==(n=s.signature)&&void 0!==n?n:new Uint8Array),a=await this.connection.getTransaction(t,{commitment:"confirmed"});if(a){const t=null===(i=a.meta)||void 0===i?void 0:i.logMessages;throw t?new o(e.message,t):e}throw e}throw e}}return u}async simulate(e,t,r,n){let i,s=(await this.connection.getLatestBlockhash(null!=r?r:this.connection.commitment)).blockhash;if(g(e)?(t&&t.length>0&&(e.sign(t),e=await this.wallet.signTransaction(e)),i=await this.connection.simulateTransaction(e,{commitment:r})):(e.feePayer=e.feePayer||this.wallet.publicKey,e.recentBlockhash=s,t&&t.length>0&&(e=await this.wallet.signTransaction(e)),i=await async function(e,t,r,n,i){var s;r&&r.length>0&&t.sign(...r);const a=t._compile(),c=a.serialize(),u=t._serialize(c).toString("base64"),l={encoding:"base64",commitment:null!=n?n:e.commitment};if(i){const e=(Array.isArray(i)?i:a.nonProgramIds()).map((e=>e.toBase58()));l.accounts={encoding:"base64",addresses:e}}r&&r.length>0&&(l.sigVerify=!0);const d=[u,l],h=L(await e._rpcRequest("simulateTransaction",d),H);if("error"in h){let e;if("data"in h.error&&(e=null===(s=h.error.data)||void 0===s?void 0:s.logs,e&&Array.isArray(e))){const t="\n    ",r=t+e.join(t);console.error(h.error.message,r)}throw new o("failed to simulate transaction: "+h.error.message,e)}return h.result}(this.connection,e,t,r,n)),i.value.err)throw new X(i.value);return i.value}}class X extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function Y(e,t,r){const n=r&&{skipPreflight:r.skipPreflight,preflightCommitment:r.preflightCommitment||r.commitment},o=await e.sendRawTransaction(t,n),i=(await e.confirmTransaction(o,r&&r.commitment)).value;if(i.err)throw new Q(`Raw transaction ${o} failed (${JSON.stringify(i)})`);return o}class Q extends Error{constructor(e){super(e)}}function ee(){return Z.local()}const te=new Map;function re(e){return void 0!==te.get(e)}class ne extends Error{constructor(e){super(e),this.name="IdlError"}}class oe{constructor(e){this.stack=e}static parse(t){var r;const n=/^Program (\w*) invoke/,o=/^Program \w* success/,i=[];for(let s=0;s<t.length;s++){if(o.exec(t[s])){i.pop();continue}const a=null===(r=n.exec(t[s]))||void 0===r?void 0:r[1];a&&i.push(new e(a))}return new oe(i)}}class ie extends Error{constructor(e,t,r,n,o,i){super(r.join("\n").replace("Program log: ","")),this.errorLogs=r,this.logs=n,this.error={errorCode:e,errorMessage:t,comparedValues:i,origin:o},this._programErrorStack=oe.parse(n)}static parse(t){if(!t)return null;const r=t.findIndex((e=>e.startsWith("Program log: AnchorError")));if(-1===r)return null;const n=t[r],o=[n];let i;if(r+1<t.length)if("Program log: Left:"===t[r+1]){const n=/^Program log: (.*)$/,s=n.exec(t[r+2])[1],a=n.exec(t[r+4])[1];i=[new e(s),new e(a)],o.push(...t.slice(r+1,r+5))}else if(t[r+1].startsWith("Program log: Left:")){const e=/^Program log: (Left|Right): (.*)$/,n=e.exec(t[r+1])[2],s=e.exec(t[r+2])[2];o.push(...t.slice(r+1,r+3)),i=[n,s]}const s=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n);if(s){const[e,r,n]=s.slice(1,4),a={code:e,number:parseInt(r)};return new ie(a,n,o,t,void 0,i)}if(a){const[e,r,n,s,c]=a.slice(1,6),u={code:n,number:parseInt(s)},l={file:e,line:parseInt(r)};return new ie(u,c,o,t,l,i)}if(c){const[e,r,n,s]=c.slice(1,5),a=e,u={code:r,number:parseInt(n)};return new ie(u,s,o,t,a,i)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class se extends Error{constructor(e,t,r){super(),this.code=e,this.msg=t,this.logs=r,r&&(this._programErrorStack=oe.parse(r))}static parse(e,t){const r=e.toString();let n,o;if(r.includes("custom program error:")){let e=r.split("custom program error: ");if(2!==e.length)return null;n=e[1]}else{const e=r.match(/"Custom":([0-9]+)}/g);if(!e||e.length>1)return null;n=e[0].match(/([0-9]+)/g)[0]}try{o=parseInt(n)}catch(e){return null}let i=t.get(o);return void 0!==i?new se(o,i,e.logs):(i=ce.get(o),void 0!==i?new se(o,i,e.logs):null)}get program(){var e;return null===(e=this._programErrorStack)||void 0===e?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return null===(e=this._programErrorStack)||void 0===e?void 0:e.stack}toString(){return this.msg}}function ae(e,t){re("debug-logs")&&console.log("Translating error:",e);const r=ie.parse(e.logs);if(r)return r;const n=se.parse(e,t);if(n)return n;if(e.logs){const t={get:function(t,r){return"programErrorStack"===r?t.programErrorStack.stack:"program"===r?t.programErrorStack.stack[e.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return e.programErrorStack=oe.parse(e.logs),new Proxy(e,t)}return e}const ce=new Map([[100,"8 byte instruction identifier not provided"],[101,"Fallback functions are not supported"],[102,"The program could not deserialize the given instruction"],[103,"The program could not serialize the given instruction"],[1e3,"The program was compiled without idl instructions"],[1001,"The transaction was given an invalid program for the IDL instruction"],[2e3,"A mut constraint was violated"],[2001,"A has one constraint was violated"],[2002,"A signer constraint was violated"],[2003,"A raw constraint was violated"],[2004,"An owner constraint was violated"],[2005,"A rent exemption constraint was violated"],[2006,"A seeds constraint was violated"],[2007,"An executable constraint was violated"],[2008,"Deprecated Error, feel free to replace with something else"],[2009,"An associated constraint was violated"],[2010,"An associated init constraint was violated"],[2011,"A close constraint was violated"],[2012,"An address constraint was violated"],[2013,"Expected zero account discriminant"],[2014,"A token mint constraint was violated"],[2015,"A token owner constraint was violated"],[2016,"A mint mint authority constraint was violated"],[2017,"A mint freeze authority constraint was violated"],[2018,"A mint decimals constraint was violated"],[2019,"A space constraint was violated"],[2020,"A required account for the constraint is None"],[2500,"A require expression was violated"],[2501,"A require_eq expression was violated"],[2502,"A require_keys_eq expression was violated"],[2503,"A require_neq expression was violated"],[2504,"A require_keys_neq expression was violated"],[2505,"A require_gt expression was violated"],[2506,"A require_gte expression was violated"],[3e3,"The account discriminator was already set on this account"],[3001,"No 8 byte discriminator was found on the account"],[3002,"8 byte discriminator did not match what was expected"],[3003,"Failed to deserialize the account"],[3004,"Failed to serialize the account"],[3005,"Not enough account keys given to the instruction"],[3006,"The given account is not mutable"],[3007,"The given account is owned by a different program than expected"],[3008,"Program ID was not as expected"],[3009,"Program account is not executable"],[3010,"The given account did not sign"],[3011,"The given account is not owned by the system program"],[3012,"The program expected this account to be already initialized"],[3013,"The given account is not a program data account"],[3014,"The given account is not the associated token account"],[3015,"The given public key does not match the required sysvar"],[3016,"The account reallocation exceeds the MAX_PERMITTED_DATA_INCREASE limit"],[3017,"The account was duplicated for more than one reallocation"],[4100,"The declared program id does not match the actual program id"],[5e3,"The API being used is deprecated and should no longer be used"]]);var ue=function(){return ue=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ue.apply(this,arguments)},le=function(){return le=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},le.apply(this,arguments)};function de(e){return e.toLowerCase()}var he=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],pe=/[^A-Z0-9]+/gi;function fe(e,t,r){return t instanceof RegExp?e.replace(t,r):t.reduce((function(e,t){return e.replace(t,r)}),e)}function me(e,t){return void 0===t&&(t={}),function(e,t){void 0===t&&(t={});for(var r=t.splitRegexp,n=void 0===r?he:r,o=t.stripRegexp,i=void 0===o?pe:o,s=t.transform,a=void 0===s?de:s,c=t.delimiter,u=void 0===c?" ":c,l=fe(fe(e,n,"$1\0$2"),i,"\0"),d=0,h=l.length;"\0"===l.charAt(d);)d++;for(;"\0"===l.charAt(h-1);)h--;return l.slice(d,h).split("\0").map(a).join(u)}(e,le({delimiter:"."},t))}class ge{static fieldLayout(e,t){const r=void 0!==e.name?d(e.name):void 0;switch(e.type){case"bool":return h.bool(r);case"u8":return h.u8(r);case"i8":return h.i8(r);case"u16":return h.u16(r);case"i16":return h.i16(r);case"u32":return h.u32(r);case"i32":return h.i32(r);case"f32":return h.f32(r);case"u64":return h.u64(r);case"i64":return h.i64(r);case"f64":return h.f64(r);case"u128":return h.u128(r);case"i128":return h.i128(r);case"u256":return h.u256(r);case"i256":return h.i256(r);case"bytes":return h.vecU8(r);case"string":return h.str(r);case"publicKey":return h.publicKey(r);default:if("vec"in e.type)return h.vec(ge.fieldLayout({name:void 0,type:e.type.vec},t),r);if("option"in e.type)return h.option(ge.fieldLayout({name:void 0,type:e.type.option},t),r);if("defined"in e.type){if(!t)throw new ne("User defined types not provided");const n=e.type.defined,o=t.filter((e=>e.name===n));if(1!==o.length)throw new ne(`Type not found: ${JSON.stringify(e)}`);return ge.typeDefLayout(o[0],t,r)}if("array"in e.type){let n=e.type.array[0],o=e.type.array[1],i=ge.fieldLayout({name:void 0,type:n},t);return h.array(i,o,r)}throw new Error(`Not yet implemented: ${e}`)}}static typeDefLayout(e,t=[],r){switch(e.type.kind){case"struct":{const n=e.type.fields.map((e=>ge.fieldLayout(e,t)));return h.struct(n,r)}case"enum":{let n=e.type.variants.map((e=>{const r=d(e.name);if(!e.fields)return h.struct([],r);const n=e.fields.map(((e,r)=>(null==e?void 0:e.name)?ge.fieldLayout(e,t):ge.fieldLayout({type:e,name:r.toString()},t)));return h.struct(n,r)}));return void 0!==r?h.rustEnum(n).replicate(r):h.rustEnum(n,r)}case"alias":return ge.fieldLayout({type:e.type.value,name:e.name},t)}}}const ye="global";class we{constructor(e){this.idl=e,this.ixLayout=we.parseIxLayout(e);const t=new Map;e.instructions.forEach((e=>{const r=Se(ye,e.name);t.set(l.encode(r),{layout:this.ixLayout.get(e.name),name:e.name})})),this.sighashLayouts=t}encode(e,t,r){return this._encode(e,t,null!=r?r:Se(ye,e))}_encode(e,t,r){const n=c.alloc(1e3),o=d(e),i=this.ixLayout.get(o);if(!i)throw new Error(`Unknown method: ${o}`);const s=i.encode(t,n),a=n.slice(0,s);return c.concat([r,a])}static parseIxLayout(e){const t=e.instructions.map((t=>{let r=t.args.map((t=>{var r,n;return ge.fieldLayout(t,Array.from([...null!==(r=e.accounts)&&void 0!==r?r:[],...null!==(n=e.types)&&void 0!==n?n:[]]))}));const n=d(t.name);return[n,h.struct(r,n)]}));return new Map(t)}decode(e,t="hex",r){"string"==typeof e&&(e="hex"===t?c.from(e,"hex"):l.decode(e));let n=l.encode(r?Se(ye,r):e.slice(0,8)),o=e.slice(8);const i=this.sighashLayouts.get(n);return i?{data:i.layout.decode(o),name:i.name}:null}format(e,t){return ve.format(e,t,this.idl)}}class ve{static format(e,t,r){const n=r.instructions.filter((t=>e.name===t.name))[0];if(void 0===n)return console.error("Invalid instruction given"),null;const o=n.args.map((t=>({name:t.name,type:ve.formatIdlType(t.type),data:ve.formatIdlData(t,e.data[t.name],r.types)}))),i=ve.flattenIdlAccounts(n.accounts);return{args:o,accounts:t.map(((e,t)=>t<i.length?{name:i[t].name,...e}:{name:void 0,...e}))}}static formatIdlType(e){if("string"==typeof e)return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,r){if("string"==typeof e.type)return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map((t=>this.formatIdlData({name:"",type:e.type.vec},t,r))).join(", ")+"]";if(e.type.hasOwnProperty("option"))return null===t?"null":this.formatIdlData({name:"",type:e.type.option},t,r);if(e.type.hasOwnProperty("defined")){if(void 0===r)throw new Error("User defined types not provided");const n=r.filter((t=>t.name===e.type.defined));if(1!==n.length)throw new Error(`Type not found: ${e.type.defined}`);return ve.formatIdlDataDefined(n[0],t,r)}return"unknown"}static formatIdlDataDefined(e,t,r){switch(e.type.kind){case"struct":{const n=e.type,o=Object.keys(t).map((e=>{const o=n.fields.find((t=>t.name===e));if(!o)throw new Error("Unable to find type");return e+": "+ve.formatIdlData(o,t[e],r)})).join(", ");return"{ "+o+" }"}case"enum":if(0===e.type.variants.length)return"{}";if(e.type.variants[0].name){const n=e.type.variants,o=Object.keys(t)[0],i=t[o],s=d(o),a=n.find((e=>d(e.name)===s));if(!a)throw new Error(`Unable to find variant \`${o}\``);const c=a.fields,u=Object.keys(i).map((e=>{const t=i[e],n=d(e),o=c.find((e=>d(e.name)===n));if(!o)throw new Error(`Unable to find field \`${e}\``);return e+": "+ve.formatIdlData(o,t,r)})).join(", "),l=d(o,{pascalCase:!0});return 0===u.length?l:`${l} { ${u} }`}return"Tuple formatting not yet implemented";case"alias":return ve.formatIdlType(e.type.value)}}static flattenIdlAccounts(e,t){return e.map((e=>{const r=function(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}(e.name);if(e.hasOwnProperty("accounts")){const n=t?`${t} > ${r}`:r;return ve.flattenIdlAccounts(e.accounts,n)}return{...e,name:t?`${t} > ${r}`:r}})).flat()}}function Se(e,t){var r;let n=`${e}:${void 0===r&&(r={}),me(t,ue({delimiter:"_"},r))}`;return c.from(p(n).slice(0,8))}function be(e,t){switch(t.type.kind){case"struct":return t.type.fields.map((t=>Ee(e,t.type))).reduce(((e,t)=>e+t),0);case"enum":{const r=t.type.variants.map((t=>t.fields?t.fields.map((t=>Ee(e,"object"==typeof t&&"name"in t?t.type:t))).reduce(((e,t)=>e+t),0):0));return Math.max(...r)+1}case"alias":return Ee(e,t.type.value)}}function Ee(e,t){var r,n;switch(t){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"u256":case"i256":case"publicKey":return 32;default:if("vec"in t)return 1;if("option"in t)return 1+Ee(e,t.option);if("coption"in t)return 4+Ee(e,t.coption);if("defined"in t){const o=null!==(n=null===(r=e.types)||void 0===r?void 0:r.filter((e=>e.name===t.defined)))&&void 0!==n?n:[];if(1!==o.length)throw new ne(`Type not found: ${JSON.stringify(t)}`);return be(e,o[0])}if("array"in t){let r=t.array[0],n=t.array[1];return Ee(e,r)*n}throw new Error(`Invalid type ${JSON.stringify(t)}`)}}function ke(e){return Buffer.from(p(e).slice(0,8))}class Ae{constructor(e){if(void 0===e.accounts)return void(this.accountLayouts=new Map);const t=e.accounts.map((t=>[t.name,ge.typeDefLayout(t,e.types)]));this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const r=c.alloc(1e3),n=this.accountLayouts.get(e);if(!n)throw new Error(`Unknown account: ${e}`);const o=n.encode(t,r);let i=r.slice(0,o),s=Ae.accountDiscriminator(e);return c.concat([s,i])}decode(e,t){if(Ae.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeAny(e){const t=e.slice(0,8),r=Array.from(this.accountLayouts.keys()).find((e=>Ae.accountDiscriminator(e).equals(t)));if(!r)throw new Error("Account descriminator not found");return this.decodeUnchecked(r,e)}decodeUnchecked(e,t){const r=t.subarray(8),n=this.accountLayouts.get(e);if(!n)throw new Error(`Unknown account: ${e}`);return n.decode(r)}memcmp(e,t){const r=Ae.accountDiscriminator(e);return{offset:0,bytes:l.encode(t?c.concat([r,t]):r)}}size(e){var t;return 8+(null!==(t=be(this.idl,e))&&void 0!==t?t:0)}static accountDiscriminator(e){return ke(`account:${d(e,{pascalCase:!0,preserveConsecutiveUppercase:!0})}`)}}class _e{constructor(e){if(void 0===e.events)return void(this.layouts=new Map);const t=e.events.map((t=>{let r={name:t.name,type:{kind:"struct",fields:t.fields.map((e=>({name:e.name,type:e.type})))}};return[t.name,ge.typeDefLayout(r,e.types)]}));this.layouts=new Map(t),this.discriminators=new Map(void 0===e.events?[]:e.events.map((e=>{return[w((t=e.name,ke(`event:${t}`))),e.name];var t})))}decode(e){let t;try{t=v(e)}catch(e){return null}const r=w(t.slice(0,8)),n=this.discriminators.get(r);if(void 0===n)return null;const o=this.layouts.get(n);if(!o)throw new Error(`Unknown event: ${n}`);return{data:o.decode(t.slice(8)),name:n}}}class Ie{constructor(e){if(void 0===e.types)return void(this.typeLayouts=new Map);const t=e.types.map((t=>[t.name,ge.typeDefLayout(t,e.types)]));this.typeLayouts=new Map(t),this.idl=e}encode(e,t){const r=c.alloc(1e3),n=this.typeLayouts.get(e);if(!n)throw new Error(`Unknown type: ${e}`);const o=n.encode(t,r);return r.slice(0,o)}decode(e,t){const r=this.typeLayouts.get(e);if(!r)throw new Error(`Unknown type: ${e}`);return r.decode(t)}}class xe{constructor(e){this.instruction=new we(e),this.accounts=new Ae(e),this.events=new _e(e),this.types=new Ie(e)}}var Me="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};class Pe{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,r){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Le=Pe;class Te extends Pe{isCount(){throw new Error("ExternalLayout is abstract")}}class Be extends Te{constructor(e,t,r){if(!(e instanceof Pe))throw new TypeError("layout must be a Layout");if(void 0===t)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Oe||this.layout instanceof Ve}decode(e,t){return void 0===t&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,r){return void 0===r&&(r=0),this.layout.encode(e,t,r+this.offset)}}class Oe extends Pe{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return void 0===t&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,r){return void 0===r&&(r=0),t.writeUIntLE(e,r,this.span),this.span}}class Ve extends Pe{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return void 0===t&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,r){return void 0===r&&(r=0),t.writeUIntBE(e,r,this.span),this.span}}const De=Math.pow(2,32);function Ue(e){const t=Math.floor(e/De);return{hi32:t,lo32:e-t*De}}function Fe(e,t){return e*De+t}class Ne extends Pe{constructor(e){super(8,e)}decode(e,t){void 0===t&&(t=0);const r=e.readUInt32LE(t);return Fe(e.readUInt32LE(t+4),r)}encode(e,t,r){void 0===r&&(r=0);const n=Ue(e);return t.writeUInt32LE(n.lo32,r),t.writeUInt32LE(n.hi32,r+4),8}}class Re extends Pe{constructor(e){super(8,e)}decode(e,t){void 0===t&&(t=0);const r=e.readUInt32LE(t);return Fe(e.readInt32LE(t+4),r)}encode(e,t,r){void 0===r&&(r=0);const n=Ue(e);return t.writeUInt32LE(n.lo32,r),t.writeInt32LE(n.hi32,r+4),8}}class Ce extends Pe{constructor(e,t,r){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof Pe),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===r&&(r=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let n=-1;try{n=e.reduce(((e,t)=>e+t.getSpan()),0)}catch(e){}super(n,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);let r=0;try{r=this.fields.reduce(((r,n)=>{const o=n.getSpan(e,t);return t+=o,r+o}),0)}catch(e){throw new RangeError("indeterminate span")}return r}decode(e,t){void 0===t&&(t=0);const r=this.makeDestinationObject();for(const n of this.fields)if(void 0!==n.property&&(r[n.property]=n.decode(e,t)),t+=n.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r){void 0===r&&(r=0);const n=r;let o=0,i=0;for(const n of this.fields){let s=n.span;if(i=0<s?s:0,void 0!==n.property){const o=e[n.property];void 0!==o&&(i=n.encode(o,t,r),0>s&&(s=n.getSpan(t,r)))}o=r,r+=s}return o+i-n}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)void 0!==r.property&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}class je{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class We extends je{constructor(e,t){if(!(e instanceof Te&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}class $e extends Pe{constructor(e,t,r){const n=e instanceof Oe||e instanceof Ve;if(n)e=new We(new Be(e));else if(e instanceof Te&&e.isCount())e=new We(e);else if(!(e instanceof je))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(void 0===t&&(t=null),!(null===t||t instanceof Pe))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let o=-1;t&&(o=t.span,0<=o&&n&&(o+=e.layout.span)),super(o,r),this.discriminator=e,this.usesPrefixDiscriminator=n,this.defaultLayout=t,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return i(e)},this.configGetSourceVariant=function(e){i=e.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(e.hasOwnProperty(r.property))return r}throw new Error("unable to infer src variant")}decode(e,t){let r;void 0===t&&(t=0);const n=this.discriminator,o=n.decode(e,t);let i=this.registry[o];if(void 0===i){let s=0;i=this.defaultLayout,this.usesPrefixDiscriminator&&(s=n.layout.span),r=this.makeDestinationObject(),r[n.property]=o,r[i.property]=this.defaultLayout.decode(e,t+s)}else r=i.decode(e,t);return r}encode(e,t,r){void 0===r&&(r=0);const n=this.getSourceVariant(e);if(void 0===n){const n=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=n.layout.span),n.encode(e[n.property],t,r),i+o.encode(e[o.property],t,r+i)}return n.encode(e,t,r)}addVariant(e,t,r){const n=new ze(this,e,t,r);return this.registry[e]=n,n}getVariant(e,t){let r=e;return Buffer.isBuffer(e)&&(void 0===t&&(t=0),r=this.discriminator.decode(e,t)),this.registry[r]}}class ze extends Pe{constructor(e,t,r,n){if(!(e instanceof $e))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof r&&void 0===n&&(n=r,r=null),r){if(!(r instanceof Pe))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof n)throw new TypeError("variant must have a String property")}let o=e.span;0>e.span&&(o=r?r.span:0,0<=o&&e.usesPrefixDiscriminator&&(o+=e.discriminator.layout.span)),super(o,n),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),r+this.layout.getSpan(e,t+r)}decode(e,t){const r=this.makeDestinationObject();if(void 0===t&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+n):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r){void 0===r&&(r=0);let n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let o=n;if(this.layout&&(this.layout.encode(e[this.property],t,r+n),o+=this.layout.getSpan(t,r+n),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class qe extends Pe{constructor(e,t){if(!(e instanceof Te&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof Te||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t){void 0===t&&(t=0);let r=this.span;return 0>r&&(r=this.length.decode(e,t)),e.slice(t,t+r)}encode(e,t,r){let n=this.length;if(this.length instanceof Te&&(n=e.length),!Buffer.isBuffer(e)||n!==e.length)throw new TypeError((o="Blob.encode",((i=this).property?o+"["+i.property+"]":o)+" requires (length "+n+") Buffer as src"));var o,i;if(r+n>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),r,n,"hex"),this.length instanceof Te&&this.length.encode(n,t,r),n}}var Ke=(e,t,r)=>new Be(e,t,r),Ge=e=>new Oe(4,e),He=e=>new Re(e),Je=(e,t,r)=>new Ce(e,t,r),Ze=(e,t,r)=>new $e(e,t,r),Xe=(e,t)=>new qe(e,t);class Ye extends Le{constructor(e){super(-1,e),this.property=e,this.layout=Je([Ge("length"),Ge("lengthPadding"),Xe(Ke(Ge(),-8),"chars")],this.property)}encode(e,t,r=0){if(null==e)return this.layout.span;const n={chars:Buffer.from(e,"utf8")};return this.layout.encode(n,t,r)}decode(e,t=0){return this.layout.decode(e,t).chars.toString()}getSpan(e,t=0){return Ge().span+Ge().span+new u(new Uint8Array(e).slice(t,t+4),10,"le").toNumber()}}function Qe(e){return new Ye(e)}function et(e){return Xe(32,e)}const tt=Ze(Ge("instruction"));tt.addVariant(0,Je([He("lamports"),He("space"),et("owner")]),"createAccount"),tt.addVariant(1,Je([et("owner")]),"assign"),tt.addVariant(2,Je([He("lamports")]),"transfer"),tt.addVariant(3,Je([et("base"),Qe("seed"),He("lamports"),He("space"),et("owner")]),"createAccountWithSeed"),tt.addVariant(4,Je([et("authorized")]),"advanceNonceAccount"),tt.addVariant(5,Je([He("lamports")]),"withdrawNonceAccount"),tt.addVariant(6,Je([et("authorized")]),"initializeNonceAccount"),tt.addVariant(7,Je([et("authorized")]),"authorizeNonceAccount"),tt.addVariant(8,Je([He("space")]),"allocate"),tt.addVariant(9,Je([et("base"),Qe("seed"),He("space"),et("owner")]),"allocateWithSeed"),tt.addVariant(10,Je([et("base"),Qe("seed"),et("owner")]),"assignWithSeed"),tt.addVariant(11,Je([He("lamports"),Qe("seed"),et("owner")]),"transferWithSeed"),Math.max(...Object.values(tt.registry).map((e=>e.span)));class rt extends Le{constructor(e,t,r,n){super(e.span,n),this.layout=e,this.decoder=t,this.encoder=r}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,r){return this.layout.encode(this.encoder(e),t,r)}getSpan(e,t){return this.layout.getSpan(e,t)}}function nt(t){return new rt(Xe(32),(t=>new e(t)),(e=>e.toBuffer()),t)}var ot;Je([Ge("version"),Ge("state"),nt("authorizedPubkey"),nt("nonce"),Je([(ot="lamportsPerSignature",new Ne(ot))],"feeCalculator")]);const it=new e("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),st=new e("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var at={exports:{}};function ct(e){return"accounts"in e}!function(e,t){var r="undefined"!=typeof self?self:Me,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function m(e){var t=new FileReader,r=f(t);return t.readAsArrayBuffer(e),r}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=f(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=u(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[u(e)]},h.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},h.prototype.set=function(e,t){this.map[u(e)]=l(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),d(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),d(e)},n&&(h.prototype[Symbol.iterator]=h.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var r,n,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),w.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function S(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function b(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];b.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function k(e,r){return new Promise((function(n,i){var s=new v(e,r);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;n(new b(o,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}k.polyfill=!0,e.fetch||(e.fetch=k,e.Headers=h,e.Request=v,e.Response=b),t.Headers=h,t.Request=v,t.Response=b,t.fetch=k,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t}(at,at.exports),h.rustEnum([h.struct([],"uninitialized"),h.struct([h.option(h.publicKey(),"authorityAddress")],"buffer"),h.struct([h.publicKey("programdataAddress")],"program"),h.struct([h.u64("slot"),h.option(h.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,h.u32());const ut=h.struct([h.publicKey("authority"),h.vecU8("data")]);function lt(e,t){var r,n;let o={};const i=e.args?e.args.length:0;if(t.length>i){if(t.length!==i+1)throw new Error(`provided too many arguments ${t} to instruction ${null==e?void 0:e.name} expecting: ${null!==(n=null===(r=e.args)||void 0===r?void 0:r.map((e=>e.name)))&&void 0!==n?n:[]}`);o=t.pop()}return[t,o]}class dt{static build(e,t,r){if("_inner"===e.name)throw new ne("the _inner name is reserved");const n=(...o)=>{const[s,a]=lt(e,[...o]),{discriminator:c}=a;b(e.accounts,a.accounts);const u=n.accounts(a.accounts);return void 0!==a.remainingAccounts&&u.push(...a.remainingAccounts),re("debug-logs")&&console.log("Outgoing account metas:",u),new i({keys:u,programId:r,data:t(e.name,S(e,...s),c)})};return n.accounts=t=>dt.accountsArray(t,e.accounts,r,e.name),n}static accountsArray(e,t,r,n){return e?t.map((t=>{if(void 0!==("accounts"in t?t.accounts:void 0)){const o=e[t.name];return dt.accountsArray(o,t.accounts,r,n).flat()}{const o=t;let i;try{i=E(e[t.name])}catch(e){throw new Error(`Wrong input type for account "${t.name}" in the instruction accounts object${void 0!==n?' for instruction "'+n+'"':""}. Expected PublicKey or string.`)}const s=o.isOptional&&i.equals(r);return{pubkey:i,isWritable:o.isMut&&!s,isSigner:o.isSigner&&!s}}})).flat():[]}}class ht{static build(e,t){return(...r)=>{var n,o,i;const[,a]=lt(e,[...r]),c=new s;if(a.preInstructions&&a.instructions)throw new Error("instructions is deprecated, use preInstructions");return null===(n=a.preInstructions)||void 0===n||n.forEach((e=>c.add(e))),null===(o=a.instructions)||void 0===o||o.forEach((e=>c.add(e))),c.add(t(...r)),null===(i=a.postInstructions)||void 0===i||i.forEach((e=>c.add(e))),c}}}class pt{static build(e,t,r,n){return async(...o)=>{var i;const s=t(...o),[,a]=lt(e,[...o]);if(void 0===n.sendAndConfirm)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await n.sendAndConfirm(s,null!==(i=a.signers)&&void 0!==i?i:[],a.options)}catch(e){throw ae(e,r)}}}}class ft{static build(e,t,r,n){var o;const i={};return null===(o=e.accounts)||void 0===o||o.forEach((o=>{const s=d(o.name);i[s]=new mt(e,o,r,n,t)})),i}}class mt{get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}get idlAccount(){return this._idlAccount}constructor(e,t,r,n,o){this._idlAccount=t,this._programId=r,this._provider=null!=n?n:ee(),this._coder=null!=o?o:new xe(e),this._size=this._coder.accounts.size(t)}async fetchNullable(e,t){const{data:r}=await this.fetchNullableAndContext(e,t);return r}async fetchNullableAndContext(e,t){const r=await this.getAccountInfoAndContext(e,t),{value:n,context:o}=r;return{data:n&&0!==n.data.length?this._coder.accounts.decode(this._idlAccount.name,n.data):null,context:o}}async fetch(e,t){const{data:r}=await this.fetchNullableAndContext(e,t);if(null===r)throw new Error(`Account does not exist or has no data ${e.toString()}`);return r}async fetchAndContext(e,t){const{data:r,context:n}=await this.fetchNullableAndContext(e,t);if(null===r)throw new Error(`Account does not exist ${e.toString()}`);return{data:r,context:n}}async fetchMultiple(e,t){return(await this.fetchMultipleAndContext(e,t)).map((e=>e?e.data:null))}async fetchMultipleAndContext(e,t){return(await $(this._provider.connection,e.map((e=>E(e))),t)).map((e=>{if(null==e)return null;const{account:t,context:r}=e;return{data:this._coder.accounts.decode(this._idlAccount.name,t.data),context:r}}))}async all(e){const t=this.coder.accounts.memcmp(this._idlAccount.name,e instanceof Buffer?e:void 0),r=[];return null!=(null==t?void 0:t.offset)&&null!=(null==t?void 0:t.bytes)&&r.push({memcmp:{offset:t.offset,bytes:t.bytes}}),null!=(null==t?void 0:t.dataSize)&&r.push({dataSize:t.dataSize}),(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[...r,...Array.isArray(e)?e:[]]})).map((({pubkey:e,account:t})=>({publicKey:e,account:this._coder.accounts.decode(this._idlAccount.name,t.data)})))}subscribe(e,t){const r=gt.get(e.toString());if(r)return r.ee;const n=new m;e=E(e);const o=this._provider.connection.onAccountChange(e,(e=>{const t=this._coder.accounts.decode(this._idlAccount.name,e.data);n.emit("change",t)}),t);return gt.set(e.toString(),{ee:n,listener:o}),n}async unsubscribe(e){let t=gt.get(e.toString());t?gt&&await this._provider.connection.removeAccountChangeListener(t.listener).then((()=>{gt.delete(e.toString())})).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(e,t){const n=this.size;if(void 0===this._provider.publicKey)throw new Error("This function requires the Provider interface implementor to have a 'publicKey' field.");return r.createAccount({fromPubkey:this._provider.publicKey,newAccountPubkey:e.publicKey,space:null!=t?t:n,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(null!=t?t:n),programId:this._programId})}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(E(e),t)}async getAccountInfoAndContext(e,t){return await this._provider.connection.getAccountInfoAndContext(E(e),t)}}const gt=new Map,yt="Program log: ",wt="Program data: ",vt=yt.length,St=wt.length;class bt{constructor(e,t,r){this._programId=e,this._provider=t,this._eventParser=new Et(e,r),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var r;let n=this._listenerIdCount;return this._listenerIdCount+=1,this._eventListeners.has(e)||this._eventListeners.set(e,[]),this._eventListeners.set(e,(null!==(r=this._eventListeners.get(e))&&void 0!==r?r:[]).concat(n)),this._eventCallbacks.set(n,[e,t]),void 0!==this._onLogsSubscriptionId||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,((e,t)=>{if(!e.err)for(const r of this._eventParser.parseLogs(e.logs)){const n=this._eventListeners.get(r.name);n&&n.forEach((n=>{const o=this._eventCallbacks.get(n);if(o){const[,n]=o;n(r.data,t.slot,e.signature)}}))}}))),n}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[r]=t;let n=this._eventListeners.get(r);if(!n)throw new Error(`Event listeners don't exist for ${r}!`);if(this._eventCallbacks.delete(e),n=n.filter((t=>t!==e)),this._eventListeners.set(r,n),0===n.length&&this._eventListeners.delete(r),0===this._eventCallbacks.size){if(0!==this._eventListeners.size)throw new Error(`Expected event listeners size to be 0 but got ${this._eventListeners.size}`);void 0!==this._onLogsSubscriptionId&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0)}}}class Et{constructor(e,t){this.coder=t,this.programId=e}*parseLogs(e,t=!1){const r=new At(e),n=new kt;let o=r.next();for(;null!==o;){let[e,i,s]=this.handleLog(n,o,t);e&&(yield e),i&&n.push(i),s&&n.pop(),o=r.next()}}handleLog(e,t,r){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t,r):[null,...this.handleSystemLog(t)]}handleProgramLog(e,t){if(e.startsWith(yt)||e.startsWith(wt)){const r=e.startsWith(yt)?e.slice(vt):e.slice(St),n=this.coder.events.decode(r);if(t&&null===n)throw new Error(`Unable to decode event ${r}`);return[n,null,!1]}return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return null!==t.match(/^Program (.*) success/g)?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class kt{constructor(){this.stack=[]}program(){if(!this.stack.length)throw new Error("Expected the stack to have elements");return this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){if(!this.stack.length)throw new Error("Expected the stack to have elements");this.stack.pop()}}class At{constructor(e){this.logs=e}next(){if(0===this.logs.length)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}class _t{static build(e,t,r,n,o,i,s){return async(...a)=>{var c;const u=t(...a),[,l]=lt(e,[...a]);let d;if(void 0===n.simulate)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{d=await n.simulate(u,l.signers,null===(c=l.options)||void 0===c?void 0:c.commitment)}catch(e){throw ae(e,r)}if(void 0===d)throw new Error("Unable to simulate transaction");const h=d.logs;if(!h)throw new Error("Simulated logs not found");const p=[];if(s.events){let e=new Et(i,o);for(const t of e.parseLogs(h))p.push(t)}return{events:p,raw:h}}}}function It(e){return new Pt(Xe(8),(e=>Tt.fromBuffer(e)),(e=>e.toBuffer()),e)}function xt(t){return new Pt(Xe(32),(t=>new e(t)),(e=>e.toBuffer()),t)}function Mt(e,t){return new Lt(e,t)}class Pt extends Le{constructor(e,t,r,n){super(e.span,n),this.layout=e,this.decoder=t,this.encoder=r}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,r){return this.layout.encode(this.encoder(e),t,r)}getSpan(e,t){return this.layout.getSpan(e,t)}}class Lt extends Le{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=Ge()}encode(e,t,r=0){return null==e?this.layout.span+this.discriminator.encode(0,t,r):(this.discriminator.encode(1,t,r),this.layout.encode(e,t,r+4)+4)}decode(e,t=0){const r=this.discriminator.decode(e,t);if(0===r)return null;if(1===r)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}class Tt extends u{toBuffer(){const e=super.toArray().reverse(),t=Buffer.from(e);if(8===t.length)return t;if(t.length>=8)throw new Error("u64 too large");const r=Buffer.alloc(8);return t.copy(r),r}static fromBuffer(e){if(8!==e.length)throw new Error(`Invalid buffer length: ${e.length}`);return new Tt([...e].reverse().map((e=>`00${e.toString(16)}`.slice(-2))).join(""),16)}}const Bt=Je([xt("mint"),xt("owner"),It("amount"),Mt(xt(),"delegate"),(e=>{const t=Ze((e=>new Oe(1,e))("discriminator"),null,"state");return t.addVariant(0,Je([]),"uninitialized"),t.addVariant(1,Je([]),"initialized"),t.addVariant(2,Je([]),"frozen"),t})(),Mt(It(),"isNative"),It("delegatedAmount"),Mt(xt(),"closeAuthority")]);class Ot{constructor(e,t,r,n,o,i,s,a){this._accounts=t,this._provider=r,this._programId=n,this._idlIx=o,this._idlTypes=s,this._customResolver=a,this._args=e,this._accountStore=new Vt(r,i,this._programId)}args(e){this._args=e}async resolve(){for(await this.resolveConst(this._idlIx.accounts),this._resolveEventCpi(this._idlIx.accounts);await this.resolvePdas(this._idlIx.accounts)+await this.resolveRelations(this._idlIx.accounts)+await this.resolveCustom()>0;);}async resolveCustom(){if(this._customResolver){const{accounts:e,resolved:t}=await this._customResolver({args:this._args,accounts:this._accounts,provider:this._provider,programId:this._programId,idlIx:this._idlIx});return this._accounts=e,t}return 0}resolveOptionalsHelper(e,t){const r={};for(const n of t){const t=n.name,o=e[t];void 0!==o&&(Ut(o)?ct(n)?r[t]=this.resolveOptionalsHelper(o,n.accounts):r[t]=Ft(o,!0):null!==o?r[t]=E(o):n.isOptional&&(r[t]=this._programId))}return r}resolveOptionals(e){Object.assign(this._accounts,this.resolveOptionalsHelper(e,this._idlIx.accounts))}get(e){const t=e.reduce(((e,t)=>e&&e[t]),this._accounts);if(t&&t.toBase58)return t}set(e,t){let r=this._accounts;e.forEach(((n,o)=>{o==e.length-1&&(r[n]=t),r[n]=r[n]||{},r=r[n]}))}async resolveConst(e,t=[]){for(let r=0;r<e.length;r+=1){const n=e[r],o=n.accounts;o&&await this.resolveConst(o,[...t,d(n.name)]);const i=n,s=d(n.name);if(i.isSigner&&!this.get([...t,s])){if(void 0===this._provider.wallet)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this.set([...t,s],this._provider.wallet.publicKey)}Reflect.has(Ot.CONST_ACCOUNTS,s)&&!this.get([...t,s])&&this.set([...t,s],Ot.CONST_ACCOUNTS[s])}}_resolveEventCpi(t,r=[]){for(const n in t){const o=t[n],i=o.accounts;i&&this._resolveEventCpi(i,[...r,d(o.name)]);const s=+n+1;if(s===t.length)return;const a=d(t[n].name),c=d(t[s].name);if("eventAuthority"===a&&"program"===c){const t=[...r,a],n=[...r,c];return this.get(t)||this.set(t,e.findProgramAddressSync([Buffer.from("__event_authority")],this._programId)[0]),void(this.get(n)||this.set(n,this._programId))}}}async resolvePdas(e,t=[]){let r=0;for(let n=0;n<e.length;n+=1){const o=e[n],i=o.accounts;i&&(r+=await this.resolvePdas(i,[...t,d(o.name)]));const s=o,a=d(o.name);s.pda&&s.pda.seeds.length>0&&!this.get([...t,a])&&Boolean(await this.autoPopulatePda(s,t))&&(r+=1)}return r}async resolveRelations(e,t=[]){let r=0;for(let n=0;n<e.length;n+=1){const o=e[n],i=o.accounts;i&&(r+=await this.resolveRelations(i,[...t,d(o.name)]));const s=o.relations||[],a=d(o.name),c=[...t,a],u=this.get(c);if(u){const e=s.filter((e=>!this.get([...t,d(e)])));if(r+=e.length,e.length>0){const r=await this._accountStore.fetchAccount({publicKey:u});await Promise.all(e.map((async e=>{const n=d(e);return this.set([...t,n],r[n]),r[n]})))}}}return r}async autoPopulatePda(t,r=[]){if(!t.pda||!t.pda.seeds)throw new Error("Must have seeds");const n=await Promise.all(t.pda.seeds.map((e=>this.toBuffer(e,r))));if(n.some((e=>void 0===e)))return;const o=await this.parseProgramId(t,r);if(!o)return;const[i]=await e.findProgramAddress(n,o);this.set([...r,d(t.name)],i)}async parseProgramId(t,r=[]){var n;if(!(null===(n=t.pda)||void 0===n?void 0:n.programId))return this._programId;switch(t.pda.programId.kind){case"const":return new e(this.toBufferConst(t.pda.programId.value));case"arg":return this.argValue(t.pda.programId);case"account":return await this.accountValue(t.pda.programId,r);default:throw new Error(`Unexpected program seed: ${t.pda.programId}`)}}async toBuffer(e,t=[]){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e,t);default:throw new Error(`Unexpected seed: ${e}`)}}getType(e,t=[]){if(t.length>0&&e.defined){const r=this._idlTypes.find((t=>t.name===e.defined));if(!r)throw new Error(`Cannot find type ${e.defined}`);const n=r.type.fields.find((e=>e.name===t[0]));return this.getType(n.type,t.slice(1))}return e}toBufferConst(e){return this.toBufferValue(this.getType(e.type),e.value)}async toBufferArg(e){const t=this.argValue(e);if(void 0!==t)return this.toBufferValue(this.getType(e.type,(e.path||"").split(".").slice(1)),t)}argValue(e){const t=e.path.split("."),r=d(t[0]),n=this._idlIx.args.findIndex((e=>e.name===r));if(-1===n)throw new Error(`Unable to find argument for seed: ${r}`);return t.slice(1).reduce(((e,t)=>(e||{})[t]),this._args[n])}async toBufferAccount(e,t=[]){const r=await this.accountValue(e,t);if(r)return this.toBufferValue(e.type,r)}async accountValue(e,t=[]){const r=e.path.split("."),n=r[0],o=this.get([...t,d(n)]);if(null===o)throw new Error("fieldPubkey is null");if(1===r.length)return o;const i=await this._accountStore.fetchAccount({publicKey:o,name:e.account});return this.parseAccountValue(i,r.slice(1))}parseAccountValue(e,t){let r;for(;t.length>0;)r=e[d(t[0])],t=t.slice(1);return r}toBufferValue(e,t){switch(e){case"u8":return Buffer.from([t]);case"u16":let n=Buffer.alloc(2);return n.writeUInt16LE(t),n;case"u32":let o=Buffer.alloc(4);return o.writeUInt32LE(t),o;case"u64":let i=Buffer.alloc(8);return i.writeBigUInt64LE(BigInt(t)),i;case"string":return Buffer.from((r=t,(new TextEncoder).encode(r)));case"publicKey":return t.toBuffer();default:if(e.array)return Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}var r}}Ot.CONST_ACCOUNTS={associatedTokenProgram:st,rent:t,systemProgram:r.programId,tokenProgram:it,clock:n};class Vt{constructor(e,t,r){this._provider=e,this._programId=r,this._cache=new Map,this._idls={},this._idls[r.toBase58()]=t}async ensureIdl(e){if(!this._idls[e.toBase58()]){const t=await jt.fetchIdl(e,this._provider);if(t){const r=new jt(t,e,this._provider);this._idls[e.toBase58()]=r.account}}return this._idls[e.toBase58()]}async fetchAccount({publicKey:e,name:t,programId:r=this._programId}){const n=e.toString();if(!this._cache.has(n))if("TokenAccount"===t){const t=await this._provider.connection.getAccountInfo(e);if(null===t)throw new Error(`invalid account info for ${n}`);const r=function(e){return Bt.decode(e)}(t.data);this._cache.set(n,r)}else if(t){const o=await this.ensureIdl(r);if(o){const r=o[d(t)];if(r){const t=await r.fetch(e);this._cache.set(n,t)}}}else{const t=await this._provider.connection.getAccountInfo(e);if(null===t)throw new Error(`invalid account info for ${n}`);const r=t.data,o=await this.ensureIdl(t.owner);if(o){const e=Object.values(o)[0];if(!e)throw new Error("No accounts for this program");const t=e.coder.accounts.decodeAny(r);this._cache.set(n,t)}}return this._cache.get(n)}}class Dt{static build(e,t,r,n,o,i,s,a,c,u,l){return(...d)=>new Nt(d,n,o,i,s,a,e,t,r,c,u,l)}}function Ut(e){return"object"==typeof e&&null!==e&&!("_bn"in e)}function Ft(e,t){const r={};for(const n in e){const o=e[n];if(null!==o)r[n]=Ut(o)?Ft(o,!0):E(o);else if(t)throw new Error("Failed to resolve optionals due to IDL type mismatch with input accounts!")}return r}class Nt{constructor(e,t,r,n,o,i,s,a,c,u,l,d){this._ixFn=t,this._txFn=r,this._rpcFn=n,this._simulateFn=o,this._viewFn=i,this._programId=a,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._autoResolveAccounts=!0,this._args=e,this._accountsResolver=new Ot(e,this._accounts,s,a,c,u,l,d)}args(e){this._args=e,this._accountsResolver.args(e)}async pubkeys(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._accounts}interface(e){if("spl_transfer_hook_interface::initialize_extra_account_metas"===e)this._discriminator=Buffer.from([43,34,13,49,167,88,235,235]);else{if("spl_transfer_hook_interface::execute"!==e)throw new Error(`Unsupported interface: ${e}`);this._discriminator=Buffer.from([105,37,101,197,75,251,102,26])}return this}accounts(e){return this._autoResolveAccounts=!0,this._accountsResolver.resolveOptionals(e),this}accountsStrict(e){return this._autoResolveAccounts=!1,this._accountsResolver.resolveOptionals(e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e,discriminator:this._discriminator})}async rpcAndKeys(e){return{pubkeys:await this.pubkeys(),signature:await this.rpc(e)}}async view(e){if(this._autoResolveAccounts&&await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,discriminator:this._discriminator})}async prepare(){return{instruction:await this.instruction(),pubkeys:await this.pubkeys(),signers:await this._signers}}async transaction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,discriminator:this._discriminator})}}class Rt{static build(e,t,r,n){const o=t.accounts.find((e=>e.isMut)),i=!!t.returns;if(o||!i)return;return async(...o)=>{var i,s;let a=await r(...o);const c=`Program return: ${e} `;let u=a.raw.find((e=>e.startsWith(c)));if(!u)throw new Error("View expected return log");let l=v(u.slice(c.length)),d=t.returns;if(!d)throw new Error("View expected return type");return ge.fieldLayout({type:d},Array.from([...null!==(i=n.accounts)&&void 0!==i?i:[],...null!==(s=n.types)&&void 0!==s?s:[]])).decode(l)}}}class Ct{static build(e,t,r,n,o){const i={},s={},a={},c={},u={},l={},h=function(e){const t=new Map;return e.errors&&e.errors.forEach((e=>{var r;let n=null!==(r=e.msg)&&void 0!==r?r:e.name;t.set(e.code,n)})),t}(e),p=e.accounts?ft.build(e,t,r,n):{};return e.instructions.forEach((f=>{const m=dt.build(f,((e,r,n)=>t.instruction.encode(e,r,n)),r),g=ht.build(f,m),y=pt.build(f,g,h,n),w=_t.build(f,g,h,n,t,r,e),v=Rt.build(r,f,w,e),S=Dt.build(n,r,f,m,g,y,w,v,p,e.types||[],o&&o(f)),b=d(f.name);s[b]=m,a[b]=g,i[b]=y,c[b]=w,u[b]=S,v&&(l[b]=v)})),[i,s,a,p,c,u,l]}}class jt{get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}constructor(e,t,r,n,o){t=E(t),r||(r=ee()),this._idl=e,this._provider=r,this._programId=t,this._coder=null!=n?n:new xe(e),this._events=new bt(this._programId,r,this._coder);const[i,s,a,c,u,l,d]=Ct.build(e,this._coder,t,r,null!=o?o:()=>{});this.rpc=i,this.instruction=s,this.transaction=a,this.account=c,this.simulate=u,this.methods=l,this.views=d}static async at(e,t){const r=E(e),n=await jt.fetchIdl(r,t);if(!n)throw new Error(`IDL not found for program: ${e.toString()}`);return new jt(n,r,t)}static async fetchIdl(t,r){r=null!=r?r:ee();const n=E(t),o=await async function(t){const r=(await e.findProgramAddress([],t))[0];return await e.createWithSeed(r,"anchor:idl",t)}(n),i=await r.connection.getAccountInfo(o);if(!i)return null;let s=(a=i.data.slice(8),ut.decode(a));var a;const c=f(s.data);return JSON.parse(function(e){return new TextDecoder("utf-8").decode(e)}(c))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}new e("11111111111111111111111111111111");var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.s16=Wt.s8=Wt.nu64be=Wt.u48be=Wt.u40be=Wt.u32be=Wt.u24be=Wt.u16be=Wt.nu64=Wt.u48=Wt.u40=Pr=Wt.u32=Wt.u24=Wt.u16=Mr=Wt.u8=xr=Wt.offset=Wt.greedy=Wt.Constant=Wt.UTF8=Wt.CString=Wt.Blob=Wt.Boolean=Wt.BitField=Wt.BitStructure=Wt.VariantLayout=Wt.Union=Wt.UnionLayoutDiscriminator=Wt.UnionDiscriminator=Wt.Structure=Wt.Sequence=Wt.DoubleBE=Wt.Double=Wt.FloatBE=Wt.Float=Wt.NearInt64BE=Wt.NearInt64=Wt.NearUInt64BE=Wt.NearUInt64=Wt.IntBE=Wt.Int=Wt.UIntBE=Wt.UInt=Wt.OffsetLayout=Wt.GreedyCount=Wt.ExternalLayout=Wt.bindConstructorLayout=Wt.nameWithProperty=Wt.Layout=Wt.uint8ArrayToBuffer=Wt.checkUint8Array=void 0,Wt.constant=Wt.utf8=Wt.cstr=Or=Wt.blob=Wt.unionLayoutDiscriminator=Wt.union=Tr=Wt.seq=Wt.bits=Lr=Wt.struct=Wt.f64be=Wt.f64=Wt.f32be=Wt.f32=Wt.ns64be=Wt.s48be=Wt.s40be=Wt.s32be=Wt.s24be=Wt.s16be=Wt.ns64=Wt.s48=Wt.s40=Wt.s32=Wt.s24=void 0;const $t=a;function zt(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function qt(e){return zt(e),$t.Buffer.from(e.buffer,e.byteOffset,e.length)}Wt.checkUint8Array=zt,Wt.uint8ArrayToBuffer=qt;class Kt{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Gt=Wt.Layout=Kt;function Ht(e,t){return t.property?e+"["+t.property+"]":e}Wt.nameWithProperty=Ht,Wt.bindConstructorLayout=function(e,t){if("function"!=typeof e)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(e,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof Kt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=()=>new e,Object.defineProperty(e.prototype,"encode",{value(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(e,"decode",{value:(e,r)=>t.decode(e,r),writable:!0})};class Jt extends Kt{isCount(){throw new Error("ExternalLayout is abstract")}}Wt.ExternalLayout=Jt;class Zt extends Jt{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){zt(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}Wt.GreedyCount=Zt;class Xt extends Jt{constructor(e,t=0,r){if(!(e instanceof Kt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Yt||this.layout instanceof Qt}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}Wt.OffsetLayout=Xt;class Yt extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return qt(e).readUIntLE(t,this.span)}encode(e,t,r=0){return qt(t).writeUIntLE(e,r,this.span),this.span}}Wt.UInt=Yt;class Qt extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return qt(e).readUIntBE(t,this.span)}encode(e,t,r=0){return qt(t).writeUIntBE(e,r,this.span),this.span}}Wt.UIntBE=Qt;class er extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return qt(e).readIntLE(t,this.span)}encode(e,t,r=0){return qt(t).writeIntLE(e,r,this.span),this.span}}Wt.Int=er;class tr extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return qt(e).readIntBE(t,this.span)}encode(e,t,r=0){return qt(t).writeIntBE(e,r,this.span),this.span}}Wt.IntBE=tr;const rr=Math.pow(2,32);function nr(e){const t=Math.floor(e/rr);return{hi32:t,lo32:e-t*rr}}function or(e,t){return e*rr+t}class ir extends Kt{constructor(e){super(8,e)}decode(e,t=0){const r=qt(e),n=r.readUInt32LE(t);return or(r.readUInt32LE(t+4),n)}encode(e,t,r=0){const n=nr(e),o=qt(t);return o.writeUInt32LE(n.lo32,r),o.writeUInt32LE(n.hi32,r+4),8}}Wt.NearUInt64=ir;class sr extends Kt{constructor(e){super(8,e)}decode(e,t=0){const r=qt(e);return or(r.readUInt32BE(t),r.readUInt32BE(t+4))}encode(e,t,r=0){const n=nr(e),o=qt(t);return o.writeUInt32BE(n.hi32,r),o.writeUInt32BE(n.lo32,r+4),8}}Wt.NearUInt64BE=sr;class ar extends Kt{constructor(e){super(8,e)}decode(e,t=0){const r=qt(e),n=r.readUInt32LE(t);return or(r.readInt32LE(t+4),n)}encode(e,t,r=0){const n=nr(e),o=qt(t);return o.writeUInt32LE(n.lo32,r),o.writeInt32LE(n.hi32,r+4),8}}Wt.NearInt64=ar;class cr extends Kt{constructor(e){super(8,e)}decode(e,t=0){const r=qt(e);return or(r.readInt32BE(t),r.readUInt32BE(t+4))}encode(e,t,r=0){const n=nr(e),o=qt(t);return o.writeInt32BE(n.hi32,r),o.writeUInt32BE(n.lo32,r+4),8}}Wt.NearInt64BE=cr;class ur extends Kt{constructor(e){super(4,e)}decode(e,t=0){return qt(e).readFloatLE(t)}encode(e,t,r=0){return qt(t).writeFloatLE(e,r),4}}Wt.Float=ur;class lr extends Kt{constructor(e){super(4,e)}decode(e,t=0){return qt(e).readFloatBE(t)}encode(e,t,r=0){return qt(t).writeFloatBE(e,r),4}}Wt.FloatBE=lr;class dr extends Kt{constructor(e){super(8,e)}decode(e,t=0){return qt(e).readDoubleLE(t)}encode(e,t,r=0){return qt(t).writeDoubleLE(e,r),8}}Wt.Double=dr;class hr extends Kt{constructor(e){super(8,e)}decode(e,t=0){return qt(e).readDoubleBE(t)}encode(e,t,r=0){return qt(t).writeDoubleBE(e,r),8}}Wt.DoubleBE=hr;class pr extends Kt{constructor(e,t,r){if(!(e instanceof Kt))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof Jt&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let n=-1;!(t instanceof Jt)&&0<e.span&&(n=t*e.span),super(n,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,n=this.count;if(n instanceof Jt&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else{let o=0;for(;o<n;)r+=this.elementLayout.getSpan(e,t+r),++o}return r}decode(e,t=0){const r=[];let n=0,o=this.count;for(o instanceof Jt&&(o=o.decode(e,t));n<o;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}encode(e,t,r=0){const n=this.elementLayout,o=e.reduce(((e,o)=>e+n.encode(o,t,r+e)),0);return this.count instanceof Jt&&this.count.encode(e.length,t,r),o}}Wt.Sequence=pr;class fr extends Kt{constructor(e,t,r){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof Kt),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===r&&(r=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let n=-1;try{n=e.reduce(((e,t)=>e+t.getSpan()),0)}catch(e){}super(n,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce(((r,n)=>{const o=n.getSpan(e,t);return t+=o,r+o}),0)}catch(e){throw new RangeError("indeterminate span")}return r}decode(e,t=0){zt(e);const r=this.makeDestinationObject();for(const n of this.fields)if(void 0!==n.property&&(r[n.property]=n.decode(e,t)),t+=n.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const n=r;let o=0,i=0;for(const n of this.fields){let s=n.span;if(i=0<s?s:0,void 0!==n.property){const o=e[n.property];void 0!==o&&(i=n.encode(o,t,r),0>s&&(s=n.getSpan(t,r)))}o=r,r+=s}return o+i-n}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)void 0!==r.property&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}Wt.Structure=fr;class mr{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}Wt.UnionDiscriminator=mr;class gr extends mr{constructor(e,t){if(!(e instanceof Jt&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}Wt.UnionLayoutDiscriminator=gr;class yr extends Kt{constructor(e,t,r){let n;if(e instanceof Yt||e instanceof Qt)n=new gr(new Xt(e));else if(e instanceof Jt&&e.isCount())n=new gr(e);else{if(!(e instanceof mr))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");n=e}if(void 0===t&&(t=null),!(null===t||t instanceof Kt))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let o=-1;t&&(o=t.span,0<=o&&(e instanceof Yt||e instanceof Qt)&&(o+=n.layout.span)),super(o,r),this.discriminator=n,this.usesPrefixDiscriminator=e instanceof Yt||e instanceof Qt,this.defaultLayout=t,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return i(e)},this.configGetSourceVariant=function(e){i=e.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const n=this.discriminator,o=n.decode(e,t),i=this.registry[o];if(void 0===i){const i=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=n.layout.span),r=this.makeDestinationObject(),r[n.property]=o,r[i.property]=i.decode(e,t+s)}else r=i.decode(e,t);return r}encode(e,t,r=0){const n=this.getSourceVariant(e);if(void 0===n){const n=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=n.layout.span),n.encode(e[n.property],t,r),i+o.encode(e[o.property],t,r+i)}return n.encode(e,t,r)}addVariant(e,t,r){const n=new wr(this,e,t,r);return this.registry[e]=n,n}getVariant(e,t=0){let r;return r=e instanceof Uint8Array?this.discriminator.decode(e,t):e,this.registry[r]}}Wt.Union=yr;class wr extends Kt{constructor(e,t,r,n){if(!(e instanceof yr))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof r&&void 0===n&&(n=r,r=null),r){if(!(r instanceof Kt))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof n)throw new TypeError("variant must have a String property")}let o=e.span;0>e.span&&(o=r?r.span:0,0<=o&&e.usesPrefixDiscriminator&&(o+=e.discriminator.layout.span)),super(o,n),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let n=0;return this.layout&&(n=this.layout.getSpan(e,t+r)),r+n}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+n):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let o=n;if(this.layout&&(this.layout.encode(e[this.property],t,r+n),o+=this.layout.getSpan(t,r+n),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}function vr(e){return 0>e&&(e+=4294967296),e}Wt.VariantLayout=wr;class Sr extends Kt{constructor(e,t,r){if(!(e instanceof Yt||e instanceof Qt))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof t&&void 0===r&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let n=0;this._packedSetValue=function(e){return n=vr(e),this},this._packedGetValue=function(){return n}}decode(e,t=0){const r=this.makeDestinationObject(),n=this.word.decode(e,t);this._packedSetValue(n);for(const t of this.fields)void 0!==t.property&&(r[t.property]=t.decode(e));return r}encode(e,t,r=0){const n=this.word.decode(t,r);this._packedSetValue(n);for(const t of this.fields)if(void 0!==t.property){const r=e[t.property];void 0!==r&&t.encode(r)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new br(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new Er(this,e);return this.fields.push(t),t}fieldFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}Wt.BitStructure=Sr;class br{constructor(e,t,r){if(!(e instanceof Sr))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const n=8*e.span,o=e.fields.reduce(((e,t)=>e+t.bits),0);if(t+o>n)throw new Error("bits too long for span remainder ("+(n-o)+" of "+n+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,32===t&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=n-o-t),this.wordMask=vr(this.valueMask<<this.start),this.property=r}decode(e,t){return vr(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(e){if("number"!=typeof e||!Number.isInteger(e)||e!==vr(e&this.valueMask))throw new TypeError(Ht("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=vr(e<<this.start);this.container._packedSetValue(vr(t&~this.wordMask)|r)}}Wt.BitField=br;class Er extends br{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){"boolean"==typeof e&&(e=+e),super.encode(e)}}Wt.Boolean=Er;class kr extends Kt{constructor(e,t){if(!(e instanceof Jt&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof Jt||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),qt(e).slice(t,t+r)}encode(e,t,r){let n=this.length;if(this.length instanceof Jt&&(n=e.length),!(e instanceof Uint8Array&&n===e.length))throw new TypeError(Ht("Blob.encode",this)+" requires (length "+n+") Uint8Array as src");if(r+n>t.length)throw new RangeError("encoding overruns Uint8Array");const o=qt(e);return qt(t).write(o.toString("hex"),r,n,"hex"),this.length instanceof Jt&&this.length.encode(n,t,r),n}}Wt.Blob=kr;class Ar extends Kt{constructor(e){super(-1,e)}getSpan(e,t=0){zt(e);let r=t;for(;r<e.length&&0!==e[r];)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return qt(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){"string"!=typeof e&&(e=String(e));const n=$t.Buffer.from(e,"utf8"),o=n.length;if(r+o>t.length)throw new RangeError("encoding overruns Buffer");const i=qt(t);return n.copy(i,r),i[r+o]=0,o+1}}Wt.CString=Ar;class _r extends Kt{constructor(e,t){if("string"==typeof e&&void 0===t&&(t=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return zt(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return qt(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){"string"!=typeof e&&(e=String(e));const n=$t.Buffer.from(e,"utf8"),o=n.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(r+o>t.length)throw new RangeError("encoding overruns Buffer");return n.copy(qt(t),r),o}}Wt.UTF8=_r;class Ir extends Kt{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}Wt.Constant=Ir,Wt.greedy=(e,t)=>new Zt(e,t);var xr=Wt.offset=(e,t,r)=>new Xt(e,t,r),Mr=Wt.u8=e=>new Yt(1,e);Wt.u16=e=>new Yt(2,e),Wt.u24=e=>new Yt(3,e);var Pr=Wt.u32=e=>new Yt(4,e);Wt.u40=e=>new Yt(5,e),Wt.u48=e=>new Yt(6,e),Wt.nu64=e=>new ir(e),Wt.u16be=e=>new Qt(2,e),Wt.u24be=e=>new Qt(3,e),Wt.u32be=e=>new Qt(4,e),Wt.u40be=e=>new Qt(5,e),Wt.u48be=e=>new Qt(6,e),Wt.nu64be=e=>new sr(e),Wt.s8=e=>new er(1,e),Wt.s16=e=>new er(2,e),Wt.s24=e=>new er(3,e),Wt.s32=e=>new er(4,e),Wt.s40=e=>new er(5,e),Wt.s48=e=>new er(6,e),Wt.ns64=e=>new ar(e),Wt.s16be=e=>new tr(2,e),Wt.s24be=e=>new tr(3,e),Wt.s32be=e=>new tr(4,e),Wt.s40be=e=>new tr(5,e),Wt.s48be=e=>new tr(6,e),Wt.ns64be=e=>new cr(e),Wt.f32=e=>new ur(e),Wt.f32be=e=>new lr(e),Wt.f64=e=>new dr(e),Wt.f64be=e=>new hr(e);var Lr=Wt.struct=(e,t,r)=>new fr(e,t,r);Wt.bits=(e,t,r)=>new Sr(e,t,r);var Tr=Wt.seq=(e,t,r)=>new pr(e,t,r),Br=Wt.union=(e,t,r)=>new yr(e,t,r);Wt.unionLayoutDiscriminator=(e,t)=>new gr(e,t);var Or=Wt.blob=(e,t)=>new kr(e,t);Wt.cstr=e=>new Ar(e),Wt.utf8=(e,t)=>new _r(e,t),Wt.constant=(e,t)=>new Ir(e,t);const Vr=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)});var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.toBigIntLE=function(e){{const t=Buffer.from(e);t.reverse();const r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)}},Dr.toBigIntBE=function(e){{const t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)}},Dr.toBufferLE=function(e,t){{const r=e.toString(16),n=Buffer.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return n.reverse(),n}},Dr.toBufferBE=function(e,t){{const r=e.toString(16);return Buffer.from(r.padStart(2*t,"0").slice(0,2*t),"hex")}};var Ur=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Fr=Math.ceil,Nr=Math.floor,Rr="[BigNumber Error] ",Cr=Rr+"Number primitive has more than 15 significant digits: ",jr=1e14,Wr=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],$r=1e9;function zr(e){var t=0|e;return e>0||e===t?t:t-1}function qr(e){for(var t,r,n=1,o=e.length,i=e[0]+"";n<o;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);i+=t}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function Kr(e,t){var r,n,o=e.c,i=t.c,s=e.s,a=t.s,c=e.e,u=t.e;if(!s||!a)return null;if(r=o&&!o[0],n=i&&!i[0],r||n)return r?n?0:-a:s;if(s!=a)return s;if(r=s<0,n=c==u,!o||!i)return n?0:!o^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=o.length)<(u=i.length)?c:u,s=0;s<a;s++)if(o[s]!=i[s])return o[s]>i[s]^r?1:-1;return c==u?0:c>u^r?1:-1}function Gr(e,t,r,n){if(e<t||e>r||e!==Nr(e))throw Error(Rr+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Hr(e){var t=e.c.length-1;return zr(e.e/14)==t&&e.c[t]%2!=0}function Jr(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Zr(e,t,r){var n,o;if(t<0){for(o=r+".";++t;o+=r);e=o+e}else if(++t>(n=e.length)){for(o=r,t-=n;--t;o+=r);e+=o}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Xr=function e(t){var r,n,o,i,s,a,c,u,l,d,h=I.prototype={constructor:I,toString:null,valueOf:null},p=new I(1),f=20,m=4,g=-7,y=21,w=-1e7,v=1e7,S=!1,b=1,E=0,k={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},A="0123456789abcdefghijklmnopqrstuvwxyz",_=!0;function I(e,t){var r,i,s,a,c,u,l,d,h=this;if(!(h instanceof I))return new I(e,t);if(null==t){if(e&&!0===e._isBigNumber)return h.s=e.s,void(!e.c||e.e>v?h.c=h.e=null:e.e<w?h.c=[h.e=0]:(h.e=e.e,h.c=e.c.slice()));if((u="number"==typeof e)&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,c=e;c>=10;c/=10,a++);return void(a>v?h.c=h.e=null:(h.e=a,h.c=[e]))}d=String(e)}else{if(!Ur.test(d=String(e)))return o(h,d,u);h.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(a=d.indexOf("."))>-1&&(d=d.replace(".","")),(c=d.search(/e/i))>0?(a<0&&(a=c),a+=+d.slice(c+1),d=d.substring(0,c)):a<0&&(a=d.length)}else{if(Gr(t,2,A.length,"Base"),10==t&&_)return L(h=new I(e),f+h.e+1,m);if(d=String(e),u="number"==typeof e){if(0*e!=0)return o(h,d,u,t);if(h.s=1/e<0?(d=d.slice(1),-1):1,I.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(Cr+e)}else h.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(r=A.slice(0,t),a=c=0,l=d.length;c<l;c++)if(r.indexOf(i=d.charAt(c))<0){if("."==i){if(c>a){a=l;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,c=-1,a=0;continue}return o(h,String(e),u,t)}u=!1,(a=(d=n(d,t,10,h.s)).indexOf("."))>-1?d=d.replace(".",""):a=d.length}for(c=0;48===d.charCodeAt(c);c++);for(l=d.length;48===d.charCodeAt(--l););if(d=d.slice(c,++l)){if(l-=c,u&&I.DEBUG&&l>15&&(e>9007199254740991||e!==Nr(e)))throw Error(Cr+h.s*e);if((a=a-c-1)>v)h.c=h.e=null;else if(a<w)h.c=[h.e=0];else{if(h.e=a,h.c=[],c=(a+1)%14,a<0&&(c+=14),c<l){for(c&&h.c.push(+d.slice(0,c)),l-=14;c<l;)h.c.push(+d.slice(c,c+=14));c=14-(d=d.slice(c)).length}else c-=l;for(;c--;d+="0");h.c.push(+d)}}else h.c=[h.e=0]}function x(e,t,r,n){var o,i,s,a,c;if(null==r?r=m:Gr(r,0,8),!e.c)return e.toString();if(o=e.c[0],s=e.e,null==t)c=qr(e.c),c=1==n||2==n&&(s<=g||s>=y)?Jr(c,s):Zr(c,s,"0");else if(i=(e=L(new I(e),t,r)).e,a=(c=qr(e.c)).length,1==n||2==n&&(t<=i||i<=g)){for(;a<t;c+="0",a++);c=Jr(c,i)}else if(t-=s,c=Zr(c,i,"0"),i+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=i-a)>0)for(i+1==a&&(c+=".");t--;c+="0");return e.s<0&&o?"-"+c:c}function M(e,t){for(var r,n=1,o=new I(e[0]);n<e.length;n++){if(!(r=new I(e[n])).s){o=r;break}t.call(o,r)&&(o=r)}return o}function P(e,t,r){for(var n=1,o=t.length;!t[--o];t.pop());for(o=t[0];o>=10;o/=10,n++);return(r=n+14*r-1)>v?e.c=e.e=null:r<w?e.c=[e.e=0]:(e.e=r,e.c=t),e}function L(e,t,r,n){var o,i,s,a,c,u,l,d=e.c,h=Wr;if(d){e:{for(o=1,a=d[0];a>=10;a/=10,o++);if((i=t-o)<0)i+=14,s=t,l=(c=d[u=0])/h[o-s-1]%10|0;else if((u=Fr((i+1)/14))>=d.length){if(!n)break e;for(;d.length<=u;d.push(0));c=l=0,o=1,s=(i%=14)-14+1}else{for(c=a=d[u],o=1;a>=10;a/=10,o++);l=(s=(i%=14)-14+o)<0?0:c/h[o-s-1]%10|0}if(n=n||t<0||null!=d[u+1]||(s<0?c:c%h[o-s-1]),n=r<4?(l||n)&&(0==r||r==(e.s<0?3:2)):l>5||5==l&&(4==r||n||6==r&&(i>0?s>0?c/h[o-s]:0:d[u-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,n?(t-=e.e+1,d[0]=h[(14-t%14)%14],e.e=-t||0):d[0]=e.e=0,e;if(0==i?(d.length=u,a=1,u--):(d.length=u+1,a=h[14-i],d[u]=s>0?Nr(c/h[o-s]%h[s])*a:0),n)for(;;){if(0==u){for(i=1,s=d[0];s>=10;s/=10,i++);for(s=d[0]+=a,a=1;s>=10;s/=10,a++);i!=a&&(e.e++,d[0]==jr&&(d[0]=1));break}if(d[u]+=a,d[u]!=jr)break;d[u--]=0,a=1}for(i=d.length;0===d[--i];d.pop());}e.e>v?e.c=e.e=null:e.e<w&&(e.c=[e.e=0])}return e}function T(e){var t,r=e.e;return null===r?e.toString():(t=qr(e.c),t=r<=g||r>=y?Jr(t,r):Zr(t,r,"0"),e.s<0?"-"+t:t)}return I.clone=e,I.ROUND_UP=0,I.ROUND_DOWN=1,I.ROUND_CEIL=2,I.ROUND_FLOOR=3,I.ROUND_HALF_UP=4,I.ROUND_HALF_DOWN=5,I.ROUND_HALF_EVEN=6,I.ROUND_HALF_CEIL=7,I.ROUND_HALF_FLOOR=8,I.EUCLID=9,I.config=I.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(Rr+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(Gr(r=e[t],0,$r,t),f=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(Gr(r=e[t],0,8,t),m=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(Gr(r[0],-$r,0,t),Gr(r[1],0,$r,t),g=r[0],y=r[1]):(Gr(r,-$r,$r,t),g=-(y=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)Gr(r[0],-$r,-1,t),Gr(r[1],1,$r,t),w=r[0],v=r[1];else{if(Gr(r,-$r,$r,t),!r)throw Error(Rr+t+" cannot be zero: "+r);w=-(v=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(Rr+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw S=!r,Error(Rr+"crypto unavailable");S=r}else S=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(Gr(r=e[t],0,9,t),b=r),e.hasOwnProperty(t="POW_PRECISION")&&(Gr(r=e[t],0,$r,t),E=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(Rr+t+" not an object: "+r);k=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(Rr+t+" invalid: "+r);_="0123456789"==r.slice(0,10),A=r}}return{DECIMAL_PLACES:f,ROUNDING_MODE:m,EXPONENTIAL_AT:[g,y],RANGE:[w,v],CRYPTO:S,MODULO_MODE:b,POW_PRECISION:E,FORMAT:k,ALPHABET:A}},I.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!I.DEBUG)return!0;var t,r,n=e.c,o=e.e,i=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===i||-1===i)&&o>=-$r&&o<=$r&&o===Nr(o)){if(0===n[0]){if(0===o&&1===n.length)return!0;break e}if((t=(o+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=jr||r!==Nr(r))break e;if(0!==r)return!0}}}else if(null===n&&null===o&&(null===i||1===i||-1===i))return!0;throw Error(Rr+"Invalid BigNumber: "+e)},I.maximum=I.max=function(){return M(arguments,h.lt)},I.minimum=I.min=function(){return M(arguments,h.gt)},I.random=(i=9007199254740992,s=Math.random()*i&2097151?function(){return Nr(Math.random()*i)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,o,i,a=0,c=[],u=new I(p);if(null==e?e=f:Gr(e,0,$r),o=Fr(e/14),S)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));a<o;)(i=131072*t[a]+(t[a+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[a]=r[0],t[a+1]=r[1]):(c.push(i%1e14),a+=2);a=o/2}else{if(!crypto.randomBytes)throw S=!1,Error(Rr+"crypto unavailable");for(t=crypto.randomBytes(o*=7);a<o;)(i=281474976710656*(31&t[a])+1099511627776*t[a+1]+4294967296*t[a+2]+16777216*t[a+3]+(t[a+4]<<16)+(t[a+5]<<8)+t[a+6])>=9e15?crypto.randomBytes(7).copy(t,a):(c.push(i%1e14),a+=7);a=o/7}if(!S)for(;a<o;)(i=s())<9e15&&(c[a++]=i%1e14);for(e%=14,(o=c[--a])&&e&&(i=Wr[14-e],c[a]=Nr(o/i)*i);0===c[a];c.pop(),a--);if(a<0)c=[n=0];else{for(n=-1;0===c[0];c.splice(0,1),n-=14);for(a=1,i=c[0];i>=10;i/=10,a++);a<14&&(n-=14-a)}return u.e=n,u.c=c,u}),I.sum=function(){for(var e=1,t=arguments,r=new I(t[0]);e<t.length;)r=r.plus(t[e++]);return r},n=function(){var e="0123456789";function t(e,t,r,n){for(var o,i,s=[0],a=0,c=e.length;a<c;){for(i=s.length;i--;s[i]*=t);for(s[0]+=n.indexOf(e.charAt(a++)),o=0;o<s.length;o++)s[o]>r-1&&(null==s[o+1]&&(s[o+1]=0),s[o+1]+=s[o]/r|0,s[o]%=r)}return s.reverse()}return function(n,o,i,s,a){var c,u,l,d,h,p,g,y,w=n.indexOf("."),v=f,S=m;for(w>=0&&(d=E,E=0,n=n.replace(".",""),p=(y=new I(o)).pow(n.length-w),E=d,y.c=t(Zr(qr(p.c),p.e,"0"),10,i,e),y.e=y.c.length),l=d=(g=t(n,o,i,a?(c=A,e):(c=e,A))).length;0==g[--d];g.pop());if(!g[0])return c.charAt(0);if(w<0?--l:(p.c=g,p.e=l,p.s=s,g=(p=r(p,y,v,S,i)).c,h=p.r,l=p.e),w=g[u=l+v+1],d=i/2,h=h||u<0||null!=g[u+1],h=S<4?(null!=w||h)&&(0==S||S==(p.s<0?3:2)):w>d||w==d&&(4==S||h||6==S&&1&g[u-1]||S==(p.s<0?8:7)),u<1||!g[0])n=h?Zr(c.charAt(1),-v,c.charAt(0)):c.charAt(0);else{if(g.length=u,h)for(--i;++g[--u]>i;)g[u]=0,u||(++l,g=[1].concat(g));for(d=g.length;!g[--d];);for(w=0,n="";w<=d;n+=c.charAt(g[w++]));n=Zr(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,o,i,s,a=0,c=e.length,u=t%1e7,l=t/1e7|0;for(e=e.slice();c--;)a=((o=u*(i=e[c]%1e7)+(n=l*i+(s=e[c]/1e7|0)*u)%1e7*1e7+a)/r|0)+(n/1e7|0)+l*s,e[c]=o%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var o,i;if(r!=n)i=r>n?1:-1;else for(o=i=0;o<r;o++)if(e[o]!=t[o]){i=e[o]>t[o]?1:-1;break}return i}function r(e,t,r,n){for(var o=0;r--;)e[r]-=o,o=e[r]<t[r]?1:0,e[r]=o*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,o,i,s,a){var c,u,l,d,h,p,f,m,g,y,w,v,S,b,E,k,A,_=n.s==o.s?1:-1,x=n.c,M=o.c;if(!(x&&x[0]&&M&&M[0]))return new I(n.s&&o.s&&(x?!M||x[0]!=M[0]:M)?x&&0==x[0]||!M?0*_:_/0:NaN);for(g=(m=new I(_)).c=[],_=i+(u=n.e-o.e)+1,a||(a=jr,u=zr(n.e/14)-zr(o.e/14),_=_/14|0),l=0;M[l]==(x[l]||0);l++);if(M[l]>(x[l]||0)&&u--,_<0)g.push(1),d=!0;else{for(b=x.length,k=M.length,l=0,_+=2,(h=Nr(a/(M[0]+1)))>1&&(M=e(M,h,a),x=e(x,h,a),k=M.length,b=x.length),S=k,w=(y=x.slice(0,k)).length;w<k;y[w++]=0);A=M.slice(),A=[0].concat(A),E=M[0],M[1]>=a/2&&E++;do{if(h=0,(c=t(M,y,k,w))<0){if(v=y[0],k!=w&&(v=v*a+(y[1]||0)),(h=Nr(v/E))>1)for(h>=a&&(h=a-1),f=(p=e(M,h,a)).length,w=y.length;1==t(p,y,f,w);)h--,r(p,k<f?A:M,f,a),f=p.length,c=1;else 0==h&&(c=h=1),f=(p=M.slice()).length;if(f<w&&(p=[0].concat(p)),r(y,p,w,a),w=y.length,-1==c)for(;t(M,y,k,w)<1;)h++,r(y,k<w?A:M,w,a),w=y.length}else 0===c&&(h++,y=[0]);g[l++]=h,y[0]?y[w++]=x[S]||0:(y=[x[S]],w=1)}while((S++<b||null!=y[0])&&_--);d=null!=y[0],g[0]||g.splice(0,1)}if(a==jr){for(l=1,_=g[0];_>=10;_/=10,l++);L(m,i+(m.e=l+14*u-1)+1,s,d)}else m.e=u,m.r=+d;return m}}(),a=/^(-?)0([xbo])(?=\w[\w.]*$)/i,c=/^([^.]+)\.$/,u=/^\.([^.]+)$/,l=/^-?(Infinity|NaN)$/,d=/^\s*\+(?=[\w.])|^\s+|\s+$/g,o=function(e,t,r,n){var o,i=r?t:t.replace(d,"");if(l.test(i))e.s=isNaN(i)?null:i<0?-1:1;else{if(!r&&(i=i.replace(a,(function(e,t,r){return o="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=o?e:t})),n&&(o=n,i=i.replace(c,"$1").replace(u,"0.$1")),t!=i))return new I(i,o);if(I.DEBUG)throw Error(Rr+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},h.absoluteValue=h.abs=function(){var e=new I(this);return e.s<0&&(e.s=1),e},h.comparedTo=function(e,t){return Kr(this,new I(e,t))},h.decimalPlaces=h.dp=function(e,t){var r,n,o,i=this;if(null!=e)return Gr(e,0,$r),null==t?t=m:Gr(t,0,8),L(new I(i),e+i.e+1,t);if(!(r=i.c))return null;if(n=14*((o=r.length-1)-zr(this.e/14)),o=r[o])for(;o%10==0;o/=10,n--);return n<0&&(n=0),n},h.dividedBy=h.div=function(e,t){return r(this,new I(e,t),f,m)},h.dividedToIntegerBy=h.idiv=function(e,t){return r(this,new I(e,t),0,1)},h.exponentiatedBy=h.pow=function(e,t){var r,n,o,i,s,a,c,u,l=this;if((e=new I(e)).c&&!e.isInteger())throw Error(Rr+"Exponent not an integer: "+T(e));if(null!=t&&(t=new I(t)),s=e.e>14,!l.c||!l.c[0]||1==l.c[0]&&!l.e&&1==l.c.length||!e.c||!e.c[0])return u=new I(Math.pow(+T(l),s?2-Hr(e):+T(e))),t?u.mod(t):u;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new I(NaN);(n=!a&&l.isInteger()&&t.isInteger())&&(l=l.mod(t))}else{if(e.e>9&&(l.e>0||l.e<-1||(0==l.e?l.c[0]>1||s&&l.c[1]>=24e7:l.c[0]<8e13||s&&l.c[0]<=9999975e7)))return i=l.s<0&&Hr(e)?-0:0,l.e>-1&&(i=1/i),new I(a?1/i:i);E&&(i=Fr(E/14+2))}for(s?(r=new I(.5),a&&(e.s=1),c=Hr(e)):c=(o=Math.abs(+T(e)))%2,u=new I(p);;){if(c){if(!(u=u.times(l)).c)break;i?u.c.length>i&&(u.c.length=i):n&&(u=u.mod(t))}if(o){if(0===(o=Nr(o/2)))break;c=o%2}else if(L(e=e.times(r),e.e+1,1),e.e>14)c=Hr(e);else{if(0==(o=+T(e)))break;c=o%2}l=l.times(l),i?l.c&&l.c.length>i&&(l.c.length=i):n&&(l=l.mod(t))}return n?u:(a&&(u=p.div(u)),t?u.mod(t):i?L(u,E,m,void 0):u)},h.integerValue=function(e){var t=new I(this);return null==e?e=m:Gr(e,0,8),L(t,t.e+1,e)},h.isEqualTo=h.eq=function(e,t){return 0===Kr(this,new I(e,t))},h.isFinite=function(){return!!this.c},h.isGreaterThan=h.gt=function(e,t){return Kr(this,new I(e,t))>0},h.isGreaterThanOrEqualTo=h.gte=function(e,t){return 1===(t=Kr(this,new I(e,t)))||0===t},h.isInteger=function(){return!!this.c&&zr(this.e/14)>this.c.length-2},h.isLessThan=h.lt=function(e,t){return Kr(this,new I(e,t))<0},h.isLessThanOrEqualTo=h.lte=function(e,t){return-1===(t=Kr(this,new I(e,t)))||0===t},h.isNaN=function(){return!this.s},h.isNegative=function(){return this.s<0},h.isPositive=function(){return this.s>0},h.isZero=function(){return!!this.c&&0==this.c[0]},h.minus=function(e,t){var r,n,o,i,s=this,a=s.s;if(t=(e=new I(e,t)).s,!a||!t)return new I(NaN);if(a!=t)return e.s=-t,s.plus(e);var c=s.e/14,u=e.e/14,l=s.c,d=e.c;if(!c||!u){if(!l||!d)return l?(e.s=-t,e):new I(d?s:NaN);if(!l[0]||!d[0])return d[0]?(e.s=-t,e):new I(l[0]?s:3==m?-0:0)}if(c=zr(c),u=zr(u),l=l.slice(),a=c-u){for((i=a<0)?(a=-a,o=l):(u=c,o=d),o.reverse(),t=a;t--;o.push(0));o.reverse()}else for(n=(i=(a=l.length)<(t=d.length))?a:t,a=t=0;t<n;t++)if(l[t]!=d[t]){i=l[t]<d[t];break}if(i&&(o=l,l=d,d=o,e.s=-e.s),(t=(n=d.length)-(r=l.length))>0)for(;t--;l[r++]=0);for(t=jr-1;n>a;){if(l[--n]<d[n]){for(r=n;r&&!l[--r];l[r]=t);--l[r],l[n]+=jr}l[n]-=d[n]}for(;0==l[0];l.splice(0,1),--u);return l[0]?P(e,l,u):(e.s=3==m?-1:1,e.c=[e.e=0],e)},h.modulo=h.mod=function(e,t){var n,o,i=this;return e=new I(e,t),!i.c||!e.s||e.c&&!e.c[0]?new I(NaN):!e.c||i.c&&!i.c[0]?new I(i):(9==b?(o=e.s,e.s=1,n=r(i,e,0,3),e.s=o,n.s*=o):n=r(i,e,0,b),(e=i.minus(n.times(e))).c[0]||1!=b||(e.s=i.s),e)},h.multipliedBy=h.times=function(e,t){var r,n,o,i,s,a,c,u,l,d,h,p,f,m,g,y=this,w=y.c,v=(e=new I(e,t)).c;if(!(w&&v&&w[0]&&v[0]))return!y.s||!e.s||w&&!w[0]&&!v||v&&!v[0]&&!w?e.c=e.e=e.s=null:(e.s*=y.s,w&&v?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=zr(y.e/14)+zr(e.e/14),e.s*=y.s,(c=w.length)<(d=v.length)&&(f=w,w=v,v=f,o=c,c=d,d=o),o=c+d,f=[];o--;f.push(0));for(m=jr,g=1e7,o=d;--o>=0;){for(r=0,h=v[o]%g,p=v[o]/g|0,i=o+(s=c);i>o;)r=((u=h*(u=w[--s]%g)+(a=p*u+(l=w[s]/g|0)*h)%g*g+f[i]+r)/m|0)+(a/g|0)+p*l,f[i--]=u%m;f[i]=r}return r?++n:f.splice(0,1),P(e,f,n)},h.negated=function(){var e=new I(this);return e.s=-e.s||null,e},h.plus=function(e,t){var r,n=this,o=n.s;if(t=(e=new I(e,t)).s,!o||!t)return new I(NaN);if(o!=t)return e.s=-t,n.minus(e);var i=n.e/14,s=e.e/14,a=n.c,c=e.c;if(!i||!s){if(!a||!c)return new I(o/0);if(!a[0]||!c[0])return c[0]?e:new I(a[0]?n:0*o)}if(i=zr(i),s=zr(s),a=a.slice(),o=i-s){for(o>0?(s=i,r=c):(o=-o,r=a),r.reverse();o--;r.push(0));r.reverse()}for((o=a.length)-(t=c.length)<0&&(r=c,c=a,a=r,t=o),o=0;t;)o=(a[--t]=a[t]+c[t]+o)/jr|0,a[t]=jr===a[t]?0:a[t]%jr;return o&&(a=[o].concat(a),++s),P(e,a,s)},h.precision=h.sd=function(e,t){var r,n,o,i=this;if(null!=e&&e!==!!e)return Gr(e,1,$r),null==t?t=m:Gr(t,0,8),L(new I(i),e,t);if(!(r=i.c))return null;if(n=14*(o=r.length-1)+1,o=r[o]){for(;o%10==0;o/=10,n--);for(o=r[0];o>=10;o/=10,n++);}return e&&i.e+1>n&&(n=i.e+1),n},h.shiftedBy=function(e){return Gr(e,-9007199254740991,9007199254740991),this.times("1e"+e)},h.squareRoot=h.sqrt=function(){var e,t,n,o,i,s=this,a=s.c,c=s.s,u=s.e,l=f+4,d=new I("0.5");if(1!==c||!a||!a[0])return new I(!c||c<0&&(!a||a[0])?NaN:a?s:1/0);if(0==(c=Math.sqrt(+T(s)))||c==1/0?(((t=qr(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=zr((u+1)/2)-(u<0||u%2),n=new I(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new I(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(i=n,n=d.times(i.plus(r(s,i,l,1))),qr(i.c).slice(0,c)===(t=qr(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(o||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(L(n,n.e+f+2,1),e=!n.times(n).eq(s));break}if(!o&&(L(i,i.e+f+2,0),i.times(i).eq(s))){n=i;break}l+=4,c+=4,o=1}return L(n,n.e+f+1,m,e)},h.toExponential=function(e,t){return null!=e&&(Gr(e,0,$r),e++),x(this,e,t,1)},h.toFixed=function(e,t){return null!=e&&(Gr(e,0,$r),e=e+this.e+1),x(this,e,t)},h.toFormat=function(e,t,r){var n,o=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=k;else if("object"!=typeof r)throw Error(Rr+"Argument not an object: "+r);if(n=o.toFixed(e,t),o.c){var i,s=n.split("."),a=+r.groupSize,c=+r.secondaryGroupSize,u=r.groupSeparator||"",l=s[0],d=s[1],h=o.s<0,p=h?l.slice(1):l,f=p.length;if(c&&(i=a,a=c,c=i,f-=i),a>0&&f>0){for(i=f%a||a,l=p.substr(0,i);i<f;i+=a)l+=u+p.substr(i,a);c>0&&(l+=u+p.slice(i)),h&&(l="-"+l)}n=d?l+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?d.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):l}return(r.prefix||"")+n+(r.suffix||"")},h.toFraction=function(e){var t,n,o,i,s,a,c,u,l,d,h,f,g=this,y=g.c;if(null!=e&&(!(c=new I(e)).isInteger()&&(c.c||1!==c.s)||c.lt(p)))throw Error(Rr+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+T(c));if(!y)return new I(g);for(t=new I(p),l=n=new I(p),o=u=new I(p),f=qr(y),s=t.e=f.length-g.e-1,t.c[0]=Wr[(a=s%14)<0?14+a:a],e=!e||c.comparedTo(t)>0?s>0?t:l:c,a=v,v=1/0,c=new I(f),u.c[0]=0;d=r(c,t,0,1),1!=(i=n.plus(d.times(o))).comparedTo(e);)n=o,o=i,l=u.plus(d.times(i=l)),u=i,t=c.minus(d.times(i=t)),c=i;return i=r(e.minus(n),o,0,1),u=u.plus(i.times(l)),n=n.plus(i.times(o)),u.s=l.s=g.s,h=r(l,o,s*=2,m).minus(g).abs().comparedTo(r(u,n,s,m).minus(g).abs())<1?[l,o]:[u,n],v=a,h},h.toNumber=function(){return+T(this)},h.toPrecision=function(e,t){return null!=e&&Gr(e,1,$r),x(this,e,t,2)},h.toString=function(e){var t,r=this,o=r.s,i=r.e;return null===i?o?(t="Infinity",o<0&&(t="-"+t)):t="NaN":(null==e?t=i<=g||i>=y?Jr(qr(r.c),i):Zr(qr(r.c),i,"0"):10===e&&_?t=Zr(qr((r=L(new I(r),f+i+1,m)).c),r.e,"0"):(Gr(e,2,A.length,"Base"),t=n(Zr(qr(r.c),i,"0"),10,e,o,!0)),o<0&&r.c[0]&&(t="-"+t)),t},h.valueOf=h.toJSON=function(){return T(this)},h._isBigNumber=!0,h[Symbol.toStringTag]="BigNumber",h[Symbol.for("nodejs.util.inspect.custom")]=h.valueOf,null!=t&&I.set(t),I}();new Xr("1e+18");const Yr=t=>{const r=Or(32,t),{encode:n,decode:o}=Vr(r),i=r;return i.decode=(t,r)=>{const n=o(t,r);return new e(n)},i.encode=(e,t,r)=>{const o=e.toBuffer();return n(o,t,r)},i};function Qr(e){return new en(8,!1,e)}class en extends Gt{constructor(e,t,r){super(e,r),this.blob=Or(e),this.signed=t}encode(e,t,r=0){return this.signed&&(e=e.toTwos(8*this.span)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),t,r)}decode(e,t=0){const r=new u(this.blob.decode(e,t),10,"le");return this.signed?r.fromTwos(8*this.span).clone():r}}function tn(e,t){return new rn(e,t)}class rn extends Gt{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=Mr()}encode(e,t,r=0){return null==e?this.discriminator.encode(0,t,r):(this.discriminator.encode(1,t,r),this.discriminator.span+this.layout.encode(e,t,r+this.discriminator.span))}decode(e,t=0){const r=this.discriminator.decode(e,t);if(0===r)return null;if(1===r)return this.layout.decode(e,t+this.discriminator.span);throw new Error("Invalid option "+this.layout.property)}getSpan(e,t=0){const r=this.discriminator.decode(e,t);if(0===r)return 1;if(1===r)return this.layout.getSpan(e,t+1)+1;throw new Error("Invalid option "+this.property)}}class nn extends Gt{constructor(e,t){super(-1,t),this.layout=Lr([Pr("length"),Tr(e,xr(Pr(),-4),"src")],t)}encode(e,t,r=0){const n={src:e};return this.layout.encode(n,t,r)}decode(e,t=0){return this.layout.decode(e,t).src}getSpan(e,t=0){return this.layout.getSpan(e,t)}}function on(e){return new sn(e)}class sn extends Gt{constructor(e){super(-1,e),this.layout=Lr([Pr("length"),Or(xr(Pr(),-4),"src")],this.property)}encode(e,t,r=0){if(null==e)return this.layout.span;const n={src:Buffer.from(e,"utf8")};return this.layout.encode(n,t,r)}decode(e,t=0){return this.layout.decode(e,t).src.toString()}getSpan(e,t=0){return Pr().span+new u(new Uint8Array(e).slice(t,t+4),10,"le").toNumber()}}class an{constructor(e){}async encode(e,t){switch(e){case"stakePool":{const e=Buffer.alloc(10485760),r=cn.encode(t,e);return e.slice(0,r)}case"validatorStakeInfo":{const e=Buffer.alloc(73),r=un.encode(t,e);return e.slice(0,r)}case"validatorList":{const e=Buffer.alloc(10485760),r=ln.encode(t,e);return e.slice(0,r)}default:throw new Error(`Invalid account name: ${e}`)}}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){switch(e){case"stakePool":return function(e){return cn.decode(e)}(t);case"validatorStakeInfo":return function(e){return un.decode(e)}(t);case"validatorList":return function(e){return ln.decode(e)}(t);default:throw new Error(`Invalid account name: ${e}`)}}memcmp(e,t){switch(e){case"stakePool":case"validatorList":return{};case"validatorStakeInfo":return{dataSize:73};default:throw new Error(`Invalid account name: ${e}`)}}size(e){switch(e.name){case"stakePool":case"validatorList":return 0;case"validatorStakeInfo":return 73;default:throw new Error(`Invalid account name: ${e.name}`)}}}const cn=Lr([(e=>{const t=Br(Mr("discriminator"),null,"accountType");return t.addVariant(0,Lr([]),"uninitialized"),t.addVariant(1,Lr([]),"stakePool"),t.addVariant(2,Lr([]),"validatorList"),t})(),Yr("manager"),Yr("staker"),Yr("stakeDepositAuthority"),Mr("stakeWithdrawBumpSeed"),Yr("validatorList"),Yr("reserveStake"),Yr("poolMint"),Yr("managerFeeAccount"),Yr("tokenProgramId"),Qr("totalLamports"),Qr("poolTokenSupply"),Qr("lastUpdateEpoch"),Mr("lockup"),Lr([Qr("denominator"),Qr("numerator")],"epochFee"),tn(Lr([Qr("denominator"),Qr("numerator")]),"nextEpochFee"),tn(Yr(),"preferredDepositValidatorVoteAddress"),tn(Yr(),"preferredWithdrawValidatorVoteAddress"),Lr([Qr("denominator"),Qr("numerator")],"stakeDepositFee"),Lr([Qr("denominator"),Qr("numerator")],"stakeWithdrawalFee"),tn(Lr([Qr("denominator"),Qr("numerator")]),"nextStakeWithdrawalFee"),Mr("stakeReferralFee"),tn(Yr(),"solDepositAuthority"),Lr([Qr("denominator"),Qr("numerator")],"solDepositFee"),Mr("solReferralFee"),tn(Yr(),"solWithdrawAuthority"),Lr([Qr("denominator"),Qr("numerator")],"solWithdrawalFee"),tn(Lr([Qr("denominator"),Qr("numerator")]),"nextSolWithdrawalFee"),Qr("lastEpochPoolTokenSupply"),Qr("lastEpochTotalLamports")]),un=Lr([Qr("activeStakeLamports"),Qr("transientStakeLamports"),Qr("lastUpdateEpoch"),Qr("transientSeedSuffixStart"),Qr("transientSeedSuffixEnd"),(e=>{const t=Br(Mr("discriminator"),null,"status");return t.addVariant(0,Lr([]),"active"),t.addVariant(1,Lr([]),"deactivatingTransient"),t.addVariant(2,Lr([]),"readyForRemoval"),t})(),Yr("voteAccountAddress")]),ln=Lr([Lr([(e=>{const t=Br(Mr("discriminator"),null,"accountType");return t.addVariant(0,Lr([]),"uninitialized"),t.addVariant(1,Lr([]),"stakePool"),t.addVariant(2,Lr([]),"validatorList"),t})(),Pr("maxValidators")],"header"),function(e,t){return new nn(e,t)}(Lr([Qr("activeStakeLamports"),Qr("transientStakeLamports"),Qr("lastUpdateEpoch"),Qr("transientSeedSuffixStart"),Qr("transientSeedSuffixEnd"),(e=>{const t=Br(Mr("discriminator"),null,"status");return t.addVariant(0,Lr([]),"active"),t.addVariant(1,Lr([]),"deactivatingTransient"),t.addVariant(2,Lr([]),"readyForRemoval"),t})(),Yr("voteAccountAddress")]),"validators")]);class dn{constructor(e){}decode(e){throw new Error("SplStakePool program does not have events")}}class hn{constructor(e){}encode(e,t){switch(e){case"initialize":return function({fee:e,withdrawalFee:t,depositFee:r,referralFee:n,maxValidators:o}){return fn({initialize:{fee:e,withdrawalFee:t,depositFee:r,referralFee:n,maxValidators:o}},54)}(t);case"addValidatorToPool":return function({}){return fn({addValidatorToPool:{}},1)}(t);case"removeValidatorFromPool":return function({}){return fn({removeValidatorFromPool:{}},1)}(t);case"decreaseValidatorStake":return function({lamports:e,transientStakeSeed:t}){return fn({decreaseValidatorStake:{lamports:e,transientStakeSeed:t}},17)}(t);case"increaseValidatorStake":return function({lamports:e,transientStakeSeed:t}){return fn({increaseValidatorStake:{lamports:e,transientStakeSeed:t}},17)}(t);case"setPreferredValidator":return function({validatorType:e,validatorVoteAddress:t}){return fn({setPreferredValidator:{validatorType:e,validatorVoteAddress:t}},1+(()=>{switch(Object.keys(e)[0]){case"deposit":case"withdraw":return 1}})()+1+(null===t?0:32))}(t);case"updateValidatorListBalance":return function({startIndex:e,noMerge:t}){return fn({updateValidatorListBalance:{startIndex:e,noMerge:t}},6)}(t);case"updateStakePoolBalance":return function({}){return fn({updateStakePoolBalance:{}},1)}(t);case"cleanupRemovedValidatorEntries":return function({}){return fn({cleanupRemovedValidatorEntries:{}},1)}(t);case"depositStake":return function({}){return fn({depositStake:{}},1)}(t);case"withdrawStake":return function({arg:e}){return fn({withdrawStake:{arg:e}},9)}(t);case"setManager":return function({}){return fn({setManager:{}},1)}(t);case"setFee":return function({fee:e}){return fn({setFee:{fee:e}},1+(()=>{switch(Object.keys(e)[0]){case"solReferral":case"stakeReferral":return 2;case"epoch":case"stakeWithdrawal":case"solDeposit":case"stakeDeposit":case"solWithdrawal":return 17}})())}(t);case"setStaker":return function({}){return fn({setStaker:{}},1)}(t);case"depositSol":return function({arg:e}){return fn({depositSol:{arg:e}},9)}(t);case"setFundingAuthority":return function({arg:e}){return fn({setFundingAuthority:{arg:e}},1+(()=>{switch(Object.keys(e)[0]){case"stakeDeposit":case"solDeposit":case"solWithdraw":return 1}})())}(t);case"withdrawSol":return function({arg:e}){return fn({withdrawSol:{arg:e}},9)}(t);case"createTokenMetadata":return function({name:e,symbol:t,uri:r}){return fn({createTokenMetadata:{name:e,symbol:t,uri:r}},5+e.length+4+t.length+4+r.length)}(t);case"updateTokenMetadata":return function({name:e,symbol:t,uri:r}){return fn({updateTokenMetadata:{name:e,symbol:t,uri:r}},5+e.length+4+t.length+4+r.length)}(t);default:throw new Error(`Invalid instruction: ${e}`)}}encodeState(e,t){throw new Error("SplStakePool does not have state")}}const pn=Br(Mr("instruction"));function fn(e,t){const r=Buffer.alloc(t);return pn.encode(e,r),r}pn.addVariant(0,Lr([Lr([Qr("denominator"),Qr("numerator")],"fee"),Lr([Qr("denominator"),Qr("numerator")],"withdrawalFee"),Lr([Qr("denominator"),Qr("numerator")],"depositFee"),Mr("referralFee"),Pr("maxValidators")]),"initialize"),pn.addVariant(1,Lr([]),"addValidatorToPool"),pn.addVariant(2,Lr([]),"removeValidatorFromPool"),pn.addVariant(3,Lr([Qr("lamports"),Qr("transientStakeSeed")]),"decreaseValidatorStake"),pn.addVariant(4,Lr([Qr("lamports"),Qr("transientStakeSeed")]),"increaseValidatorStake"),pn.addVariant(5,Lr([(e=>{const t=Br(Mr("discriminator"),null,"validatorType");return t.addVariant(0,Lr([]),"deposit"),t.addVariant(1,Lr([]),"withdraw"),t})(),tn(Yr(),"validatorVoteAddress")]),"setPreferredValidator"),pn.addVariant(6,Lr([Pr("startIndex"),(e=>{const t=Mr(e),{encode:r,decode:n}=Vr(t),o=t;return o.decode=(e,t)=>!!n(e,t),o.encode=(e,t,n)=>{const o=Number(e);return r(o,t,n)},o})("noMerge")]),"updateValidatorListBalance"),pn.addVariant(7,Lr([]),"updateStakePoolBalance"),pn.addVariant(8,Lr([]),"cleanupRemovedValidatorEntries"),pn.addVariant(9,Lr([]),"depositStake"),pn.addVariant(10,Lr([Qr("arg")]),"withdrawStake"),pn.addVariant(11,Lr([]),"setManager"),pn.addVariant(12,Lr([(e=>{const t=Br(Mr("discriminator"),null,"fee");return t.addVariant(0,Mr(),"solReferral"),t.addVariant(1,Mr(),"stakeReferral"),t.addVariant(2,Lr([Qr("denominator"),Qr("numerator")]),"epoch"),t.addVariant(3,Lr([Qr("denominator"),Qr("numerator")]),"stakeWithdrawal"),t.addVariant(4,Lr([Qr("denominator"),Qr("numerator")]),"solDeposit"),t.addVariant(5,Lr([Qr("denominator"),Qr("numerator")]),"stakeDeposit"),t.addVariant(6,Lr([Qr("denominator"),Qr("numerator")]),"solWithdrawal"),t})()]),"setFee"),pn.addVariant(13,Lr([]),"setStaker"),pn.addVariant(14,Lr([Qr("arg")]),"depositSol"),pn.addVariant(15,Lr([(e=>{const t=Br(Mr("discriminator"),null,"arg");return t.addVariant(0,Lr([]),"stakeDeposit"),t.addVariant(1,Lr([]),"solDeposit"),t.addVariant(2,Lr([]),"solWithdraw"),t})()]),"setFundingAuthority"),pn.addVariant(16,Lr([Qr("arg")]),"withdrawSol"),pn.addVariant(17,Lr([on("name"),on("symbol"),on("uri")]),"createTokenMetadata"),pn.addVariant(18,Lr([on("name"),on("symbol"),on("uri")]),"updateTokenMetadata");class mn{constructor(e){}encode(e,t){throw new Error("SplStakePool does not have state")}decode(e){throw new Error("SplStakePool does not have state")}}class gn{constructor(e){}encode(e,t){throw new Error("SplStakePool does not have user-defined types")}decode(e,t){throw new Error("SplStakePool does not have user-defined types")}}class yn{constructor(e){this.accounts=new an(e),this.events=new dn(e),this.instruction=new hn(e),this.state=new mn(e),this.types=new gn(e)}}const wn=new e("SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy");function vn(e){var t;return new jt(Sn,null!==(t=null==e?void 0:e.programId)&&void 0!==t?t:wn,null==e?void 0:e.provider,new yn(Sn))}const Sn={version:"0.7.0",name:"spl_stake_pool",instructions:[{name:"initialize",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0},{name:"staker",isMut:!1,isSigner:!1},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"validatorList",isMut:!0,isSigner:!1},{name:"reserveStake",isMut:!1,isSigner:!1},{name:"poolMint",isMut:!0,isSigner:!1},{name:"managerPoolAccount",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"fee",type:{defined:"Fee"}},{name:"withdrawalFee",type:{defined:"Fee"}},{name:"depositFee",type:{defined:"Fee"}},{name:"referralFee",type:"u8"},{name:"maxValidators",type:"u32"}]},{name:"addValidatorToPool",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"staker",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!0},{name:"stakePoolWithdraw",isMut:!1,isSigner:!1},{name:"validatorList",isMut:!0,isSigner:!1},{name:"stake",isMut:!0,isSigner:!1},{name:"validator",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"sysvarStakeHistory",isMut:!1,isSigner:!1},{name:"stakeConfig",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[]},{name:"removeValidatorFromPool",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"staker",isMut:!1,isSigner:!0},{name:"stakePoolWithdraw",isMut:!1,isSigner:!1},{name:"newStakeAuthority",isMut:!1,isSigner:!1},{name:"validatorList",isMut:!0,isSigner:!1},{name:"stakeAccount",isMut:!0,isSigner:!1},{name:"transientStakeAccount",isMut:!1,isSigner:!1},{name:"destinationStakeAccount",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[]},{name:"decreaseValidatorStake",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"staker",isMut:!1,isSigner:!0},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"validatorList",isMut:!0,isSigner:!1},{name:"validatorStake",isMut:!0,isSigner:!1},{name:"transientStake",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[{name:"lamports",type:"u64"},{name:"transientStakeSeed",type:"u64"}]},{name:"increaseValidatorStake",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"staker",isMut:!1,isSigner:!0},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"validatorList",isMut:!0,isSigner:!1},{name:"reserveStake",isMut:!0,isSigner:!1},{name:"transientStake",isMut:!0,isSigner:!1},{name:"validatorStake",isMut:!1,isSigner:!1},{name:"validator",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"sysvarStakeHistory",isMut:!1,isSigner:!1},{name:"stakeConfig",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[{name:"lamports",type:"u64"},{name:"transientStakeSeed",type:"u64"}]},{name:"setPreferredValidator",accounts:[{name:"stakePoolAddress",isMut:!0,isSigner:!1},{name:"staker",isMut:!1,isSigner:!0},{name:"validatorListAddress",isMut:!1,isSigner:!1}],args:[{name:"validatorType",type:{defined:"PreferredValidatorType"}},{name:"validatorVoteAddress",type:{option:"publicKey"}}]},{name:"updateValidatorListBalance",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"validatorListAddress",isMut:!0,isSigner:!1},{name:"reserveStake",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"sysvarStakeHistory",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[{name:"startIndex",type:"u32"},{name:"noMerge",type:"bool"}]},{name:"updateStakePoolBalance",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"withdrawAuthority",isMut:!1,isSigner:!1},{name:"validatorListStorage",isMut:!0,isSigner:!1},{name:"reserveStake",isMut:!1,isSigner:!1},{name:"managerFeeAccount",isMut:!0,isSigner:!1},{name:"stakePoolMint",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"cleanupRemovedValidatorEntries",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"validatorListStorage",isMut:!0,isSigner:!1}],args:[]},{name:"depositStake",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"validatorListStorage",isMut:!0,isSigner:!1},{name:"stakePoolDepositAuthority",isMut:!1,isSigner:!1},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"depositStakeAddress",isMut:!0,isSigner:!1},{name:"validatorStakeAccount",isMut:!0,isSigner:!1},{name:"reserveStakeAccount",isMut:!0,isSigner:!1},{name:"poolTokensTo",isMut:!0,isSigner:!1},{name:"managerFeeAccount",isMut:!0,isSigner:!1},{name:"referrerPoolTokensAccount",isMut:!0,isSigner:!1},{name:"poolMint",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"sysvarStakeHistory",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[]},{name:"withdrawStake",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"validatorListStorage",isMut:!0,isSigner:!1},{name:"stakePoolWithdraw",isMut:!1,isSigner:!1},{name:"stakeToSplit",isMut:!0,isSigner:!1},{name:"stakeToReceive",isMut:!0,isSigner:!1},{name:"userStakeAuthority",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"userPoolTokenAccount",isMut:!0,isSigner:!1},{name:"managerFeeAccount",isMut:!0,isSigner:!1},{name:"poolMint",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1}],args:[{name:"arg",type:"u64"}]},{name:"setManager",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0},{name:"newManager",isMut:!1,isSigner:!0},{name:"newFeeReceiver",isMut:!1,isSigner:!1}],args:[]},{name:"setFee",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0}],args:[{name:"fee",type:{defined:"FeeType"}}]},{name:"setStaker",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"setStakerAuthority",isMut:!1,isSigner:!0},{name:"newStaker",isMut:!1,isSigner:!1}],args:[]},{name:"depositSol",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"reserveStakeAccount",isMut:!0,isSigner:!1},{name:"lamportsFrom",isMut:!0,isSigner:!0},{name:"poolTokensTo",isMut:!0,isSigner:!1},{name:"managerFeeAccount",isMut:!0,isSigner:!1},{name:"referrerPoolTokensAccount",isMut:!0,isSigner:!1},{name:"poolMint",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"arg",type:"u64"}]},{name:"setFundingAuthority",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0}],args:[{name:"arg",type:{defined:"FundingType"}}]},{name:"withdrawSol",accounts:[{name:"stakePool",isMut:!0,isSigner:!1},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"userTransferAuthority",isMut:!1,isSigner:!0},{name:"poolTokensFrom",isMut:!0,isSigner:!1},{name:"reserveStakeAccount",isMut:!0,isSigner:!1},{name:"lamportsTo",isMut:!0,isSigner:!1},{name:"managerFeeAccount",isMut:!0,isSigner:!1},{name:"poolMint",isMut:!0,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"sysvarStakeHistory",isMut:!1,isSigner:!1},{name:"stakeProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"arg",type:"u64"}]},{name:"createTokenMetadata",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"poolMint",isMut:!1,isSigner:!1},{name:"payer",isMut:!0,isSigner:!0},{name:"tokenMetadata",isMut:!0,isSigner:!1},{name:"mplTokenMetadata",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"uri",type:"string"}]},{name:"updateTokenMetadata",accounts:[{name:"stakePool",isMut:!1,isSigner:!1},{name:"manager",isMut:!1,isSigner:!0},{name:"stakePoolWithdrawAuthority",isMut:!1,isSigner:!1},{name:"tokenMetadata",isMut:!0,isSigner:!1},{name:"mplTokenMetadata",isMut:!1,isSigner:!1}],args:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"uri",type:"string"}]}],accounts:[{name:"stakePool",type:{kind:"struct",fields:[{name:"accountType",type:{defined:"AccountType"}},{name:"manager",type:"publicKey"},{name:"staker",type:"publicKey"},{name:"stakeDepositAuthority",type:"publicKey"},{name:"stakeWithdrawBumpSeed",type:"u8"},{name:"validatorList",type:"publicKey"},{name:"reserveStake",type:"publicKey"},{name:"poolMint",type:"publicKey"},{name:"managerFeeAccount",type:"publicKey"},{name:"tokenProgramId",type:"publicKey"},{name:"totalLamports",type:"u64"},{name:"poolTokenSupply",type:"u64"},{name:"lastUpdateEpoch",type:"u64"},{name:"lockup",type:{defined:"Lockup"}},{name:"epochFee",type:{defined:"Fee"}},{name:"nextEpochFee",type:{option:{defined:"Fee"}}},{name:"preferredDepositValidatorVoteAddress",type:{option:"publicKey"}},{name:"preferredWithdrawValidatorVoteAddress",type:{option:"publicKey"}},{name:"stakeDepositFee",type:{defined:"Fee"}},{name:"stakeWithdrawalFee",type:{defined:"Fee"}},{name:"nextStakeWithdrawalFee",type:{option:{defined:"Fee"}}},{name:"stakeReferralFee",type:"u8"},{name:"solDepositAuthority",type:{option:"publicKey"}},{name:"solDepositFee",type:{defined:"Fee"}},{name:"solReferralFee",type:"u8"},{name:"solWithdrawAuthority",type:{option:"publicKey"}},{name:"solWithdrawalFee",type:{defined:"Fee"}},{name:"nextSolWithdrawalFee",type:{option:{defined:"Fee"}}},{name:"lastEpochPoolTokenSupply",type:"u64"},{name:"lastEpochTotalLamports",type:"u64"}]}},{name:"validatorStakeInfo",type:{kind:"struct",fields:[{name:"activeStakeLamports",type:"u64"},{name:"transientStakeLamports",type:"u64"},{name:"lastUpdateEpoch",type:"u64"},{name:"transientSeedSuffixStart",type:"u64"},{name:"transientSeedSuffixEnd",type:"u64"},{name:"status",type:{defined:"StakeStatus"}},{name:"voteAccountAddress",type:"publicKey"}]}},{name:"validatorList",type:{kind:"struct",fields:[{name:"header",type:{defined:"ValidatorListHeader"}},{name:"validators",type:{vec:{defined:"ValidatorStakeInfo"}}}]}}],types:[{name:"Fee",type:{kind:"struct",fields:[{name:"denominator",type:"u64"},{name:"numerator",type:"u64"}]}},{name:"ValidatorListHeader",type:{kind:"struct",fields:[{name:"accountType",type:{defined:"AccountType"}},{name:"maxValidators",type:"u32"}]}},{name:"AccountType",type:{kind:"enum",variants:[{name:"Uninitialized"},{name:"StakePool"},{name:"ValidatorList"}]}},{name:"StakeStatus",type:{kind:"enum",variants:[{name:"Active"},{name:"DeactivatingTransient"},{name:"ReadyForRemoval"}]}},{name:"PreferredValidatorType",type:{kind:"enum",variants:[{name:"Deposit"},{name:"Withdraw"}]}},{name:"FeeType",type:{kind:"enum",variants:[{name:"SolReferral",fields:["u8"]},{name:"StakeReferral",fields:["u8"]},{name:"Epoch",fields:[{defined:"Fee"}]},{name:"StakeWithdrawal",fields:[{defined:"Fee"}]},{name:"SolDeposit",fields:[{defined:"Fee"}]},{name:"StakeDeposit",fields:[{defined:"Fee"}]},{name:"SolWithdrawal",fields:[{defined:"Fee"}]}]}},{name:"FundingType",type:{kind:"enum",variants:[{name:"StakeDeposit"},{name:"SolDeposit"},{name:"SolWithdraw"}]}}],errors:[{code:0,name:"AlreadyInUse",msg:"AlreadyInUse"},{code:1,name:"InvalidProgramAddress",msg:"InvalidProgramAddress"},{code:2,name:"InvalidState",msg:"InvalidState"},{code:3,name:"CalculationFailure",msg:"CalculationFailure"},{code:4,name:"FeeTooHigh",msg:"FeeTooHigh"},{code:5,name:"WrongAccountMint",msg:"WrongAccountMint"},{code:6,name:"WrongManager",msg:"WrongManager"},{code:7,name:"SignatureMissing",msg:"SignatureMissing"},{code:8,name:"InvalidValidatorStakeList",msg:"InvalidValidatorStakeList"},{code:9,name:"InvalidFeeAccount",msg:"InvalidFeeAccount"},{code:10,name:"WrongPoolMint",msg:"WrongPoolMint"},{code:11,name:"WrongStakeState",msg:"WrongStakeState"},{code:12,name:"UserStakeNotActive",msg:"UserStakeNotActive"},{code:13,name:"ValidatorAlreadyAdded",msg:"ValidatorAlreadyAdded"},{code:14,name:"ValidatorNotFound",msg:"ValidatorNotFound"},{code:15,name:"InvalidStakeAccountAddress",msg:"InvalidStakeAccountAddress"},{code:16,name:"StakeListOutOfDate",msg:"StakeListOutOfDate"},{code:17,name:"StakeListAndPoolOutOfDate",msg:"StakeListAndPoolOutOfDate"},{code:18,name:"UnknownValidatorStakeAccount",msg:"UnknownValidatorStakeAccount"},{code:19,name:"WrongMintingAuthority",msg:"WrongMintingAuthority"},{code:20,name:"UnexpectedValidatorListAccountSize",msg:"UnexpectedValidatorListAccountSize"},{code:21,name:"WrongStaker",msg:"WrongStaker"},{code:22,name:"NonZeroPoolTokenSupply",msg:"NonZeroPoolTokenSupply"},{code:23,name:"StakeLamportsNotEqualToMinimum",msg:"StakeLamportsNotEqualToMinimum"},{code:24,name:"IncorrectDepositVoteAddress",msg:"IncorrectDepositVoteAddress"},{code:25,name:"IncorrectWithdrawVoteAddress",msg:"IncorrectWithdrawVoteAddress"},{code:26,name:"InvalidMintFreezeAuthority",msg:"InvalidMintFreezeAuthority"},{code:27,name:"FeeIncreaseTooHigh",msg:"FeeIncreaseTooHigh"},{code:28,name:"WithdrawalTooSmall",msg:"WithdrawalTooSmall"},{code:29,name:"DepositTooSmall",msg:"DepositTooSmall"},{code:30,name:"InvalidStakeDepositAuthority",msg:"InvalidStakeDepositAuthority"},{code:31,name:"InvalidSolDepositAuthority",msg:"InvalidSolDepositAuthority"},{code:32,name:"InvalidPreferredValidator",msg:"InvalidPreferredValidator"},{code:33,name:"TransientAccountInUse",msg:"TransientAccountInUse"},{code:34,name:"InvalidSolWithdrawAuthority",msg:"InvalidSolWithdrawAuthority"},{code:35,name:"SolWithdrawalTooLarge",msg:"SolWithdrawalTooLarge"},{code:36,name:"InvalidMetadataAccount",msg:"InvalidMetadataAccount"}]};export{wn as SPL_STAKE_POOL_PROGRAM_ID,vn as splStakePoolProgram};
//# sourceMappingURL=index.js.map
